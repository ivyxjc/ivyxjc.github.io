<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[文章备份]]></title>
      <url>https://ivyxjc.xyz/2100/01/01/others-blog/</url>
      <content type="html"><![CDATA[<p>一些比较好的博客文章留档, 防止将来要用的时候又要浪费时间找.  （时间是2100年只是为了置顶…）</p>
<h2 id="android"><a href="#android" class="headerlink" title="android"></a>android</h2><h3 id="第三方库"><a href="#第三方库" class="headerlink" title="第三方库"></a>第三方库</h3><ol>
<li><a href="https://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">给 Android 开发者的 RxJava 详解</a><br><a href="https://web.archive.org/web/20161023043938/http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="https://gank.io/post/56e80c2c677659311bed9841" target="_blank" rel="noopener">RxJava 与 Retrofit 结合的最佳实践</a><br><a href="https://web.archive.org/web/20161022232218/http://gank.io/post/56e80c2c677659311bed9841" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h3 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h3><ol>
<li><a href="http://www.jianshu.com/p/1edeff139de5" target="_blank" rel="noopener">Md系列3、CoordinatorLayout 里 Toobar和TabLayout等发生的一系列故事</a><br><a href="https://web.archive.org/save/http://www.jianshu.com/p/1edeff139de5" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="https://github.com/hanks-zyh/SwipeRefreshLayout" target="_blank" rel="noopener">下拉刷新SwipeRefreshLayout</a><br><a href="">archive.org备份页面</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/12921889" target="_blank" rel="noopener">Android LayoutInflater原理分析，带你一步步深入了解View(一)</a><br><a href="https://web.archive.org/web/20161021223718/http://blog.csdn.net/guolin_blog/article/details/12921889" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/16330267" target="_blank" rel="noopener">Android视图绘制流程完全解析，带你一步步深入了解View(二)</a><br><a href="https://web.archive.org/web/20161021215349/http://blog.csdn.net/guolin_blog/article/details/16330267" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/17045157" target="_blank" rel="noopener">Android视图状态及重绘流程分析，带你一步步深入了解View(三)</a><br><a href="https://web.archive.org/web/20151023100537/http://blog.csdn.net/guolin_blog/article/details/17045157" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/17357967" target="_blank" rel="noopener">Android自定义View的实现方法，带你一步步深入了解View(四)</a><br><a href="https://web.archive.org/save/http://blog.csdn.net/guolin_blog/article/details/17357967" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="https://www.bignerdranch.com/blog/understanding-androids-layoutinflater-inflate/" target="_blank" rel="noopener">Understanding Android’s LayoutInflater.inflate()</a><br><a href="https://web.archive.org/web/20160604203134/https://www.bignerdranch.com/blog/understanding-androids-layoutinflater-inflate/" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><h3 id="java8"><a href="#java8" class="headerlink" title="java8"></a>java8</h3><ol>
<li><a href="http://ebnbin.com/2015/12/20/java-8-default-methods/" target="_blank" rel="noopener">java8 默认方法</a><br><a href="https://web.archive.org/web/20161023233757/http://ebnbin.com/2015/12/20/java-8-default-methods/" target="_blank" rel="noopener">jarchive.org备份页面 </a></li>
</ol>
<h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><h3 id="Spider"><a href="#Spider" class="headerlink" title="Spider"></a>Spider</h3><ol>
<li>500 or less中A Web Crawler With asyncio Coroutines的中文翻译版(关于python爬虫以及协程) :<br><a href="http://drafts.damnever.com/2015/A-Web-Crawler-With-asyncio-Coroutines.html" target="_blank" rel="noopener">&lt;译&gt; A Web Crawler With asyncio Coroutines</a><br><a href="http://drafts.damnever.com/2015/A-Web-Crawler-With-asyncio-Coroutines.html" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h3 id="python-1"><a href="#python-1" class="headerlink" title="python"></a>python</h3><ol>
<li>yield到底在做什么, 来自stackoverflow中的回答:<br><br><a href="http://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do" target="_blank" rel="noopener">what-does-the-yield-keyword-do</a><br><a href="https://web.archive.org/web/20161018133835/http://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do" target="_blank" rel="noopener">archive.org备份页面</a><br><br><a href="http://pyzh.readthedocs.io/en/latest/the-python-yield-keyword-explained.html" target="_blank" rel="noopener">中文翻译版本</a><br><a href="https://web.archive.org/web/20161030082921/http://pyzh.readthedocs.io/en/latest/the-python-yield-keyword-explained.html" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h2 id="Raspberry"><a href="#Raspberry" class="headerlink" title="Raspberry"></a>Raspberry</h2><ol>
<li><a href="https://www.zybuluo.com/yangxuan/note/321467#7%E4%B8%BAssh%E5%90%AF%E7%94%A8%E4%B8%A4%E6%AD%A5%E8%AE%A4%E8%AF%81" target="_blank" rel="noopener">树莓派3的使用(Raspbian)</a></li>
<li><a href="http://www.kawabangga.com/posts/1398" target="_blank" rel="noopener">树莓派通过邮件上报实时IP，随时随地远程登录树莓派</a><br><a href="https://web.archive.org/web/20160731051025/http://www.kawabangga.com/posts/1398" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="http://www.itdadao.com/articles/c15a588496p0.html" target="_blank" rel="noopener">树莓派 挂载SAMBA（小米路由器）</a><br><a href="https://web.archive.org/save/http://www.itdadao.com/articles/c15a588496p0.html" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h2 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h2><ol>
<li><a href="http://www.8dlive.com/post/371.html" target="_blank" rel="noopener">kcp安装配置教程</a><br><a href="https://web.archive.org/web/20161106035844/http://www.8dlive.com/post/371.html" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ol>
<li><a href="https://github.com/deercoder/0-tech-notes/blob/master/Git/git_merge_local_repos.md" target="_blank" rel="noopener">如何合并两个git仓库</a><br><a href="https://web.archive.org/web/20161208141359/https://github.com/deercoder/0-tech-notes/blob/master/Git/git_merge_local_repos.md" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
]]></content>
      
        
        <tags>
            
            <tag> backup </tag>
            
            <tag> blog </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Java11 的新特性]]></title>
      <url>https://ivyxjc.xyz/2018/10/04/java/java11/2018-10-04-java11-examples/</url>
      <content type="html"><![CDATA[<h2 id="JEP-181-Nest-Based-Acess-Control"><a href="#JEP-181-Nest-Based-Acess-Control" class="headerlink" title="JEP 181 Nest-Based Acess Control"></a>JEP 181 Nest-Based Acess Control</h2><p>这一提案是为了增强自Java 1.1即引入的嵌套类设计。</p>
<p>嵌套类主要有两个用处。</p>
<p>第一是因为其只使用于很短的代码块中，在Java8之前，这主要依靠实现一个匿名类来完成。Java8之后，这种用法可以被lambda表达取代。</p>
<p>另一种用法是因为需要访问另一个类的内部。嵌套类具有和成员变量以及成员方法相同的访问权限。</p>
<p>JEP181主要是为了解决JVM级别的权限与源码权限不一致的问题。</p>
<h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JEP181</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Nest1</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> var1;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSome</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> Nest2 nest2 = <span class="keyword">new</span> Nest2();</span><br><span class="line">            nest2.var2 = <span class="number">2</span>;</span><br><span class="line">            System.out.println(nest2.var2);</span><br><span class="line">            <span class="keyword">final</span> Field f2 = Nest2.class.getDeclaredField(<span class="string">"var2"</span>);</span><br><span class="line">            f2.setInt(nest2, <span class="number">2</span>);</span><br><span class="line">            System.out.println(nest2.var2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Nest2</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> var2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        JEP181 jep181 = <span class="keyword">new</span> JEP181();</span><br><span class="line">        JEP181.Nest1 nest1 = jep181.new Nest1();</span><br><span class="line">        nest1.doSome();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">result:</span><br><span class="line">java <span class="number">11</span>: <span class="number">2</span> <span class="number">2</span></span><br><span class="line">java <span class="number">8</span>: java.lang.IllegalAccessException</span><br></pre></td></tr></table></figure>
<p>这一段代码在Java8中是不正确的。会抛出<code>java.lang.IllegalAccessException</code>。主要问题出在<code>f2.setInt(nest2,2)</code>，这里由于在<code>Nest2</code>中是private的，所以无法直接set值。但是却又可以直接调用<code>nest2.var2=2</code>来设置该值，因为嵌套类是可以访问别的嵌套类的私有属性的。Java 11修复了这个令人困惑的现象。</p>
<blockquote>
<p>JEP 181 官方介绍<br><br>A field or method R is accessible to a class or interface D if and only if any of the following conditions are true:<br><br>…<br><br>R is private and is declared in a different class or interface C, and C and D, are nestmates</p>
</blockquote>
<h2 id="JEP-321-HttpClient"><a href="#JEP-321-HttpClient" class="headerlink" title="JEP 321 HttpClient"></a>JEP 321 HttpClient</h2><p><code>HttpClient</code>在Java9开始引入，Java10对此有所更新。Java11根据一些反馈对API进行了一些改进，但是大部分都没有变化。该API通过CompletableFutures提供了非阻塞request和response,<br>关于请求和响应的背压机制以及流控制都由Java11新提供的Flow API来提供。</p>
<p>虽然API没有什么变化，但是实现几乎全部重写了。Java11的全部实现都是异步的（Java9,10的Http/1.1的实现是阻塞的）.</p>
<h3 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">syncGet</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException </span>&#123;</span><br><span class="line">        HttpClient httpClient = HttpClient.newHttpClient();</span><br><span class="line"></span><br><span class="line">        HttpRequest request = HttpRequest.newBuilder()</span><br><span class="line">            .uri(URI.create(<span class="string">"http://www.baidu.com"</span>))</span><br><span class="line">            .timeout(Duration.ofSeconds(<span class="number">20</span>))</span><br><span class="line">            .header(<span class="string">"Content-Type"</span>, <span class="string">"application/json"</span>)</span><br><span class="line">            .build();</span><br><span class="line">        HttpResponse&lt;Path&gt; response =</span><br><span class="line">            httpClient.send(request, HttpResponse.BodyHandlers.ofFile(Paths.get(<span class="string">"abc.txt"</span>)));</span><br><span class="line">        log.debug(<span class="string">"Response status code: "</span> + response.statusCode());</span><br><span class="line">        log.debug(<span class="string">"Response headers: "</span> + response.headers());</span><br><span class="line">        log.debug(<span class="string">"Response body: "</span> + response.body());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>关于同步的用法都比较简单，和别的很多http库的设计也比较相像。</p>
<h3 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">asyncGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       HttpClient httpClient = HttpClient.newHttpClient();</span><br><span class="line">       HttpRequest request = HttpRequest.newBuilder()</span><br><span class="line">           .uri(URI.create(<span class="string">"http://www.baidu.com"</span>))</span><br><span class="line">           .build();</span><br><span class="line"></span><br><span class="line">       CompletableFuture&lt;String&gt; strResponse =</span><br><span class="line">           httpClient.sendAsync(request, HttpResponse.BodyHandlers.ofString())</span><br><span class="line">               .thenApply(HttpResponse::body);</span><br><span class="line">       strResponse.whenComplete((resp, t) -&gt; &#123;</span><br><span class="line">           <span class="keyword">if</span> (t != <span class="keyword">null</span>) &#123;</span><br><span class="line">               log.debug(t.getMessage());</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               log.debug(resp);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;).join();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="JEP-323-Local-Variable-Syntax-for-Lambda-Parameters"><a href="#JEP-323-Local-Variable-Syntax-for-Lambda-Parameters" class="headerlink" title="JEP 323 Local-Variable Syntax for Lambda Parameters"></a>JEP 323 Local-Variable Syntax for Lambda Parameters</h2><p>Java 9，Java 10引入了var用来简化声明变量的过程，Java 11进一步增强了该特性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">list.sort((<span class="meta">@NotNull</span> var t1, <span class="meta">@NotNull</span> var t2) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (t1.equals(t2)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> t1 &gt; t2 ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>在Java 11之前，上述代码未能正确执行。<br><code>(var x, var y)-&gt;...</code>在一般情况下并没有什么用，但是如果需要给lambda表达式变量添加注解的话，那么lambda中可以使用var就有了作用。</p>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Docker相关命令]]></title>
      <url>https://ivyxjc.xyz/2018/08/09/Linux/2018-04-28-docker-basic/</url>
      <content type="html"><![CDATA[<h2 id="运行docker"><a href="#运行docker" class="headerlink" title="运行docker"></a>运行docker</h2><h3 id="映射端口"><a href="#映射端口" class="headerlink" title="映射端口"></a>映射端口</h3><p><code>docker run -p 8080:8080 image_name</code></p>
<h3 id="映射文件"><a href="#映射文件" class="headerlink" title="映射文件"></a>映射文件</h3><p><code>docker run -v /logs:/var/log/ -p 5000:80 image_name</code></p>
<p>将宿主<code>/logs</code>目录加载到container中的<code>/var/log</code></p>
<h3 id="–add-host"><a href="#–add-host" class="headerlink" title="–add-host"></a>–add-host</h3><p><code>docker run -it --add-host db-static:1.1.1.1 ubuntu cat /etc/hosts1</code></p>
<h2 id="docker相关命令"><a href="#docker相关命令" class="headerlink" title="docker相关命令"></a>docker相关命令</h2><h3 id="进入container命令行"><a href="#进入container命令行" class="headerlink" title="进入container命令行"></a>进入container命令行</h3><p><code>docker exec -i -t container_id bash</code></p>
<p>退出 <code>exit</code></p>
]]></content>
      
        <categories>
            
            <category> Web </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[centos7 LNMP配置]]></title>
      <url>https://ivyxjc.xyz/2018/08/09/Linux/2018-03-17-centos7-init/</url>
      <content type="html"><![CDATA[<p>centos7环境搭建及相关配置。</p>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="更改ssh端口以及防火墙开放端口"><a href="#更改ssh端口以及防火墙开放端口" class="headerlink" title="更改ssh端口以及防火墙开放端口"></a>更改ssh端口以及防火墙开放端口</h2><p><a href="https://sebastianblade.com/how-to-modify-ssh-port-in-centos7/" target="_blank" rel="noopener">怎样修改 CentOS 7 SSH 端口</a>(<a href="https://web.archive.org/web/20180317035653/https://sebastianblade.com/how-to-modify-ssh-port-in-centos7/" target="_blank" rel="noopener">archive存档</a>)</p>
<h2 id="安装Java"><a href="#安装Java" class="headerlink" title="安装Java"></a>安装Java</h2><p>直接wget下载地址并不能成功下载。使用下面的方式可以成功下载jdk-8u162.rpm.<br>使用<code>rpm -qa | grep &#39;jdk&#39;</code>查找已安装的jdk，使用<code>rpm -e jdk**</code>来删除。之后使用<code>rpm -ivh jdk**</code>来安装新的jdk.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-cookies --no-check-certificate --header &quot;Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie&quot; &quot;http://download.oracle.com/otn-pub/java/jdk/8u162-b12/0da788060d494f5095bf8624735fa2f1/jdk-8u162-linux-x64.rpm?AuthParam=1521257408_9aefdf6daa3472d09007c0abd24832e1&quot;</span><br></pre></td></tr></table></figure>
<h2 id="安装MySql"><a href="#安装MySql" class="headerlink" title="安装MySql"></a>安装MySql</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><a href="https://www.jianshu.com/p/7cccdaa2d177" target="_blank" rel="noopener">Centos 7 安装 MySQL</a>(<a href="https://webcache.googleusercontent.com/search?q=cache:E4urk8c-wMYJ:https://www.jianshu.com/p/7cccdaa2d177+&amp;cd=1&amp;hl=zh-CN&amp;ct=clnk&amp;gl=cn" target="_blank" rel="noopener">google cache</a>)</p>
<h3 id="允许外网访问"><a href="#允许外网访问" class="headerlink" title="允许外网访问"></a>允许外网访问</h3><ol>
<li>云服务安全组及系统防火墙放开该端口</li>
<li>进入<code>mysql</code>执行<code>grant all on *.* to root@% identified by &#39;pass&#39;;</code>即可外网访问且拥有全部权限。</li>
<li>若希望改用户具有分发权限的权限，则可以使用<code>grant all on *.* to root@% identified by &#39;pass&#39; with grant option;</code></li>
</ol>
<h2 id="安装Python"><a href="#安装Python" class="headerlink" title="安装Python"></a>安装Python</h2><h3 id="安装准备"><a href="#安装准备" class="headerlink" title="安装准备"></a>安装准备</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall &apos;Development Tools&apos;</span><br><span class="line">yum install zlib-devel bzip2-devel openssl-devel ncurese-devel</span><br></pre></td></tr></table></figure>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://www.python.org/ftp/python/3.6.4/Python-3.6.4.tgz</span><br><span class="line"></span><br><span class="line">tar -xzvf Python-3.6.4.tgz</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> Python-3.6.4</span><br></pre></td></tr></table></figure>
<h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/python3</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 备份python</span><br><span class="line">mv /usr/bin/python /usr/bin/python_bak</span><br><span class="line"># 更改yum</span><br><span class="line">vi /usr/bin/yum</span><br><span class="line"># 建立软连接</span><br><span class="line">ln -s /usr/local/python3/bin/python3 /usr/bin/python</span><br><span class="line">ln -s /usr/local/python3/bin/pip3.6 /usr/bin/pip3</span><br></pre></td></tr></table></figure>
<h2 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h2><h3 id="安装准备-1"><a href="#安装准备-1" class="headerlink" title="安装准备"></a>安装准备</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel</span><br><span class="line">yum install  gcc perl-ExtUtils-MakeMaker</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 下载git</span><br><span class="line"></span><br><span class="line">###</span><br></pre></td></tr></table></figure>
<p>tar -zxf git.tar.gz<br>cd **<br>make configure<br>./configure –prefix=/usr/local<br>make install<br><code>`</code></p>
<h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><p><code>uname -r</code>检查内核版本号是否大于<code>3.10</code></p>
<p><code>yum -y install docker</code>安装docker</p>
<h1 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h1><h2 id="enable-ipv4-forwarding"><a href="#enable-ipv4-forwarding" class="headerlink" title="enable ipv4_forwarding"></a>enable ipv4_forwarding</h2><p>在 <code>/etc/sysctl.conf</code>以及 <code>/usr/lib/sysctl.d/50-default.conf</code>里面都添加<code>net.ipv4.ip_forward = 1</code></p>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kafka 认证配置]]></title>
      <url>https://ivyxjc.xyz/2018/05/05/%E6%95%88%E7%8E%87/2018-05-05-build-Kafka/</url>
      <content type="html"><![CDATA[<p>Kafka支持多种安全验证方式，本文主要介绍使用用户名/密码的方式的方式认证Kafka。</p>
<h3 id="Zookeeper-相关更改"><a href="#Zookeeper-相关更改" class="headerlink" title="Zookeeper 相关更改"></a>Zookeeper 相关更改</h3><p><code>zookeeper-server-start.bat</code>（win）<br>添加</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_SASL_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</span><br><span class="line">    <span class="built_in">set</span> KAFKA_SASL_OPTS=-Djava.security.auth.login.config=filepath\kafka_2.<span class="number">11</span>-<span class="number">1</span>.<span class="number">1</span>.<span class="number">0</span>\kafka_zoo_jaas.conf</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><code>kafka_zoo_jaas.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Server &#123;  </span><br><span class="line">  org.apache.kafka.common.security.plain.PlainLoginModule required  </span><br><span class="line">    username=&quot;zoo-admin&quot;</span><br><span class="line">    password=&quot;zoo-admin-pass&quot;</span><br><span class="line">    user_zooUser=&quot;zooUser-pass&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h2 id="Kafka配置-相关更改"><a href="#Kafka配置-相关更改" class="headerlink" title="Kafka配置 相关更改"></a>Kafka配置 相关更改</h2><p><code>kafka-server-start.bat</code>(win)<br>添加<br><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_SASL_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</span><br><span class="line">    <span class="built_in">set</span> KAFKA_SASL_OPTS=-Djava.security.auth.login.config=filepath\kafka_2.<span class="number">11</span>-<span class="number">1</span>.<span class="number">1</span>.<span class="number">0</span>\kafka_server_jaas.conf</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p><code>kafka_server_jaas.conf</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">KafkaServer &#123;</span><br><span class="line">    org.apache.kafka.common.security.plain.PlainLoginModule required</span><br><span class="line">    username=&quot;user&quot;</span><br><span class="line">    password=&quot;user-pass&quot;</span><br><span class="line">    user_kafkaUser=&quot;kafkaUser-pass&quot;</span><br><span class="line">&#125;;</span><br><span class="line">    </span><br><span class="line">Client &#123;</span><br><span class="line">    org.apache.kafka.common.security.plain.PlainLoginModule required</span><br><span class="line">        username=&quot;zooUser&quot;</span><br><span class="line">        password=&quot;password&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>KafkaServer</code>中的内容是Producer，Consumer连接Kafka时要输入的验证信息。</p>
<p><code>Client</code>中的内容即连接zookeeper是需要输入的验证信息，和<code>kafka_zoo_jaas.conf</code>中的内容一致。</p>
<h3 id="使得JVM参数生效"><a href="#使得JVM参数生效" class="headerlink" title="使得JVM参数生效"></a>使得JVM参数生效</h3><p><code>zookeeper-server-start.bat</code>和<code>kafka-server-start.bat</code>最终都是使用<code>kafka-run-class.bat</code>来真正运行的，所以需要将这两个文件添加的JVM参数添加到此文件。</p>
<p>打开<code>kafka-run-class.bat</code>(win)</p>
<p>将<code>KAFKA_SASL_OPTS</code>添加到<code>set COMMAND</code>后面（不要放在<code>%Java%</code>之前）。</p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><ol>
<li>zookeeper的登陆名最好不要和kafka的登陆名有重复，在我尝试的时候发现，名称相同的时候，会直接使用KafkaServer下的用户去登陆zookeeper导致无法登陆成功。</li>
<li>理论上讲<code>kafka_server_jaas.conf</code>中Client中为连接zookeeper的认证信息。但是在我尝试的时候发现，只在Client中记录登陆信息并不能成功，还需要将该信息填入KafkaServer中才能成功（即使如此，也未必能成功）。<br>目前发现的一个成功的组合，是使用<code>kafka_zoo_jaas.conf</code>中的username后面的用户名称，并在该文件下，添加<code>user_...=password</code>，使用此作为密码，并将这一认证信息添加到<code>kafka_serve_jass.conf</code>中的<code>KafkaServer</code>和<code>Client</code>中。</li>
</ol>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kafka </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[class.getResource() class.getClassLoader.getResource()之间的区别]]></title>
      <url>https://ivyxjc.xyz/2018/03/26/java/2018-03-26-how-to-get-resource/</url>
      <content type="html"><![CDATA[<p>使用<code>*.class.getResouce()</code>和<code>*.class.getClassLoader.getResource()</code>是有一定的区别的。</p>
<p>在maven，gradle等构建工具构建的项目，resouces文件夹下的内容默认在classpath下面。</p>
<p>所以可以直接用<code>this.class.getClassLoader.getResource(...)</code>来获取对应的文件</p>
<h2 id="Class与ClassLoader-getResource-之间的区别"><a href="#Class与ClassLoader-getResource-之间的区别" class="headerlink" title="Class与ClassLoader.getResource()之间的区别"></a>Class与ClassLoader.getResource()之间的区别</h2><p>使用<code>*.class.getResouce()</code>和<code>*.class.getClassLoader.getResource()</code>是有一定的区别的。</p>
<p><code>*.class.getResouce()</code>先会<code>resolveName(name)</code>然后在委托给<code>classLoader</code>来处理。所以区别主要在于<code>resolveName(name)</code>。 <code>resolveName(name)</code>主要是功能是：若<code>name</code>以<code>/</code>开头，那么则直接调用<code>classLoader</code>来处理。若没有以<code>/</code>开头，则会将类全名中的点替换成<code>/</code>作为路径再加上name委托给<code>classLoader</code>来处理。</p>
<p>所以要获取<code>resources</code>文件夹下的内容，<code>*.class.getResouce(name)</code>中的<code>name</code>要以<code>/</code>开头。而<code>this.class.getClassLoader.getResource(...)</code>不需要。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> java.net.<span class="function">URL <span class="title">getResource</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    name = resolveName(name);</span><br><span class="line">    ClassLoader cl = getClassLoader0();</span><br><span class="line">    <span class="keyword">if</span> (cl==<span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// A system class.</span></span><br><span class="line">        <span class="keyword">return</span> ClassLoader.getSystemResource(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cl.getResource(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">resolveName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!name.startsWith(<span class="string">"/"</span>)) &#123;</span><br><span class="line">            Class&lt;?&gt; c = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">while</span> (c.isArray()) &#123;</span><br><span class="line">                c = c.getComponentType();</span><br><span class="line">            &#125;</span><br><span class="line">            String baseName = c.getName();</span><br><span class="line">            <span class="keyword">int</span> index = baseName.lastIndexOf(<span class="string">'.'</span>);</span><br><span class="line">            <span class="keyword">if</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">                name = baseName.substring(<span class="number">0</span>, index).replace(<span class="string">'.'</span>, <span class="string">'/'</span>)</span><br><span class="line">                    +<span class="string">"/"</span>+name;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            name = name.substring(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[链表相交以及链表含环的相关问题]]></title>
      <url>https://ivyxjc.xyz/2017/03/04/algorithm/CodeIntervieBook/LinkedList/2017-03-01-LinkedList-Cycle/</url>
      <content type="html"><![CDATA[<h2 id="初步-如何判断一个链表是否含有环"><a href="#初步-如何判断一个链表是否含有环" class="headerlink" title="初步: 如何判断一个链表是否含有环"></a>初步: 如何判断一个链表是否含有环</h2><p>使得两个名为fast, slow的节点等于头节点, fast每次向前两步,  slow每次向前一步, 如果fast.next为null, 或者fast.next.next为null, 则说明没有环. 如果fast和slow相遇, 说明有环.</p>
<p>时间复杂度和环和长度以及链表长度有关, 为线性时间.</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasCycle</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode fast=head;</span><br><span class="line">        ListNode slow=head;</span><br><span class="line">        <span class="comment">//0: 无环 ; 1: 有环</span></span><br><span class="line">        <span class="keyword">int</span> circleFlag=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(fast.next==<span class="keyword">null</span>||fast.next.next==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fast=fast.next.next;</span><br><span class="line">            slow=slow.next;</span><br><span class="line">            <span class="keyword">if</span>(fast==slow)&#123;</span><br><span class="line">                slow=head;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="进阶-如果一个链表有环-找出进入环的第一个节点"><a href="#进阶-如果一个链表有环-找出进入环的第一个节点" class="headerlink" title="进阶: 如果一个链表有环, 找出进入环的第一个节点"></a>进阶: 如果一个链表有环, 找出进入环的第一个节点</h2><p>使得两个名为fast, slow的节点等于头节点, fast每次向前两步,  slow每次向前一步, 如果fast.next为null, 或者fast.next.next为null, 则说明没有环. 如果fast和slow相遇, 说明有环. 此时将fast节点移动号head节点(判断fast和slow是否相遇, 如果相遇,说明head节点即使入环的第一个节点). 之后fast的节点每次走一步, slow节点每次走一步. 下一次相遇的节点即是入环的第一个节点.</p>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>某个链表总长度为n+m, 环的长度为m. <br><br>其中令</p>
<p>$$n\%m=n-x\cdot m   ,(x=\left \lfloor \tfrac{n}{m} \right \rfloor)$$</p>
<ol>
<li>slow节点到达入环的第一个节点时fast位置:<br><br>入环的第$n\%m$节点, 即$n-x\cdot m$.</li>
<li>第一次相遇时, 两个节点所处的位置:<br><br>入环的第$m-(n-x\cdot m)$节点, 即$(x+1)\cdot m-n$.</li>
<li>此时fast节点回到原点, 当fast节点再次走到入环的第一个节点时, slow节点的位置:<br><br>入环的地$((x+1)\cdot m-n+n)\%m$. 即$((x+1)\cdot m)%m$. 即为入环的第一个节点. 因为从fast节点回到原点再到入环的第一个节点过程中, fast节点一直在环外, slow节点一直在环内. 所以此次相遇为第二次相遇. 即按照之前的走法, 第二次相遇的节点即为入环的第一个节点.</li>
</ol>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">detectCycle</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head==<span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode fast=head;</span><br><span class="line">    ListNode slow=head;</span><br><span class="line">    <span class="comment">//0: 无环 ; 1: 有环</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> circleFlag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fast.next==<span class="keyword">null</span>||fast.next.next==<span class="keyword">null</span>)&#123;</span><br><span class="line">            circleFlag=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        fast=fast.next.next;</span><br><span class="line">        slow=slow.next;</span><br><span class="line">        <span class="keyword">if</span>(fast==slow)&#123;</span><br><span class="line">            fast=head;</span><br><span class="line">            circleFlag=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(circleFlag==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fast==slow)&#123;</span><br><span class="line">            <span class="keyword">return</span> fast;</span><br><span class="line">        &#125;</span><br><span class="line">        slow=slow.next;</span><br><span class="line">        fast=fast.next;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="进阶-以及如何判断两个链表是否相交"><a href="#进阶-以及如何判断两个链表是否相交" class="headerlink" title="进阶: 以及如何判断两个链表是否相交"></a>进阶: 以及如何判断两个链表是否相交</h2><h3 id="一链表有环-另一链表无环-不相交"><a href="#一链表有环-另一链表无环-不相交" class="headerlink" title="一链表有环, 另一链表无环, 不相交"></a>一链表有环, 另一链表无环, 不相交</h3><h3 id="两个链表都没有环"><a href="#两个链表都没有环" class="headerlink" title="两个链表都没有环"></a>两个链表都没有环</h3><p>计算两个链表的长度, 较长的链表先向前走<code>Math.abs(lenA-lenB)</code>步, 之后两个节点一起前进, 并相互比较, 若有相同的节点, 则说明两个链表在该节点出相交, 否则说明两个链表不相交.</p>
<h4 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">listLengthWithoutCycle</span><span class="params">(ListNode head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        head=head.next;</span><br><span class="line">        res+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">noLoop</span><span class="params">(ListNode headA, ListNode headB)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lenA= listLengthWithoutCycle(headA);</span><br><span class="line">    <span class="keyword">int</span> lenB= listLengthWithoutCycle(headB);</span><br><span class="line">    System.out.println(lenA);</span><br><span class="line">    System.out.println(lenB);</span><br><span class="line">    ListNode a=headA;</span><br><span class="line">    ListNode b=headB;</span><br><span class="line">    <span class="keyword">if</span>(lenA&lt;lenB)&#123;</span><br><span class="line">        a=headB;</span><br><span class="line">        b=headA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> diff=Math.abs(lenA-lenB);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;  i &lt; diff;  i++) &#123;</span><br><span class="line">        a=a.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="keyword">null</span>||b==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a==b)&#123;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        a=a.next;</span><br><span class="line">        b=b.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="两个链表都有环"><a href="#两个链表都有环" class="headerlink" title="两个链表都有环"></a>两个链表都有环</h3><p>找出两个链表入环的第一个节点, 其中一个节点不断的赋值为该节点的next, 若能够遇到另一个链表的入环的一个节点, 则说明两个链表环内相交, 否则说明两个链表为环外相交或者不相交.</p>
<p>如果两个链表是在环外相交的, 解法和都没有环的解法类似.</p>
<h4 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">bothLoop</span><span class="params">(ListNode headA, ListNode headB,ListNode aIns,ListNode bIns)</span></span>&#123;</span><br><span class="line">    <span class="comment">//环内相交</span></span><br><span class="line">    ListNode aInsCopy=aIns;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">        aIns=aIns.next;</span><br><span class="line">        <span class="keyword">if</span>(aIns==aInsCopy)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(aIns==bIns)&#123;</span><br><span class="line">            <span class="keyword">return</span> aIns;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在while循环没有return, 说明并没有在环内相交</span></span><br><span class="line">    <span class="keyword">int</span> lenA=listLengthWithCycle(headA);</span><br><span class="line">    <span class="keyword">int</span> lenB=listLengthWithCycle(headB);</span><br><span class="line">    ListNode a=headA;</span><br><span class="line">    ListNode b=headB;</span><br><span class="line">    <span class="keyword">if</span>(lenA&lt;lenB)&#123;</span><br><span class="line">        a=headB;</span><br><span class="line">        b=headA;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> diff=Math.abs(lenA-lenB);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;  i &lt; diff;  i++) &#123;</span><br><span class="line">        a=a.next;</span><br><span class="line">        <span class="keyword">if</span>(a==aIns)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a==b)&#123;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a==aIns)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(b==bIns)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a=a.next;</span><br><span class="line">        b=b.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">listLengthWithCycle</span><span class="params">(ListNode node)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    ListNode ins=detectCycle(node);</span><br><span class="line">    <span class="keyword">int</span> flag=-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(node==ins)&#123;</span><br><span class="line">            flag++;</span><br><span class="line">        &#125;</span><br><span class="line">        res+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linkedlist </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fibonacci数列及相关问题]]></title>
      <url>https://ivyxjc.xyz/2017/03/01/algorithm/CodeIntervieBook/RecursionAndDP/2017-03-01-Fibonacci/</url>
      <content type="html"><![CDATA[<h2 id="Fibonacci数列及相关的问题的描述"><a href="#Fibonacci数列及相关的问题的描述" class="headerlink" title="Fibonacci数列及相关的问题的描述"></a>Fibonacci数列及相关的问题的描述</h2><ol>
<li>给定正整数n, 求解Fibonacci数列第n项的值;</li>
<li>给定正整数N, 代表台阶, 一次可以跨2个或者1个台阶, 有多少走法</li>
<li>假设成熟的母牛只会生1头小母牛, 并且永远不会死, 第一年农场有1只成熟的母牛,从第二年开始, 母牛开始生小母牛. 每只小母牛3年之后成熟. 给定正整数N, 求出N年后牛的数量.</li>
</ol>
<h2 id="基础解法"><a href="#基础解法" class="headerlink" title="基础解法"></a>基础解法</h2><h3 id="递归的解法"><a href="#递归的解法" class="headerlink" title="递归的解法"></a>递归的解法</h3><p>递归的解法是最基础, 也是最好理解, 但是时间复杂度很高, 为 $O(2^n)$ ,空间复杂度为$O(2^n)$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">fibRecursion</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fibRecursion(n - <span class="number">1</span>) + fibRecursion(n - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="迭代的解法"><a href="#迭代的解法" class="headerlink" title="迭代的解法"></a>迭代的解法</h3><p>迭代的解法即将已经解决的位置处的数存储, 之后直接调用, 不用再计算</p>
<p>时间复杂度为$O(n)$, 空间复杂度为$O(n)$.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">fibIteration</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    arr[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        arr[i] = arr[i - <span class="number">1</span>] + arr[i - <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>仅记录前两个值, 空间复杂度为$O(1)$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger <span class="title">fibIteration</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        BigInteger res = <span class="keyword">new</span> BigInteger(<span class="string">"0"</span>);</span><br><span class="line">        BigInteger pre_1 = BigInteger.valueOf(<span class="number">1</span>);</span><br><span class="line">        BigInteger pre_2 = BigInteger.valueOf(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            res = pre_1.add(pre_2);</span><br><span class="line">            pre_2 = pre_1;</span><br><span class="line">            pre_1 = res;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="进阶解法"><a href="#进阶解法" class="headerlink" title="进阶解法"></a>进阶解法</h2><h3 id="推导过程"><a href="#推导过程" class="headerlink" title="推导过程"></a>推导过程</h3><p>$$<br>F(n)=F(n-1)+F(n-2) \\<br>\Rightarrow<br>\begin{vmatrix}<br>F(n) &amp; F(n-1) \\<br>\end{vmatrix}<br>=<br>\begin{vmatrix}<br>F(n) &amp; F(n-1)<br>\end{vmatrix}<br>\times<br>\begin{vmatrix}<br>a &amp; b \\<br>c &amp; d<br>\end{vmatrix}\\<br>$$</p>
<p>解得:<br></p>
<p>$$<br>a=1 \<br>b=1 \<br>c=1 \<br>d=1<br>$$</p>
<p>即: <br></p>
<p>$$<br>\begin{vmatrix}<br> F(n) &amp; F(n-1)<br>\end{vmatrix}<br>=<br>\begin{vmatrix}<br>F(n-1)&amp; F(n-2)<br>\end{vmatrix}<br>\times<br>\begin{vmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{vmatrix}<br>\\<br>\Rightarrow<br>\begin{vmatrix}<br> F(n) &amp; F(n-1)<br>\end{vmatrix}<br>=<br>\begin{vmatrix}<br> 1 &amp; 1<br>\end{vmatrix}<br>\times<br>{\begin{vmatrix}<br>1 &amp; 1 \\<br>1 &amp; 0<br>\end{vmatrix}}^{n-2}<br>$$</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger <span class="title">fibMatrix</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (BigInteger.ZERO.compareTo(BigInteger.valueOf(n)) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BigInteger(<span class="string">"0"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (BigInteger.ONE.compareTo(BigInteger.valueOf(n)) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> matrixPower(<span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;<span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;&#125;, n)[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算矩阵matrix的p次方</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger[][] matrixPower(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> p) <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix[<span class="number">0</span>].length != matrix.length) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"矩阵输入错误, 无法进行乘法."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    BigInteger[][] res = <span class="keyword">new</span> BigInteger[matrix.length][matrix.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; res.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; res[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            res[i][j] = BigInteger.valueOf(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; res.length; i++) &#123;</span><br><span class="line">        res[i][i] = <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BigInteger[][] tmp = <span class="keyword">new</span> BigInteger[matrix.length][matrix.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tmp.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tmp[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            tmp[i][j] = BigInteger.valueOf(matrix[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (p &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> flag = p &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (flag == <span class="number">1</span>) &#123;</span><br><span class="line">            res = multiMatrix(res, tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        tmp = multiMatrix(tmp, tmp);</span><br><span class="line">        p = p &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> multiMatrix(<span class="keyword">new</span> BigInteger[][]&#123;&#123;<span class="keyword">new</span> BigInteger(<span class="string">"1"</span>), <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>)&#125;&#125;, res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//矩阵乘法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger[][] multiMatrix(BigInteger[][] m1, BigInteger[][] m2) <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">    <span class="keyword">if</span> (m1[<span class="number">0</span>].length != m2.length) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"矩阵输入错误, 无法进行乘法."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    BigInteger[][] res = <span class="keyword">new</span> BigInteger[m1.length][m2[<span class="number">0</span>].length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m1.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m2[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            res[i][j] = <span class="keyword">new</span> BigInteger(<span class="string">"0"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m1.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m2[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; m2.length; k++) &#123;</span><br><span class="line">                res[i][j] = res[i][j].add(m1[i][k].multiply(m2[k][j]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="运行时间比较"><a href="#运行时间比较" class="headerlink" title="运行时间比较:"></a>运行时间比较:</h2><p>当n=45时, 递归的方法就需要6794ms才能完成.</p>
<p>当n=1000000时, 迭代的方法耗时16s左右, 使用矩阵的方法只需耗时1.266s即完成</p>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> dynamic_programming </tag>
            
            <tag> Fibonacci </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[代理模式]]></title>
      <url>https://ivyxjc.xyz/2017/01/08/design_pattern/2017-01-08-proxy-pattern/</url>
      <content type="html"><![CDATA[<p>代理模式也叫委托模式, 应用非常广泛. 其定义:<br><br>Provide a surrogate or placehoder for another object to control access to it.(为其它对象提供一种代理以控制对这个对象的访问)</p>
<a id="more"></a>
<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><h3 id="抽象主题类"><a href="#抽象主题类" class="headerlink" title="抽象主题类"></a>抽象主题类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="comment">//定义一个方法</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###真实主题类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代理类"><a href="#代理类" class="headerlink" title="代理类"></a>代理类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Subject subject = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subject=<span class="keyword">new</span> Proxy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">(Subject subject)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subject=subject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">(Object... objects)</span></span>&#123;</span><br><span class="line">        <span class="comment">//todo</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//todo</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//todo</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//todo</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个代理类可以代理多个被代理者, 而在使用时, 该代理类到底代理哪个真实类, 可以由场景类决定.</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ol>
<li>职责清晰</li>
<li>高扩展性</li>
<li>智能化</li>
</ol>
<h2 id="代理分类"><a href="#代理分类" class="headerlink" title="代理分类"></a>代理分类</h2><p>设计模式中的代理分为普通代理和强制代理.</p>
<p>###　普通代理</p>
<p>普通代理的要求便是: 客户端只能访问代理角色, 而不能访问真实角色. 可以通过代理角色传递真实角色所需要的参数.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayer</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayer</span><span class="params">(IGamePlayer gamePlayer,String name)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(gamePlayer==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"不能创建真实角色"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name=name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"登录名"</span>+user+<span class="string">"的用户"</span>+<span class="keyword">this</span>.name+<span class="string">"登录成功!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayerProxy</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IGamePlayer mIGamePlayer=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayerProxy</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            mIGamePlayer=<span class="keyword">new</span> GamePlayer(<span class="keyword">this</span>,name);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e )&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mIGamePlayer.login(user,password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">客户类代码</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    IGamePlayer proxy=<span class="keyword">new</span> GamePlayerProxy(<span class="string">"张三"</span>);</span><br><span class="line">    </span><br><span class="line">    System.out.println(<span class="string">"start time"</span>);  </span><br><span class="line">    proxy.login(<span class="string">"zhangsan"</span>,<span class="string">"password"</span>);</span><br><span class="line">    System.out.println(<span class="string">"end time"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###　强制代理</p>
<p>强制代理要求必须通过真实角色去寻找代理角色, 否则不能访问.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//每个人都可以找到自己的代理</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IGamePlayer <span class="title">getProxy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayer</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//我的代理是谁</span></span><br><span class="line">    <span class="keyword">private</span> IGamePlayer proxy=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayer</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.isProxy())&#123;</span><br><span class="line">            System.out.println(<span class="string">"登录名"</span>+user+<span class="string">"的用户"</span>+<span class="keyword">this</span>.name+<span class="string">"登录成功!"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"请使用指定的代理访问"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IGamePlayer <span class="title">getProxy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.proxy=<span class="keyword">new</span> GamePlayerProxy(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.proxy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.proxy==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayerProxy</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IGamePlayer gameplayer=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayerProxy</span><span class="params">(IGamePlayer gamePlayer)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gameplayer=gamePlayer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gameplayer.login(user,password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IGamePlayer <span class="title">getProxy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">客户类代码</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        IGamePlayer gameplayer=<span class="keyword">new</span> GamePlayer(<span class="string">"张三"</span>);</span><br><span class="line">        IGamePlayer proxy=gameplayer.getProxy();</span><br><span class="line">        System.out.println(<span class="string">"start time"</span>);</span><br><span class="line">        proxy.login(<span class="string">"zhangsan"</span>,<span class="string">"password"</span>);</span><br><span class="line">        System.out.println(<span class="string">"end time"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayIH</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">    <span class="comment">//被代理者</span></span><br><span class="line">    Class cls=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//被代理的实例</span></span><br><span class="line">    Object obj=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayIH</span><span class="params">(Object obj)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obj=obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object result=method.invoke(<span class="keyword">this</span>.obj,args);</span><br><span class="line">        <span class="keyword">if</span>(method.getName().equalsIgnoreCase(<span class="string">"login"</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">"有人正在用我账号登录"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayer</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayer</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String password)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"登录名"</span>+user+<span class="string">"的用户"</span>+<span class="keyword">this</span>.name+<span class="string">"登录成功!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">客户类代码</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">    IGamePlayer player=<span class="keyword">new</span> GamePlayer(<span class="string">"张三"</span>);</span><br><span class="line">    InvocationHandler handler=<span class="keyword">new</span> GamePlayIH(player);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"start time"</span>);</span><br><span class="line">    <span class="comment">//获取类的ClassLoader</span></span><br><span class="line">    ClassLoader cl=player.getClass().getClassLoader();</span><br><span class="line">    <span class="comment">//动态生产一个代理者</span></span><br><span class="line">    IGamePlayer proxy=(IGamePlayer) Proxy.newProxyInstance(cl,<span class="keyword">new</span> Class[]&#123;IGamePlayer.class&#125;,handler);</span><br><span class="line">    </span><br><span class="line">    proxy.login(<span class="string">"zhangsan"</span>,<span class="string">"password"</span>);</span><br><span class="line">    System.out.println(<span class="string">"end time    "</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vim相关命令及用法]]></title>
      <url>https://ivyxjc.xyz/2017/01/03/%E6%95%88%E7%8E%87/2017-01-03-vim/</url>
      <content type="html"><![CDATA[<h2 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h2><ol>
<li>向左侧移动num个单词并将光标置于单词首: [num]b</li>
<li>向右侧移动num个单词并将光标置于单词首: [num]w</li>
<li>向右侧移动num个单词并将光标置于单词尾: [num]e</li>
<li>向左侧移动num个单词并将光标置于单词尾: [num]ge</li>
</ol>
<p>移至行末且进入插入模式: A</p>
<p>##　删除,　复制,　粘贴</p>
<p>删除当前行至缓冲区: dd<br>复制当前行: yy</p>
<p>粘贴: p</p>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faq </tag>
            
            <tag> vim </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[构建Spring Web应用]]></title>
      <url>https://ivyxjc.xyz/2016/12/30/javaWeb/spring/2016-12-30-spring-mvc-basic/</url>
      <content type="html"></content>
      
        <categories>
            
            <category> JavaWeb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javaweb </tag>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring 面向切面编程]]></title>
      <url>https://ivyxjc.xyz/2016/12/26/javaWeb/spring/2016-12-26-Spring-aop-basic/</url>
      <content type="html"></content>
      
        <categories>
            
            <category> JavaWeb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javaweb </tag>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring高级装配]]></title>
      <url>https://ivyxjc.xyz/2016/12/25/javaWeb/spring/2016-12-25-Spring-Intermediate/</url>
      <content type="html"><![CDATA[<h2 id="环境与配置"><a href="#环境与配置" class="headerlink" title="环境与配置"></a>环境与配置</h2><p>由于在项目开发时和项目配置时, 可能会有一些代码的不同, 如何根据不同的环境来进行配置. Spring有bean profile的功能. </p>
<h3 id="在JavaConfig中配置profile"><a href="#在JavaConfig中配置profile" class="headerlink" title="在JavaConfig中配置profile"></a>在JavaConfig中配置profile</h3><p>在Java配置中, 使用@Profile注解来确定这个bean属于哪一个profile.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span></span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile</span>(<span class="string">"dev"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ClassName <span class="title">function1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Profile</span>(<span class="string">"prod"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ClassName <span class="title">function2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="在XML中配置profile"><a href="#在XML中配置profile" class="headerlink" title="在XML中配置profile"></a>在XML中配置profile</h3><h3 id="激活profile"><a href="#激活profile" class="headerlink" title="激活profile"></a>激活profile</h3><p>Spring依据两个独立的属性来判断激活哪一个profile. 这两个独立的属性便是spring.profiles.active和spring.profiles.default. 如果设置了active参数, 则根据该值来判断激活哪一个profile. 若没有, 则根据default值来判断, 若两个值都未设置, 则只会加载那些没有定义在profile中的bean.</p>
<h2 id="条件化bean"><a href="#条件化bean" class="headerlink" title="条件化bean"></a>条件化bean</h2><p>Spring4之后引入了@Conditional注解, 给定的计算结果为true, 则创建该bean, 否则该bean会被忽略.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Conditional</span>(MagicExistsCondition.class)</span><br><span class="line"><span class="keyword">public</span> .....&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MagicExistsCondition</span> <span class="keyword">implements</span> <span class="title">Condition</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span></span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中ConditionContext是一个接口, 主要有以下几个作用:</p>
<ol>
<li>借助getRegistry()返回的BeanDefinitionRegistry检查bean定义</li>
<li>借助getBeanFactory()返回的ConfigurableListableBeanFactory检查bean是否存在, 探查bean的属性</li>
<li>借助getEnvironment()返回的Environment检查环境变量是否存在以及它的值是什么</li>
<li>读取并探查getResourceLoader()返回的ResourceLoader所加载的资源</li>
<li>借助getClassLoader()返回的ClassLoader加载并检查类是否存在</li>
</ol>
<p>AnnotatedTypeMetadata可以检查带有@Bean注解的方法上还有什么注解</p>
<p>可以借助isAnnotated(String str) 来判断带有@Bean注解的方法是否还有特定的注解 </p>
<h2 id="处理自动装配的歧义性"><a href="#处理自动装配的歧义性" class="headerlink" title="处理自动装配的歧义性"></a>处理自动装配的歧义性</h2><p>当有多个bean都满足某一装配要求时, 就会出现问题. 解决方法有:</p>
<ol>
<li>标示首选的bean</li>
<li>使用限定符</li>
</ol>
<h3 id="标示首选的bean"><a href="#标示首选的bean" class="headerlink" title="标示首选的bean"></a>标示首选的bean</h3><p>@Primary可以来将一个bean标识为首选bean. @Primary既可以与@Component组合用在组件扫描的bean上, 也可以与@Bean组合用在JavaConfig文件中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Componen</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> <span class="keyword">implements</span> <span class="title">InterfaceName</span></span>&#123;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="function"><span class="keyword">public</span>  ClassName <span class="title">getBean1</span><span class="params">(...)</span></span>&#123;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然, 也可以使用XML文件来标识首选bean</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">primary</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>不可以将多个可能产生歧义的bean设为首选.</p>
<h3 id="使用限定符"><a href="#使用限定符" class="headerlink" title="使用限定符"></a>使用限定符</h3><p>标示首选bean只可以解决较为简单的bean歧义问题, 如果问题较为复杂, 则无法解决. </p>
<p>使用@Qualifier注解是使用限定符的主要方式. 它可以与@Autowired和@Inject协同使用.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier</span>(<span class="string">"bean_id"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArg1</span><span class="params">(InterfaceName i)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Qualifier注解声明了想要注入的bean的ID.  </p>
<p>@Qualifier也可以使用自定义的限定符而非bean的id, 方法如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Qualifier</span>(<span class="string">"qualifier_id"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> <span class="keyword">implements</span> <span class="title">InterfaceName</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用自定义限定符"><a href="#使用自定义限定符" class="headerlink" title="使用自定义限定符"></a>使用自定义限定符</h3><p>当一个限定符仍然不可以解决歧义问题, 就需要使用自定义限定符号(Java8之前版本不支持同一个条目重复出现多个相同类型的注解). </p>
<p>注: Java8允许出现重复注解, 只要注解本身在定义的时候带有@Repeatable即可. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.CONSTRUCTOR,ElementType.FIELD,</span><br><span class="line">        ElementType.METHOD,ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Cold&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.CONSTRUCTOR,ElementType.FIELD,</span><br><span class="line">        ElementType.METHOD,ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Warm&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Cold</span></span><br><span class="line"><span class="meta">@Warm</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> <span class="keyword">implements</span> <span class="title">InterfaceName</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Bean的作用域"><a href="#Bean的作用域" class="headerlink" title="Bean的作用域"></a>Bean的作用域</h2><p>Spring定义了多个作用域:</p>
<ol>
<li>单例(Singleton): 在整个应用中, 只创建一个实例( 默认实现) </li>
<li>原型(Prototype): 每次注入或者通过Spring应用上下文获取的时候, 都会创建一个新的实例</li>
<li>会话(Session): 在Web应用中, 为每一个回话创建一个bean实例</li>
<li>请求(Request): 在Web应用中, 为每个请求创建一个bean实例</li>
</ol>
<p>如果要使用单例以外的作用域, 可以使用@Scope注解.</p>
<p>使用组件扫描来发现和声明bean, 则可以在bean的类上使用@Scope注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Componet</span></span><br><span class="line"><span class="meta">@Scope</span>(ConfigurableBeanFactory.SCOPE_PROTOTYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用<code>@Scope(&quot;prototype&quot;)</code>也是可以的, 但是更易出错.</p>
<p>同样可以在Java配置中来声明原型bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Scope</span>(ConfigurableBeanFactory.SCOPE_PROTOTYPE)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ClassName <span class="title">getArg</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用XML文件也可以来配置bean.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">scope</span>=<span class="string">"prototype"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="运行时注入"><a href="#运行时注入" class="headerlink" title="运行时注入"></a>运行时注入</h2>]]></content>
      
        <categories>
            
            <category> JavaWeb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javaweb </tag>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Spring装配bean]]></title>
      <url>https://ivyxjc.xyz/2016/12/20/javaWeb/spring/2016-12-20-Spring-bean/</url>
      <content type="html"><![CDATA[<p>Spring有三种装配机制:</p>
<ol>
<li>在XML文件进行显示配置</li>
<li>在Java中进行显示配置</li>
<li>隐式的bean发现机制和自动装配</li>
</ol>
<a id="more"></a>
<h2 id="自动化装配bean"><a href="#自动化装配bean" class="headerlink" title="自动化装配bean"></a>自动化装配bean</h2><h3 id="使得bean可以被发现"><a href="#使得bean可以被发现" class="headerlink" title="使得bean可以被发现"></a>使得bean可以被发现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CompactDisc</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SgtPeppers</span> <span class="keyword">implements</span> <span class="title">CompactDisc</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String title=<span class="string">"title"</span>;</span><br><span class="line">    <span class="keyword">private</span> String artist=<span class="string">"artist"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Playing "</span>+title+<span class="string">" by "</span>+artist);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在类上使用@Component注解, 这个注解表明该类会作为组件类.</p>
<h3 id="开启组件扫描"><a href="#开启组件扫描" class="headerlink" title="开启组件扫描"></a>开启组件扫描</h3><h4 id="Java开启组件扫描"><a href="#Java开启组件扫描" class="headerlink" title="Java开启组件扫描"></a>Java开启组件扫描</h4><p>在类前添加@ComponentScan注解, 即可开启组件扫描, 默认扫描本类所在的包及其子包, 查找所有带@Component注解的类.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CDPlayerConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="扫描其它的包"><a href="#扫描其它的包" class="headerlink" title="扫描其它的包"></a>扫描其它的包</h3><p>可以给ComponentScan添加相关的属性来自定义需要扫描的包:</p>
<ol>
<li>ComponentScan(“packageName”)</li>
<li>ComponentScan(basePackage={“package1”,”package2”})</li>
<li>ComponentScan(basePackageClasses={Class1.class,CLass2.class})</li>
</ol>
<p>方案1将扫描指定包名, 方案2将扫描指定的多个包及其子包, 方案3将扫描这个几个类所在的包及其子包. 在第三种方法中, 我们可以在包中添加一个空的接口, 然后使用该接口来作为扫描的标记.</p>
<h4 id="XML文件开启组件扫描"><a href="#XML文件开启组件扫描" class="headerlink" title="XML文件开启组件扫描"></a>XML文件开启组件扫描</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"packageName"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="添加注解自动装配"><a href="#添加注解自动装配" class="headerlink" title="添加注解自动装配"></a>添加注解自动装配</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompactDisc</span><span class="params">(CompactDisc cd)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.cd = cd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果没有匹配的bean, 在创建应用上下文时, Spring会抛出一个异常. 可以使用<code>@Autowired(required=false)</code>来避免此异常. 此时, Spring会尝试自动装箱, 但是如果没有匹配的bean时, Spring会让该bean处于未装配的状态. 如果此时调用未装配状态的属性时 可以能会抛出NullPointerException.</p>
<h2 id="Java装配bean"><a href="#Java装配bean" class="headerlink" title="Java装配bean"></a>Java装配bean</h2><p>利用JavaConfig来装配bean是比较好的方案. 相对于使用XML文件来装配bean, 它更为强大, 类型安全且更便于重构.</p>
<h3 id="创建配置类"><a href="#创建配置类" class="headerlink" title="创建配置类"></a>创建配置类</h3><p>创建配置类, 为类添加@Configuration的注解.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanConfig</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="声明bean"><a href="#声明bean" class="headerlink" title="声明bean"></a>声明bean</h3><p>利用JavaConfig来声明bean, 需要编写一个创建所需类型的实例的方法, 并在该方法上添加@Bean注解.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ClassName <span class="title">bean1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ClassName();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Bean的注解会告诉Spring该方法会返回一个ClassName实例, 该对象将被注册为bean, 方法体中包含了最终产生的bean的具体方法.</p>
<p>该bean的ID默认即为方法名, 当然可以使用<code>@Bean(name=&quot;id&quot;)</code>自定义bean的id.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Class1 <span class="title">classBean1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ...;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ClassName <span class="title">bean1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ClassName(classBean1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ClassName <span class="title">bean2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ClassName(classBean1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>默认情况下, Spring的bean都是单例, 所以当有多个注入方法中都使用到了classBean1方法的时候, 事实上传入bean1和bean2方法中的Class1实例为同一个.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ClassName <span class="title">bean1</span><span class="params">(Class1 class1)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ....;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里, <code>bean1</code>方法请求了一个Class1参数. 当Spring调用bean1方法来创建一个ClassName bean的时候, 会自动地装配一个Class1到该方法中. 这种方法是比较好的, 使用这种方法, 它不会要求Class1也在同一个配置类中声明. Spring可以自动扫描多个JavaConfig类, 甚至XML文件来实现这种装配.</p>
<h2 id="XML装配bean"><a href="#XML装配bean" class="headerlink" title="XML装配bean"></a>XML装配bean</h2><p>XML在Spring早期是描述配置的主要书写方式, 但是现在更因为依赖于自动化配置和依赖Java的配置. 一个很主要的原因即在于, 使用XML文件来配置时, 大量的class属性是以字符串形式来保存的, 并不能在编译期间接受类型检查. 不过可以利用IDE的自动感知功能来确保XML配置中类型的正确.</p>
<p>最基本的XML配置文件如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="声明一个简单的bean"><a href="#声明一个简单的bean" class="headerlink" title="声明一个简单的bean"></a>声明一个简单的bean</h3><p>可以按照如下方式声明bean:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"ClassName"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以向这个bean添加id:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="构造器注入初始化bean"><a href="#构造器注入初始化bean" class="headerlink" title="构造器注入初始化bean"></a>构造器注入初始化bean</h3><p>两种方案来构建构造器注入:</p>
<ol>
<li><code>&lt;construct-arg&gt;</code>元素</li>
<li><code>c-</code>命名空间</li>
</ol>
<p>在大部分情况下, 这两种方式基本上是相同的, 但是对于部分情况, 只有<code>&lt;construct-arg&gt;</code>能够做到(例如注入集合).</p>
<h4 id="构造器注入bean引用"><a href="#构造器注入bean引用" class="headerlink" title="构造器注入bean引用"></a>构造器注入bean引用</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;construct-arg ref="bean1"/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>创建一个ClassName实例,其中将一个ID为bean1的bean引用传递到ClassName的构造器中.</p>
<p>使用c-命名空间:<br></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;c:arg-ref="bean1"/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;c:_0-ref="bean1"/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;c:_-ref="bean1"/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>其中c:表示c-命名空间前缀, arg是构造器中相应的参数名称, -ref表示注入的是bean引用. bean1为要注入的bean的ID.</li>
<li>也可以使用参数在参数列表中的位置来注入bean, _0, _1 …来表示对应的参数</li>
<li>如果只有一个参数, 可以只使用_</li>
</ol>
<h4 id="构造器注入字面量"><a href="#构造器注入字面量" class="headerlink" title="构造器注入字面量"></a>构造器注入字面量</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassName</span><span class="params">(String title, String artist)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;construct-arg value="some strings"/&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">construct-arg</span> <span class="attr">value</span>=<span class="string">"some strings"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用c-命名空间:<br></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;c:_title="some strings"/&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:_artist="some</span> <span class="attr">strings</span>"/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;c:_0="some strings"/&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">c:_1="some</span> <span class="attr">strings</span>"/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>与装配bean引用的区别就在与删除了最后的-ref. 如果只有一个参数, 同样可以使用 _ . </p>
<h4 id="构造器注入集合"><a href="#构造器注入集合" class="headerlink" title="构造器注入集合"></a>构造器注入集合</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClassName</span><span class="params">(String title, String artist, List&lt;String&gt; tracks)</span></span>&#123;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">class</span>=<span class="string">"ClassName"</span></span></span><br><span class="line">    &lt;construct-arg value="some strings"/&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">construct-arg</span> <span class="attr">value</span>=<span class="string">"some strings"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">construct-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>some strings<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>some strings<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>some strings<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">construct-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果bean引用的list的话, 将value改为ref即可. 如果需要使用集合, 将list改为set即可.</p>
<h3 id="属性注入初始化bean"><a href="#属性注入初始化bean" class="headerlink" title="属性注入初始化bean"></a>属性注入初始化bean</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSomeArg</span><span class="params">(Class1 arg1)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">ClassName</span>=<span class="string">"ClassName"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"someArg"</span> <span class="attr">ref</span>=<span class="string">"bean1"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;property&gt;</code>元素为属性的Setter方法提供的功能与<code>&lt;construct-arg&gt;</code>元素为构造器所提供的功能是一样的, 用法也类似, 同样可以使用p-命名空间来代替.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;id&quot; ClassName=&quot;ClassName&quot;&gt;</span><br><span class="line">    &lt;p:someArg-ref=&quot;bean1&quot; /&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> JavaWeb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> javaweb </tag>
            
            <tag> spring </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[如何下拉, 上拉刷新数据]]></title>
      <url>https://ivyxjc.xyz/2016/12/07/android/UI%E7%9B%B8%E5%85%B3/2016-12-7-Pull-Refresh/</url>
      <content type="html"><![CDATA[<h2 id="SwipeRefreshLayout"><a href="#SwipeRefreshLayout" class="headerlink" title="SwipeRefreshLayout"></a>SwipeRefreshLayout</h2><p><code>SwipeRefreshLayout</code>是由google官方提出的下拉刷新空间, 在<code>android.support.v4</code>兼容库中.</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="布局文件"><a href="#布局文件" class="headerlink" title="布局文件"></a>布局文件</h4><p><code>SwipeRefreshLayout</code>基本上可以包裹任何可以滚动的内容(ListView, RecyclerView…,WebView)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.v4.widget.SwipeRefreshLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/swipe_refresh"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/news_rv"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.v7.widget.RecyclerView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.v4.widget.SwipeRefreshLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="刷新操作"><a href="#刷新操作" class="headerlink" title="刷新操作"></a>刷新操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mSwipeRefreshLayout=(SwipeRefreshLayout)findViewById(R.id.swipe_refresh);</span><br><span class="line">mSwipeRefreshLayout.setOnRefreshListener(<span class="keyword">new</span> SwipeRefreshLayout.OnRefreshListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                pageNum+=<span class="number">1</span>;</span><br><span class="line">                updateDatas(service,apiKey,pageNum);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">....</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateDatas</span><span class="params">(Api.NewsService service,String apiKey,<span class="keyword">int</span> pageNum)</span></span>&#123;</span><br><span class="line">        service.getList(apiKey,pageNum)</span><br><span class="line">                .subscribeOn(Schedulers.io())</span><br><span class="line">                .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Subscriber&lt;News&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                      ...</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                      ...</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(News news)</span> </span>&#123;</span><br><span class="line">                        datas=news.getDatas();</span><br><span class="line">                        notifyDatasetChanged(datas);</span><br><span class="line">                        mSwipeRefreshLayout.setRefreshing(<span class="keyword">false</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在获取完数据之后, 需要调用<code>mSwipeRefreshLayout.setRefreshing(false);</code>, 否则加载的小圆圈将一直在旋转.</p>
<h4 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置下拉出现的小圆圈是否缩放出现，出现的位置，最大的下拉位置</span></span><br><span class="line"> mSwipeRefreshLayout.setProgressViewOffset(<span class="keyword">true</span>,R.attr.actionBarSize+<span class="number">20</span>,<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置下拉圆圈的大小，两个值 LARGE， DEFAULT</span></span><br><span class="line">mySwipeRefreshLayout.setSize(SwipeRefreshLayout.LARGE);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 禁用下拉刷新</span></span><br><span class="line">mySwipeRefreshLayout.setEnabled(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设定下拉圆圈的背景颜色</span></span><br><span class="line">mySwipeRefreshLayout.setProgressBackgroundColor(R.color.red);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置下拉圆圈的颜色, 将按照该颜色顺序展示</span></span><br><span class="line">mySwipeRefreshLayout.setColorSchemeResources(color1,color2);</span><br></pre></td></tr></table></figure>
<h2 id="Ultra-Pull-to-Refresh"><a href="#Ultra-Pull-to-Refresh" class="headerlink" title="Ultra Pull to Refresh"></a>Ultra Pull to Refresh</h2><h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">build.gradle(project)</span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &apos;https://oss.sonatype.org/content/repositories/snapshots&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build.gradle(app)</span><br><span class="line">compile &apos;in.srain.cube:ultra-ptr:1.0.11&apos;</span><br></pre></td></tr></table></figure>
<h4 id="布局文件-1"><a href="#布局文件-1" class="headerlink" title="布局文件"></a>布局文件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">in.srain.cube.views.ptr.PtrClassicFrameLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/refresh_layout"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginTop</span>=<span class="string">"?attr/actionBarSize"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.v7.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/news_rv"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.v7.widget.RecyclerView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">in.srain.cube.views.ptr.PtrClassicFrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="刷新操作-1"><a href="#刷新操作-1" class="headerlink" title="刷新操作"></a>刷新操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mRefreshLayout=(PtrFrameLayout)findViewById(R.id.refresh_layout);</span><br><span class="line">mRefreshLayout.setLoadingMinTime(<span class="number">1000</span>);</span><br><span class="line">mRefreshLayout.setPullToRefresh(<span class="keyword">true</span>);</span><br><span class="line">...</span><br><span class="line">mRefreshLayout.setPtrHandler(<span class="keyword">new</span> PtrHandler() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkCanDoRefresh</span><span class="params">(PtrFrameLayout frame, View content, View header)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// here check list view, not content.</span></span><br><span class="line">        <span class="keyword">return</span> PtrDefaultHandler.checkContentCanBePulledDown(frame,content, header);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefreshBegin</span><span class="params">(PtrFrameLayout frame)</span> </span>&#123;</span><br><span class="line">        pageNum+=<span class="number">1</span>;</span><br><span class="line">        updateDatas(service,apiKey,pageNum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateDatas</span><span class="params">(Api.NewsService service,String apiKey,<span class="keyword">int</span> pageNum)</span></span>&#123;</span><br><span class="line">        service.getList(apiKey,pageNum)</span><br><span class="line">                .subscribeOn(Schedulers.io())</span><br><span class="line">                .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Subscriber&lt;News&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(News news)</span> </span>&#123;</span><br><span class="line">                        datas=news.getShowapi_res_body().getPagebean().getContentlist();</span><br><span class="line">                        notifyDatasetChanged(datas);</span><br><span class="line">                        mRefreshLayout.refreshComplete();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_refresh </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[动态规划]]></title>
      <url>https://ivyxjc.xyz/2016/12/06/algorithm/algorithm/2016-12-6-dynamic-programming/</url>
      <content type="html"><![CDATA[<p>动态规划适用于原问题的子问题之间还存在公共子子问题, 分治法适用于子问题之间没有过多的相互关系.</p>
<a id="more"></a>
<h2 id="钢条切割问题"><a href="#钢条切割问题" class="headerlink" title="钢条切割问题"></a>钢条切割问题</h2><p>不同长度的钢条可以售出不同的价格, 现有一根长度为n的钢条, 现切割该钢条成不同长度的子钢条, 那么最佳的</p>
<h2 id="矩阵链问题"><a href="#矩阵链问题" class="headerlink" title="矩阵链问题"></a>矩阵链问题</h2><h2 id="最长公共子序列问题"><a href="#最长公共子序列问题" class="headerlink" title="最长公共子序列问题"></a>最长公共子序列问题</h2>]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> algorithm </tag>
            
            <tag> dynamic_programming </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Glide源码分析 一]]></title>
      <url>https://ivyxjc.xyz/2016/11/30/android/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/2016-11-30-Glide-source_1/</url>
      <content type="html"><![CDATA[<h2 id="从Glide入口开始"><a href="#从Glide入口开始" class="headerlink" title="从Glide入口开始"></a>从Glide入口开始</h2><p>Glide最简单的用法如下所示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Glide.with(context);</span><br><span class="line">    .load(url)</span><br><span class="line">    <span class="comment">//硬盘存储策略</span></span><br><span class="line">    .diskCacheStrategy(DiskCacheStrategy.ALL)</span><br><span class="line">    <span class="comment">//是否启用内存缓存 默认为true</span></span><br><span class="line">    .skipMemoryCache(<span class="keyword">false</span>)</span><br><span class="line">    .centerCrop()</span><br><span class="line">    .into(imageView);</span><br></pre></td></tr></table></figure>
<h3 id="with-context"><a href="#with-context" class="headerlink" title="with(context)"></a>with(context)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> RequestManager <span class="title">with</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    RequestManagerRetriever retriever = RequestManagerRetriever.get();</span><br><span class="line">    <span class="keyword">return</span> retriever.get(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RequestManagerRetriever-get-context"><a href="#RequestManagerRetriever-get-context" class="headerlink" title="RequestManagerRetriever get(context)"></a>RequestManagerRetriever get(context)</h3><p>依据传入的context的类型, 进行相应的操作. context的类型主要分为<code>FragmentActivity</code>, <code>Activity</code>和<code>ContextWrapper</code>, 当context是<code>ContextWrapper</code>时, 调用<code>get(Context context)</code>查看其封装的是哪一种Activity.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">RequestManagerRetriever.java</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> RequestManager <span class="title">get</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (context == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"You cannot start a load on a null Context"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (Util.isOnMainThread() &amp;&amp; !(context <span class="keyword">instanceof</span> Application)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (context <span class="keyword">instanceof</span> FragmentActivity) &#123;</span><br><span class="line">            <span class="keyword">return</span> get((FragmentActivity) context);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (context <span class="keyword">instanceof</span> Activity) &#123;</span><br><span class="line">            <span class="keyword">return</span> get((Activity) context);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (context <span class="keyword">instanceof</span> ContextWrapper) &#123;</span><br><span class="line">            <span class="keyword">return</span> get(((ContextWrapper) context).getBaseContext());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> getApplicationManager(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RequestManagerRetriever-get-Activity-get-FragmentActivity"><a href="#RequestManagerRetriever-get-Activity-get-FragmentActivity" class="headerlink" title="RequestManagerRetriever get(Activity) get(FragmentActivity)"></a>RequestManagerRetriever get(Activity) get(FragmentActivity)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RequestManagerRetriever.java</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> RequestManager <span class="title">get</span><span class="params">(FragmentActivity activity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Util.isOnBackgroundThread()) &#123;</span><br><span class="line">        <span class="keyword">return</span> get(activity.getApplicationContext());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        assertNotDestroyed(activity);</span><br><span class="line">        FragmentManager fm = activity.getSupportFragmentManager();</span><br><span class="line">        <span class="keyword">return</span> supportFragmentGet(activity, fm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TargetApi</span>(Build.VERSION_CODES.HONEYCOMB)</span><br><span class="line"><span class="function"><span class="keyword">public</span> RequestManager <span class="title">get</span><span class="params">(Activity activity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Util.isOnBackgroundThread() || Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.HONEYCOMB) &#123;</span><br><span class="line">        <span class="keyword">return</span> get(activity.getApplicationContext());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//判断activity是否已经被销毁, 如果销毁抛出异常</span></span><br><span class="line">        assertNotDestroyed(activity);</span><br><span class="line">        <span class="comment">//获取对应FragmenManager</span></span><br><span class="line">        android.app.FragmentManager fm = activity.getFragmentManager();</span><br><span class="line">        <span class="keyword">return</span> fragmentGet(activity, fm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这两个方法差别不大, 主要是因为<code>FragmentActivity</code>来自于support v4库中, 和标准库Activity获取FragmentManager的方法以及返回的FragmentManager类型不太相同.</p>
<h3 id="RequestManagerRetriever-fragmentGet-Context-FramentManager"><a href="#RequestManagerRetriever-fragmentGet-Context-FramentManager" class="headerlink" title="RequestManagerRetriever fragmentGet(Context, FramentManager)"></a>RequestManagerRetriever fragmentGet(Context, FramentManager)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">RequestManagerRetriever.java</span><br><span class="line"></span><br><span class="line"><span class="meta">@TargetApi</span>(Build.VERSION_CODES.JELLY_BEAN_MR1)</span><br><span class="line"><span class="function">RequestManagerFragment <span class="title">getRequestManagerFragment</span><span class="params">(<span class="keyword">final</span> android.app.FragmentManager fm)</span> </span>&#123;</span><br><span class="line">    RequestManagerFragment current = (RequestManagerFragment) fm.findFragmentByTag(FRAGMENT_TAG);</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="keyword">null</span>) &#123;</span><br><span class="line">        current = pendingRequestManagerFragments.get(fm);</span><br><span class="line">        <span class="keyword">if</span> (current == <span class="keyword">null</span>) &#123;</span><br><span class="line">            current = <span class="keyword">new</span> RequestManagerFragment();</span><br><span class="line">            pendingRequestManagerFragments.put(fm, current);</span><br><span class="line">            fm.beginTransaction().add(current, FRAGMENT_TAG).commitAllowingStateLoss();</span><br><span class="line">            handler.obtainMessage(ID_REMOVE_FRAGMENT_MANAGER, fm).sendToTarget();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> current;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TargetApi</span>(Build.VERSION_CODES.HONEYCOMB)</span><br><span class="line"><span class="function">RequestManager <span class="title">fragmentGet</span><span class="params">(Context context, android.app.FragmentManager fm)</span> </span>&#123;</span><br><span class="line">    RequestManagerFragment current = getRequestManagerFragment(fm);</span><br><span class="line">    RequestManager requestManager = current.getRequestManager();</span><br><span class="line">    <span class="keyword">if</span> (requestManager == <span class="keyword">null</span>) &#123;</span><br><span class="line">        requestManager = <span class="keyword">new</span> RequestManager(context, current.getLifecycle(), current.getRequestManagerTreeNode());</span><br><span class="line">        current.setRequestManager(requestManager);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> requestManager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这两段代码的主要意义在于生成一个<code>RequestManagerFragment</code>并没有内容的但是绑定在制定的context上. 其实目的就是将该Fragment的生命周期绑定在该context上, 并在相应的方法调用时执行相应的操作.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">RequestManagerFragment.java</span><br><span class="line"></span><br><span class="line">ActivityFragmentLifecycle lifecycle;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onStart();</span><br><span class="line">    lifecycle.onStart();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onStop();</span><br><span class="line">    lifecycle.onStop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onDestroy();</span><br><span class="line">    lifecycle.onDestroy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RequestManager"><a href="#RequestManager" class="headerlink" title="RequestManager"></a>RequestManager</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">RequestManager implements LifecycleListener</span><br><span class="line"><span class="comment">//ActivityFragmentLifecycle 也实现了 LifecycleListener</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// onStart might not be called because this object may be created after the fragment/activity's onStart method.</span></span><br><span class="line">    resumeRequests();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Lifecycle callback that unregisters for connectivity events (if the android.permission.ACCESS_NETWORK_STATE</span></span><br><span class="line"><span class="comment">    * permission is present) and pauses in progress loads.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    pauseRequests();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Lifecycle callback that cancels all in progress requests and clears and recycles resources for all completed</span></span><br><span class="line"><span class="comment">    * requests.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    requestTracker.clearRequests();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ActivityFragmentLifecycle</span> <span class="keyword">implements</span> <span class="title">Lifecycle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Set&lt;LifecycleListener&gt; lifecycleListeners =</span><br><span class="line">            Collections.newSetFromMap(<span class="keyword">new</span> WeakHashMap&lt;LifecycleListener, Boolean&gt;());</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isStarted;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isDestroyed;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adds the given listener to the list of listeners to be notified on each lifecycle event.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     *     The latest lifecycle event will be called on the given listener synchronously in this method. If the</span></span><br><span class="line"><span class="comment">     *     activity or fragment is stopped, &#123;<span class="doctag">@link</span> LifecycleListener#onStop()&#125;&#125; will be called, and same for onStart and</span></span><br><span class="line"><span class="comment">     *     onDestroy.</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     *     Note - &#123;<span class="doctag">@link</span> com.bumptech.glide.manager.LifecycleListener&#125;s that are added more than once will have their</span></span><br><span class="line"><span class="comment">     *     lifecycle methods called more than once. It is the caller's responsibility to avoid adding listeners</span></span><br><span class="line"><span class="comment">     *     multiple times.</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addListener</span><span class="params">(LifecycleListener listener)</span> </span>&#123;</span><br><span class="line">        lifecycleListeners.add(listener);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isDestroyed) &#123;</span><br><span class="line">            listener.onDestroy();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isStarted) &#123;</span><br><span class="line">            listener.onStart();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            listener.onStop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        isStarted = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (LifecycleListener lifecycleListener : Util.getSnapshot(lifecycleListeners)) &#123;</span><br><span class="line">            lifecycleListener.onStart();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        isStarted = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (LifecycleListener lifecycleListener : Util.getSnapshot(lifecycleListeners)) &#123;</span><br><span class="line">            lifecycleListener.onStop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        isDestroyed = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (LifecycleListener lifecycleListener : Util.getSnapshot(lifecycleListeners)) &#123;</span><br><span class="line">            lifecycleListener.onDestroy();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述的代码总体的目的就是将RequestManager的生命周期和RequestManagerFragment绑定起来, 进而和Activity的生命周期绑定起来.</p>
<h2 id="RequestManager-1"><a href="#RequestManager-1" class="headerlink" title="RequestManager"></a>RequestManager</h2><p>下面来看一下RequestManager的功能.</p>
<h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">RequestManager.java</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RequestManager</span><span class="params">(Context context, Lifecycle lifecycle, RequestManagerTreeNode treeNode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(context, lifecycle, treeNode, <span class="keyword">new</span> RequestTracker(), <span class="keyword">new</span> ConnectivityMonitorFactory());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">RequestManager(Context context, <span class="keyword">final</span> Lifecycle lifecycle, RequestManagerTreeNode treeNode,</span><br><span class="line">        RequestTracker requestTracker, ConnectivityMonitorFactory factory) &#123;</span><br><span class="line">    <span class="keyword">this</span>.context = context.getApplicationContext();</span><br><span class="line">    <span class="keyword">this</span>.lifecycle = lifecycle;</span><br><span class="line">    <span class="keyword">this</span>.treeNode = treeNode;</span><br><span class="line">    <span class="keyword">this</span>.requestTracker = requestTracker;</span><br><span class="line">    <span class="keyword">this</span>.glide = Glide.get(context);</span><br><span class="line">    <span class="keyword">this</span>.optionsApplier = <span class="keyword">new</span> OptionsApplier();</span><br><span class="line"></span><br><span class="line">    ConnectivityMonitor connectivityMonitor = factory.build(context,</span><br><span class="line">            <span class="keyword">new</span> RequestManagerConnectivityListener(requestTracker));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we're the application level request manager, we may be created on a background thread. In that case we</span></span><br><span class="line">    <span class="comment">// cannot risk synchronously pausing or resuming requests, so we hack around the issue by delaying adding</span></span><br><span class="line">    <span class="comment">// ourselves as a lifecycle listener by posting to the main thread. This should be entirely safe.</span></span><br><span class="line">    <span class="keyword">if</span> (Util.isOnBackgroundThread()) &#123;</span><br><span class="line">        <span class="keyword">new</span> Handler(Looper.getMainLooper()).post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                lifecycle.addListener(RequestManager.<span class="keyword">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        lifecycle.addListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    lifecycle.addListener(connectivityMonitor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Glide-get-context"><a href="#Glide-get-context" class="headerlink" title="Glide.get(context)"></a>Glide.get(context)</h4><p>该方法就是利用单例模式获取一个Glide实例.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Glide.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Glide glide;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Glide <span class="title">get</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (glide == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (Glide.class) &#123;</span><br><span class="line">            <span class="keyword">if</span> (glide == <span class="keyword">null</span>) &#123;</span><br><span class="line">                Context applicationContext = context.getApplicationContext();</span><br><span class="line">                List&lt;GlideModule&gt; modules = <span class="keyword">new</span> ManifestParser(applicationContext).parse();</span><br><span class="line"></span><br><span class="line">                GlideBuilder builder = <span class="keyword">new</span> GlideBuilder(applicationContext);</span><br><span class="line">                <span class="keyword">for</span> (GlideModule <span class="keyword">module</span> : modules) &#123;</span><br><span class="line">                    <span class="keyword">module</span>.applyOptions(applicationContext, builder);</span><br><span class="line">                &#125;</span><br><span class="line">                glide = builder.createGlide();</span><br><span class="line">                <span class="keyword">for</span> (GlideModule <span class="keyword">module</span> : modules) &#123;</span><br><span class="line">                    <span class="keyword">module</span>.registerComponents(applicationContext, glide);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> glide;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="GlideBuilder"><a href="#GlideBuilder" class="headerlink" title="GlideBuilder"></a>GlideBuilder</h4><p>利用GlideBuilder中的createGlide()方法生成了Glide, 在这个过程中完成了以下几个任务:</p>
<ol>
<li>初始化线程池</li>
<li>初始化bitmap池</li>
<li>初始化内存缓存类</li>
<li>初始化内部磁盘缓存类</li>
<li>初始化引擎类</li>
<li>设置默认的解码格式</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">GlideBuilder.java</span><br><span class="line"></span><br><span class="line"><span class="function">Glide <span class="title">createGlide</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sourceService == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//初始化线程池</span></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> cores = Math.max(<span class="number">1</span>, Runtime.getRuntime().availableProcessors());</span><br><span class="line">        sourceService = <span class="keyword">new</span> FifoPriorityThreadPoolExecutor(cores);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (diskCacheService == <span class="keyword">null</span>) &#123;</span><br><span class="line">        diskCacheService = <span class="keyword">new</span> FifoPriorityThreadPoolExecutor(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//初始化bitmap池</span></span><br><span class="line">    MemorySizeCalculator calculator = <span class="keyword">new</span> MemorySizeCalculator(context);</span><br><span class="line">    <span class="keyword">if</span> (bitmapPool == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = calculator.getBitmapPoolSize();</span><br><span class="line">            bitmapPool = <span class="keyword">new</span> LruBitmapPool(size);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            bitmapPool = <span class="keyword">new</span> BitmapPoolAdapter();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (memoryCache == <span class="keyword">null</span>) &#123;</span><br><span class="line">        memoryCache = <span class="keyword">new</span> LruResourceCache(calculator.getMemoryCacheSize());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (diskCacheFactory == <span class="keyword">null</span>) &#123;</span><br><span class="line">        diskCacheFactory = <span class="keyword">new</span> InternalCacheDiskCacheFactory(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (engine == <span class="keyword">null</span>) &#123;</span><br><span class="line">        engine = <span class="keyword">new</span> Engine(memoryCache, diskCacheFactory, diskCacheService, sourceService);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (decodeFormat == <span class="keyword">null</span>) &#123;</span><br><span class="line">        decodeFormat = DecodeFormat.DEFAULT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Glide(engine, memoryCache, bitmapPool, context, decodeFormat);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ManifestParser"><a href="#ManifestParser" class="headerlink" title="ManifestParser"></a>ManifestParser</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">ManifestParser.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String GLIDE_MODULE_VALUE = <span class="string">"GlideModule"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;GlideModule&gt; <span class="title">parse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;GlideModule&gt; modules = <span class="keyword">new</span> ArrayList&lt;GlideModule&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//根据PackageName获取metadata信息</span></span><br><span class="line">        ApplicationInfo appInfo = context.getPackageManager().getApplicationInfo(</span><br><span class="line">                context.getPackageName(), PackageManager.GET_META_DATA);</span><br><span class="line">        <span class="comment">//若有metadata信息</span></span><br><span class="line">        <span class="keyword">if</span> (appInfo.metaData != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//遍历metadata</span></span><br><span class="line">            <span class="keyword">for</span> (String key : appInfo.metaData.keySet()) &#123;</span><br><span class="line">                <span class="comment">//将key和GLIDE_MODULE_VALUE相等的全部加入modules 之中</span></span><br><span class="line">                <span class="keyword">if</span> (GLIDE_MODULE_VALUE.equals(appInfo.metaData.get(key))) &#123;</span><br><span class="line">                    modules.add(parseModule(key));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (PackageManager.NameNotFoundException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unable to find metadata to parse GlideModules"</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> modules;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过反射获取GlideModule实例</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> GlideModule <span class="title">parseModule</span><span class="params">(String className)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; clazz;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        clazz = Class.forName(className);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Unable to find GlideModule implementation"</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object <span class="keyword">module</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">module</span> = clazz.newInstance();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unable to instantiate GlideModule implementation for "</span> + clazz, e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unable to instantiate GlideModule implementation for "</span> + clazz, e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!(<span class="keyword">module</span> <span class="keyword">instanceof</span> GlideModule)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Expected instanceof GlideModule, but found: "</span> + <span class="keyword">module</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (GlideModule) <span class="keyword">module</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过反射的方式获取在Manifest.xml中自定义的GlideModule对象, 获得之后遍历ArrayList<glidemodule>, 对每一个GlideModuled调用相应的applyOptions()和registerComponents()方法.</glidemodule></p>
]]></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Glide源码分析 二]]></title>
      <url>https://ivyxjc.xyz/2016/11/30/android/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/2016-12-5-Glide-source_2/</url>
      <content type="html"></content>
      
        
        <tags>
            
            <tag> android </tag>
            
            <tag> project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[知乎专栏android app开发中的一些问题及解决方法]]></title>
      <url>https://ivyxjc.xyz/2016/11/27/android/2016-11-27-zhihu-android/</url>
      <content type="html"><![CDATA[<p>经过一段时间的开发, 知乎专栏app主体上完成, 但还有很多功能没有做出来, 下面是开发过程中的一些问题以及将要完善的功能.</p>
<h2 id="如何根据点击自定义创建Fragment"><a href="#如何根据点击自定义创建Fragment" class="headerlink" title="如何根据点击自定义创建Fragment"></a>如何根据点击自定义创建Fragment</h2><p>当我们使用tablayout时, 根据点击选择创建fragment, 这时可以使用下面的方法根据传入的内容自定义生成fragment.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">replaceFragment</span><span class="params">(Fragment fragment)</span></span>&#123;</span><br><span class="line">       fm.beginTransaction()</span><br><span class="line">               .replace(R.id.fragment_container,fragment)</span><br><span class="line">               .commit();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">replaceFragment(FragmentTab.newSingleton(R.array.develop,R.array.develop_suffix));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FragmentTab <span class="title">newSingleton</span><span class="params">(<span class="keyword">int</span> titleId, <span class="keyword">int</span> suffixId)</span></span>&#123;</span><br><span class="line">       FragmentTab fragment=<span class="keyword">new</span> FragmentTab();</span><br><span class="line">       Bundle bundle=<span class="keyword">new</span> Bundle();</span><br><span class="line">       bundle.putInt(Constant.LIST_ACTIVITY_NAV_TITLE,titleId);</span><br><span class="line">       bundle.putInt(Constant.LIST_ACTIVITY_NAV_SUFFIX,suffixId);</span><br><span class="line">       fragment.setArguments(bundle);</span><br><span class="line">       <span class="keyword">return</span> fragment;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="如何设置夜间模式"><a href="#如何设置夜间模式" class="headerlink" title="如何设置夜间模式"></a>如何设置夜间模式</h2><h2 id="如何进行数据缓存"><a href="#如何进行数据缓存" class="headerlink" title="如何进行数据缓存"></a>如何进行数据缓存</h2><p>关于图片的缓存, Glide库已经完成</p>
<p>其它内容的缓存使用的是序列化来完成的. 加了缓存后, 就要注意从网络中获得数据之后如何处理这些缓存的数据. 我目前选择的方法是, 一旦从网络中获取到新的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Context context, String filename,Object list)</span></span>&#123;</span><br><span class="line">    FileOutputStream out=<span class="keyword">null</span>;</span><br><span class="line">    ObjectOutputStream writer=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        out=context.openFileOutput(filename, Context.MODE_PRIVATE);</span><br><span class="line">        writer=<span class="keyword">new</span> ObjectOutputStream(out);</span><br><span class="line">        writer.writeObject(list);</span><br><span class="line">        Log.i(TAG.CACHE_UTIL,<span class="string">"cache list"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        Log.i(TAG.CACHE_UTIL,e.toString());</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        Log.i(TAG.CACHE_UTIL,e.toString());</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(writer!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                writer.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">load</span><span class="params">(Context context,String filename)</span></span>&#123;</span><br><span class="line">    FileInputStream in=<span class="keyword">null</span>;</span><br><span class="line">    ObjectInputStream reader=<span class="keyword">null</span>;</span><br><span class="line">    Object res=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        in=context.openFileInput(filename);</span><br><span class="line">        reader=<span class="keyword">new</span> ObjectInputStream(in);</span><br><span class="line">        res=reader.readObject();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(reader!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                reader.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[利用Retrofit, RxJava获取网络内容]]></title>
      <url>https://ivyxjc.xyz/2016/11/25/android/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/2016-11-25-retrofit-rxjava/</url>
      <content type="html"><![CDATA[<h2 id="Retrofit-amp-RxJava"><a href="#Retrofit-amp-RxJava" class="headerlink" title="Retrofit &amp; RxJava"></a>Retrofit &amp; RxJava</h2><p>关于如何使用Retrofit和RxJava请阅读参考中的两篇文章.</p>
<h2 id="Retrofit处理数据"><a href="#Retrofit处理数据" class="headerlink" title="Retrofit处理数据"></a>Retrofit处理数据</h2><p>Retrofit是在什么时候处理从网络中获取到的json数据的呢? 我从几个使用了Retrofit的项目源代码寻找了半天, 也没有找到处理json的相关代码. 后来才发现, Retrofit中使用<code>.addConverterFactory(GsonConverterFactory.create())</code>其实就是自动添加了json解析, 它会将json数据直接转换为java类(即Pojo).</p>
<p><a href="http://pojo.sodhanalibrary.com/" target="_blank" rel="noopener">convertToPojo</a>可以根据json的内容自动生成Pojo类.</p>
<h3 id="以豆瓣api为例"><a href="#以豆瓣api为例" class="headerlink" title="以豆瓣api为例"></a>以豆瓣api为例</h3><h4 id="json数据格式"><a href="#json数据格式" class="headerlink" title="json数据格式"></a>json数据格式</h4><p>豆瓣正在热映的json数据格式大致如下:</p>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/douban_json.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DoubanService.java</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">DoubanService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GET</span>(<span class="string">"/v2/movie/in_theaters"</span>)</span><br><span class="line">    <span class="function">Call&lt;Douban&gt; <span class="title">getList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="pojo类"><a href="#pojo类" class="headerlink" title="pojo类"></a>pojo类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Douban</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SerializedName</span>(value = <span class="string">"subjects"</span>)</span><br><span class="line">    <span class="keyword">private</span> List&lt;Subjects&gt; subjects;</span><br><span class="line"></span><br><span class="line">    ...Getter and Setter..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Subjects</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> Rating rating;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rating</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String min;</span><br><span class="line">    <span class="keyword">private</span> String max;</span><br><span class="line">    <span class="keyword">private</span> String stars;</span><br><span class="line"></span><br><span class="line">    ...Getter and Setter..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="处理并显示数据"><a href="#处理并显示数据" class="headerlink" title="处理并显示数据"></a>处理并显示数据</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubanRun</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.run();</span><br><span class="line">        Retrofit retrofit=<span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                .baseUrl(<span class="string">"https://api.douban.com"</span>)</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">                .build();</span><br><span class="line">        DoubanService douban=retrofit.create(DoubanService.class);</span><br><span class="line">        Call&lt;Douban&gt; call=douban.getList();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Douban d=call.execute().body();</span><br><span class="line">            <span class="keyword">for</span> (Subjects l:d.getSubjects())&#123;</span><br><span class="line">                 Log.i(<span class="string">"TAGGGG"</span>,l.getId()+<span class="string">" "</span>+l.getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            Log.i(<span class="string">"TAGGGG"</span>,<span class="string">"ff"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">26630781 我不是潘金莲</span><br><span class="line">25726614 神奇动物在哪里</span><br><span class="line">25793398 海洋奇缘</span><br><span class="line">26365631 冲天火</span><br><span class="line">26596486 名侦探柯南：纯黑的恶梦</span><br><span class="line">3025375 奇异博士</span><br><span class="line">26370431 夏威夷之恋</span><br><span class="line">26673217 我是处女座</span><br><span class="line">26696875 最萌身高差</span><br><span class="line">25983044 比利·林恩的中场战事</span><br><span class="line">22266320 深海浩劫</span><br><span class="line">26876505 怨灵地下室</span><br><span class="line">25921812 驴得水</span><br><span class="line">26598021 航海王之黄</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h4 id="配合RxJava"><a href="#配合RxJava" class="headerlink" title="配合RxJava"></a>配合RxJava</h4><p><code>DoubanService.java</code>改为:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">DoubanService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GET</span>(<span class="string">"/v2/movie/in_theaters"</span>)</span><br><span class="line">    <span class="function">Observable&lt;Douban&gt; <span class="title">getList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>DoubanRun</code>改为:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubanRun</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.run();</span><br><span class="line"></span><br><span class="line">        Retrofit retrofit=<span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                .baseUrl(<span class="string">"https://api.douban.com"</span>)</span><br><span class="line">                .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">                .addCallAdapterFactory(RxJavaCallAdapterFactory.create())</span><br><span class="line"></span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        DoubanService doubanService=retrofit.create(DoubanService.class);</span><br><span class="line"></span><br><span class="line">        doubanService.getList()</span><br><span class="line">                .subscribeOn(Schedulers.io())</span><br><span class="line">                .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Subscriber&lt;Douban&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Douban douban)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">for</span> (Subjects l:douban.getSubjects())&#123;</span><br><span class="line">                            Log.i(<span class="string">"TAGGGG"</span>,l.getId()+<span class="string">" "</span>+l.getTitle());</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><ol>
<li>出现<code>Expected BEGIN_ARRAY but was BEGIN_OBJECT at</code>或者pojo类中对应的变量的类型不对. 比如 如果在<code>Subjects</code>类中将rating设为String. 就会有<code>Expected String but was BEGIN_OBJECT at...</code>错误.</li>
</ol>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ol>
<li><a href="https://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">给 Android 开发者的 RxJava 详解</a><br><a href="https://web.archive.org/web/20161023043938/http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">archive.org备份页面</a></li>
<li><a href="https://gank.io/post/56e80c2c677659311bed9841" target="_blank" rel="noopener">RxJava 与 Retrofit 结合的最佳实践</a><br><a href="https://web.archive.org/web/20161022232218/http://gank.io/post/56e80c2c677659311bed9841" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_lib </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Translucent Bar]]></title>
      <url>https://ivyxjc.xyz/2016/11/21/android/UI%E7%9B%B8%E5%85%B3/Bar/2016-11-26-Translucent-Bar/</url>
      <content type="html"><![CDATA[<ol>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/" target="_blank" rel="noopener">Android 实现变色状态栏 </a><br><a href="http://web.archive.org/web/20160421191353/http://blog.csdn.net/sbsujjbcy/article/details/48370371" target="_blank" rel="noopener">archive.org备份页面</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Builder]]></title>
      <url>https://ivyxjc.xyz/2016/11/18/design_pattern/2016-11-18-callback/</url>
      <content type="html"><![CDATA[<p>回调是一种特殊的调用, 调用有三种方式：同步调用, 回调</p>
<p>回调就是在类A中持有一个接口的对象, 但是并不在A类中实现该接口的方法, 而是交给B类去实现, 但是B本身不会调用该方法, 而是供A类去使用.<br><!--nomore--></p>
<h2 id="以Button为例"><a href="#以Button为例" class="headerlink" title="以Button为例"></a>以Button为例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Activity</span> <span class="keyword">implements</span> <span class="title">IListener</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Button mButton;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        mButton=<span class="keyword">new</span> Button();</span><br><span class="line">        mButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        mButton.doClick();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"onClick"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IListener</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    IListener mListener;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnClickListener</span><span class="params">(IListener listener)</span></span>&#123;</span><br><span class="line">        mListener=listener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doClick</span><span class="params">()</span></span>&#123;</span><br><span class="line">        mListener.onClick();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>场景类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client_Button</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"><span class="comment">//        Button button=new Button();</span></span><br><span class="line"><span class="comment">//        button.setOnClickListener(new IListener() &#123;</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void onClick() &#123;</span></span><br><span class="line"><span class="comment">//                StdOut.println("onClick");</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125;);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        button.doClick();</span></span><br><span class="line"></span><br><span class="line">        Activity activity=<span class="keyword">new</span> Activity();</span><br><span class="line">        activity.onCreate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">onClick</span><br></pre></td></tr></table></figure>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Callback</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">(String str)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">implements</span> <span class="title">Callback</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> A a;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">B</span><span class="params">(A a)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.b=b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">askQuestion</span><span class="params">(<span class="keyword">final</span> String question)</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        //加一个线程就是异步回调, 把线程去掉直接doSomething就是同步调用</span></span><br><span class="line"><span class="comment">//        new Thread(new Runnable() &#123;</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void run() &#123;</span></span><br><span class="line">                a.doSomething(A.<span class="keyword">this</span>,question);</span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125;).start();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"the answer is "</span>+str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Callback callback,String question)</span></span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"A gets question: "</span>+question);</span><br><span class="line">        StdOut.println(<span class="string">"A do something"</span>);</span><br><span class="line">        callback.solve(<span class="string">"solved"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client_Java</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        A a=<span class="keyword">new</span> A();</span><br><span class="line">        B b =<span class="keyword">new</span> B(a);</span><br><span class="line">        b.askQuestion(<span class="string">"a's question"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> callback </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[观察者模式]]></title>
      <url>https://ivyxjc.xyz/2016/11/18/design_pattern/2016-11-18-observer/</url>
      <content type="html"><![CDATA[<h3 id="被观察者"><a href="#被观察者" class="headerlink" title="被观察者"></a>被观察者</h3><p>所有被观察者都继承Observable接口 ( java标准库中<code>Observable</code>是一个抽象类)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observable</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addObserver</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteObserver</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObserver</span><span class="params">(String context)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span> <span class="keyword">implements</span> <span class="title">Observable</span>,<span class="title">IHanFeiZi_3</span></span>&#123;</span><br><span class="line">    <span class="comment">//存放observer</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Observer&gt; observerList=<span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addObserver</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observerList.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteObserver</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.observerList.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObserver</span><span class="params">(String context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Observer observer:observerList)&#123;</span><br><span class="line">            observer.update(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="观察者"><a href="#观察者" class="headerlink" title="观察者"></a>观察者</h3><p>所有的观察者都继承Observer接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String str)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BB</span> <span class="keyword">implements</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String context)</span> </span>&#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Observer a1=<span class="keyword">new</span> AA_1();</span><br><span class="line">        Observer a2=<span class="keyword">new</span> AA_2();</span><br><span class="line">        Observer a3=<span class="keyword">new</span> AA_1();</span><br><span class="line">        BB bb=<span class="keyword">new</span> BB();</span><br><span class="line"></span><br><span class="line">        bb.addObserver(a1);</span><br><span class="line">        bb.addObserver(a2);</span><br><span class="line">        bb.addObserver(a3);</span><br><span class="line"></span><br><span class="line">        bb.method1();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="观察者模式的注意事项"><a href="#观察者模式的注意事项" class="headerlink" title="观察者模式的注意事项"></a>观察者模式的注意事项</h2><ol>
<li>需要注意效率问题</li>
<li>由于消息通知是顺序执行的, 如有需要, 可采用异步方式</li>
<li>消息不能无限制的传递下去, 一般而言, 在一个观察者模式中最多出现一个对象既是被观察者又是观察者. 否则程序的维护性会变得很差.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Builder]]></title>
      <url>https://ivyxjc.xyz/2016/11/17/design_pattern/2016-11-17-builder/</url>
      <content type="html"><![CDATA[<h2 id="Builder模式的使用情景"><a href="#Builder模式的使用情景" class="headerlink" title="Builder模式的使用情景"></a>Builder模式的使用情景</h2><ol>
<li>相同的方法, 不同的执行顺序, 产生不同的事件结果</li>
<li>多个部件或零件, 都可以装配到一个对象中, 但是产生的运行结果又不相同</li>
<li>产品类比较复杂, 或者产品类中的调用顺序不同产生了不同的作用.</li>
<li>当初始化一个对象特别复杂, 如参数多, 且很多参数都具有默认值.</li>
</ol>
<h2 id="Builder模式的整体构造"><a href="#Builder模式的整体构造" class="headerlink" title="Builder模式的整体构造"></a>Builder模式的整体构造</h2><p><img src="http://oezmbgg4j.bkt.clouddn.com/builder.jpg" alt=""></p>
<h3 id="产品类"><a href="#产品类" class="headerlink" title="产品类"></a>产品类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String mBoard;</span><br><span class="line">    <span class="keyword">protected</span> String mDisplay;</span><br><span class="line">    <span class="keyword">protected</span> String mOS;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Computer</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBoard</span><span class="params">(String board)</span></span>&#123;</span><br><span class="line">        mBoard=board;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDisplay</span><span class="params">(String display)</span></span>&#123;</span><br><span class="line">        mDisplay=display;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setOS</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Computer [mBoard="</span>+ mBoard+<span class="string">", mDisplay="</span>+mDisplay+<span class="string">", mOS="</span>+mOS+<span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Macbook</span> <span class="keyword">extends</span> <span class="title">Computer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Macbook</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mOS=<span class="string">"Mac OS X 10.10"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Builder类"><a href="#Builder类" class="headerlink" title="Builder类"></a>Builder类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//抽象Builder类</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBoard</span><span class="params">(String board)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildDispaly</span><span class="params">(String display)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildOS</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Computer <span class="title">create</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//具体Builder类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MacbookBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Computer mComputer=<span class="keyword">new</span> Macbook();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBoard</span><span class="params">(String board)</span> </span>&#123;</span><br><span class="line">        mComputer.setBoard(board);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildDispaly</span><span class="params">(String display)</span> </span>&#123;</span><br><span class="line">        mComputer.setDisplay(display);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildOS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mComputer.setOS();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Computer <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mComputer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="导演类"><a href="#导演类" class="headerlink" title="导演类"></a>导演类</h3><p>导演类起到封装的作用, 避免高层模块深入到建造者内部的实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Direcotr</span></span>&#123;</span><br><span class="line">    Builder mBuilder=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Direcotr</span><span class="params">(Builder builder)</span></span>&#123;</span><br><span class="line">        mBuilder=builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">construct</span><span class="params">(String board,String dispaly)</span></span>&#123;</span><br><span class="line">        mBuilder.buildBoard(board);</span><br><span class="line">        mBuilder.buildDispaly(dispaly);</span><br><span class="line">        mBuilder.buildOS();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuildTest</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Builder builder=<span class="keyword">new</span> MacbookBuilder();</span><br><span class="line"></span><br><span class="line">        Direcotr pcDirector=<span class="keyword">new</span> Direcotr(builder);</span><br><span class="line"></span><br><span class="line">        pcDirector.construct(<span class="string">"intel"</span>,<span class="string">"retina"</span>);</span><br><span class="line">        StdOut.println(<span class="string">"Computer Info : "</span>+builder.create().toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="忽略Director类"><a href="#忽略Director类" class="headerlink" title="忽略Director类"></a>忽略Director类</h2><p>在开发过程中, 可以忽略Director类, 直接使用Builder来进行对象的组装, 可以使用setter方法进行链式调用.<br><code>new Builder().setA(&quot;A&quot;).setB(&quot;B&quot;).create()</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuildTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        ConcreteProductA A= (ConcreteProductA)<span class="keyword">new</span> A_Buider().setArg_1(<span class="string">"aa"</span>)</span><br><span class="line">                                        .setArg_2(<span class="string">"bb"</span>).create();</span><br><span class="line">        StdOut.print(A);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">abstractProduct</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String arg_1;</span><br><span class="line">    <span class="keyword">protected</span> String arg_2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setArg_1</span><span class="params">(String arg_1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setArg_2</span><span class="params">(String arg_2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"arg_1: "</span>+arg_1+<span class="string">", arg_2: "</span>+arg_2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteProductA</span> <span class="keyword">extends</span> <span class="title">abstractProduct</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setArg_1</span><span class="params">(String arg_1)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.arg_1=arg_1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setArg_2</span><span class="params">(String arg_2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.arg_2=arg_2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Builder <span class="title">setArg_1</span><span class="params">(String arg_1)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Builder <span class="title">setArg_2</span><span class="params">(String arg_2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> abstractProduct <span class="title">create</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A_Buider</span> <span class="keyword">extends</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ConcreteProductA mConcreteProductA=<span class="keyword">new</span> ConcreteProductA();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Builder <span class="title">setArg_1</span><span class="params">(String arg_1)</span> </span>&#123;</span><br><span class="line">        mConcreteProductA.setArg_1(arg_1);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Builder <span class="title">setArg_2</span><span class="params">(String arg_2)</span> </span>&#123;</span><br><span class="line">        mConcreteProductA.setArg_2(arg_2);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> abstractProduct <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mConcreteProductA;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/linked_builder.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[JobScheduler]]></title>
      <url>https://ivyxjc.xyz/2016/11/15/android/AndroidSamples/background/2016-11-15-jobscheduler/</url>
      <content type="html"><![CDATA[<h2 id="任务写在JobService中"><a href="#任务写在JobService中" class="headerlink" title="任务写在JobService中"></a>任务写在JobService中</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJobService</span> <span class="keyword">extends</span> <span class="title">JobService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">"SyncService"</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line">        Log.i(TAG, <span class="string">"Service created"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        Log.i(TAG, <span class="string">"Service destroyed"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onStartJob</span><span class="params">(JobParameters params)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// fake work</span></span><br><span class="line">        Log.i(TAG, <span class="string">"on start job: "</span> + params.getJobId());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onStopJob</span><span class="params">(JobParameters params)</span> </span>&#123;</span><br><span class="line">        Log.i(TAG, <span class="string">"on stop job: "</span> + params.getJobId());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scheduleJob</span><span class="params">(JobInfo info)</span></span>&#123;</span><br><span class="line">        Log.i(TAG, <span class="string">"schedule job "</span>);</span><br><span class="line">        JobScheduler js=(JobScheduler)getApplication().getSystemService(Context.JOB_SCHEDULER_SERVICE);</span><br><span class="line">        js.schedule(info);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="设置调度的相关条件"><a href="#设置调度的相关条件" class="headerlink" title="设置调度的相关条件"></a>设置调度的相关条件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line">mServiceComponent = <span class="keyword">new</span> ComponentName(<span class="keyword">this</span>, TestJobService.class);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scheduleJob</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        JobInfo info=<span class="keyword">new</span> JobInfo.Builder(sJobId,mServiceComponent)</span><br><span class="line">            <span class="comment">//延迟</span></span><br><span class="line">            .setMinimumLatency(<span class="number">2000</span>)</span><br><span class="line">            <span class="comment">//最长延迟</span></span><br><span class="line">            .setOverrideDeadline(<span class="number">5000</span>)</span><br><span class="line">            <span class="comment">//所需网络类型  本例中 为需要无线网络</span></span><br><span class="line">            .setRequiredNetworkType(JobInfo.NETWORK_TYPE_UNMETERED)</span><br><span class="line">            .setRequiresDeviceIdle(<span class="keyword">true</span>)</span><br><span class="line">            .setRequiresCharging(<span class="keyword">true</span>)</span><br><span class="line">            .build();</span><br><span class="line">        JobSchedulerjobScheduler=(JobScheduler)getApplication().getSystemService(Context.JOB_SCHEDULER_SERVICE);</span><br><span class="line">        jobScheduler.schedule(info);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="如何获取正在运行的所有程序的名称"><a href="#如何获取正在运行的所有程序的名称" class="headerlink" title="如何获取正在运行的所有程序的名称"></a>如何获取正在运行的所有程序的名称</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getRunningProcessNames</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ActivityManager am = (ActivityManager)<span class="keyword">this</span>.getSystemService(ACTIVITY_SERVICE);</span><br><span class="line"></span><br><span class="line">        List&lt;ActivityManager.RunningAppProcessInfo&gt; l = am.getRunningAppProcesses();</span><br><span class="line">        PackageManager pm = <span class="keyword">this</span>.getPackageManager();</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(ActivityManager.RunningAppProcessInfo i:l)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                CharSequence c = pm.getApplicationLabel(pm.getApplicationInfo(i.processName, PackageManager.GET_META_DATA));</span><br><span class="line">                sb.append(c.toString()+<span class="string">'\n'</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="相关博客"><a href="#相关博客" class="headerlink" title="相关博客"></a>相关博客</h2><p><a href="http://blog.csdn.net/bboyfeiyu/article/details/44809395" target="_blank" rel="noopener">在Android 5.0中使用JobScheduler</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python socket编程功能]]></title>
      <url>https://ivyxjc.xyz/2016/10/30/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-10-30-socket-basic/</url>
      <content type="html"><![CDATA[<h2 id="socket编程基本思路"><a href="#socket编程基本思路" class="headerlink" title="socket编程基本思路"></a>socket编程基本思路</h2><h3 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h3><ol>
<li>创建socket, 绑定socket到本地IP, 端口 socket.socket(socket.AF_INET,socket.SOCK_STREAM), s.bind()</li>
<li>开始监听连接  s.listen()</li>
<li>进入循环，不断接受客户端的连接请求  s.accept()</li>
<li>然后接收传来的数据，并发送给对方数据  s.recv() , s.sendall()</li>
<li>传输完毕后，关闭socket  </li>
</ol>
<h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><ol>
<li>创建套接字，连接远端地址 #socket.socket(socket.AF_INET,socket.SOCK_STREAM), s.connect()</li>
<li>连接后发送数据和接收数据 #s.sendall(), s.recv()</li>
<li>传输完毕后，关闭套接字 #s.close()</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入socket库:</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="comment"># 创建一个socket:</span></span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 建立连接:</span></span><br><span class="line">s.connect((<span class="string">'www.sina.com.cn'</span>, <span class="number">80</span>))</span><br></pre></td></tr></table></figure>
<p>创建socket时, <code>socket.AF_INET</code>代表使用用IPv4协议, 如果要使用IPv6协议, 则指定<code>sockt.AF_INET6</code>, <code>SOCK_STREAM</code>指定使用面向流的TCP协议.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">s.send(<span class="string">b'GET / HTTP/1.1\r\nHost: www.sina.com.cn\r\nConnection: close\r\n\r\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收数据:</span></span><br><span class="line">buffer = []</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="comment"># 每次最多接收1k字节:</span></span><br><span class="line">    d = s.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">if</span> d:</span><br><span class="line">        buffer.append(d)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">data = <span class="string">b''</span>.join(buffer)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭连接:</span></span><br><span class="line">s.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理数据</span></span><br><span class="line">header, html = response.split(<span class="string">b'\r\n\r\n'</span>, <span class="number">1</span>)</span><br><span class="line">print(header.decode(<span class="string">"utf-8"</span>))</span><br><span class="line">print(html.decode(<span class="string">'utf-8'</span>))</span><br></pre></td></tr></table></figure>
<h2 id="socket-并发"><a href="#socket-并发" class="headerlink" title="socket 并发"></a>socket 并发</h2><p>socket默认是堵塞的, 当socket运行<code>connect()</code>,<code>recv()</code>方法时, 会堵塞直到运行完成.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sock = socket.socket()</span><br><span class="line"><span class="comment">#将socket设为非堵塞的self.</span></span><br><span class="line">sock.setblocking(<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<p>这样做会直接抛出一个<code>BlockingIOError</code>的异常, 详细内容<code>A non-blocking socket operation could not be completed immediately</code>,</p>
<p><strong>解决方法</strong>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    sock.connect((<span class="string">'xkcd.com'</span>, <span class="number">80</span>))</span><br><span class="line"><span class="keyword">except</span> BlockingIOError:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request = <span class="string">'GET &#123;&#125; HTTP/1.0\r\nHost: xkcd.com\r\n\r\n'</span>.format(url)</span><br><span class="line">encoded=request.encode(<span class="string">'ascii'</span>)</span><br><span class="line">sock.send(encoded)</span><br></pre></td></tr></table></figure>
<p>也会抛出异常<code>OSError: A request to send or receive data was disallowed because the socket is not connected and (when sending on a datagram socket using a sendto call) no address was supplied</code></p>
<p><strong>解决方法</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sock.send(encoded)</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># Done.</span></span><br><span class="line">    <span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> socket </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[爬取豆瓣]]></title>
      <url>https://ivyxjc.xyz/2016/10/30/python/Spider/douban/2016-10-30-douban-spider/</url>
      <content type="html"><![CDATA[<p>断断续续谢了一个多星期, 基本上完成了豆瓣的爬虫的编写.</p>
<p>最初还是没有准备使用框架写, 还是准备利用<code>requests</code>获取网页内容然后分析, 后来觉得这么写有点浪费时间, 而且<code>requests</code>是阻塞的, 不便于写多线程的. 另一方面, python爬虫框架Scrapy大名鼎鼎, 不学习一下有点亏, 就决定使用Scrapy来写这个爬虫.</p>
<h2 id="Scrapy"><a href="#Scrapy" class="headerlink" title="Scrapy"></a>Scrapy</h2><p>利用Scrapy来写爬虫还是比较方便简单的, 主要的代码都在<code>douban_spider</code>中, 后续处理的代码在<code>pipeline</code>中, <code>setting</code>中还可以设置爬取速率, 是否遵循robot.txt, middleware等内容.</p>
<h2 id="获取的豆瓣信息"><a href="#获取的豆瓣信息" class="headerlink" title="获取的豆瓣信息"></a>获取的豆瓣信息</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">'casts'</span>: &#123;<span class="string">'1004780'</span>: <span class="string">'雷诺·维尔森'</span>,</span><br><span class="line">           <span class="string">'1017898'</span>: <span class="string">'约翰·古德曼'</span>,</span><br><span class="line">           <span class="string">'1018140'</span>: <span class="string">'马克·瑞安'</span>,</span><br><span class="line">           <span class="string">'1025212'</span>: <span class="string">'彼特·库伦'</span>,</span><br><span class="line">           <span class="string">'1025213'</span>: <span class="string">'托马斯·列农'</span>,</span><br><span class="line">           <span class="string">'1027181'</span>: <span class="string">'渡边谦'</span>,</span><br><span class="line">           <span class="string">'1031825'</span>: <span class="string">'弗兰克·维尔克'</span>,</span><br><span class="line">           <span class="string">'1031847'</span>: <span class="string">'凯尔希·格兰莫'</span>,</span><br><span class="line">           <span class="string">'1031869'</span>: <span class="string">'索非亚·迈尔斯'</span>,</span><br><span class="line">           <span class="string">'1035674'</span>: <span class="string">'马克·沃尔伯格'</span>,</span><br><span class="line">           <span class="string">'1037706'</span>: <span class="string">'吕良伟'</span>,</span><br><span class="line">           <span class="string">'1040517'</span>: <span class="string">'斯坦利·图齐'</span>,</span><br><span class="line">           <span class="string">'1040990'</span>: <span class="string">'李冰冰'</span>,</span><br><span class="line">           <span class="string">'1041214'</span>: <span class="string">'罗伯特·福克沃斯'</span>,</span><br><span class="line">           <span class="string">'1049627'</span>: <span class="string">'约翰·迪·玛吉欧'</span>,</span><br><span class="line">           <span class="string">'1162139'</span>: <span class="string">'王敏德 '</span>,</span><br><span class="line">           <span class="string">'1165630'</span>: <span class="string">'提图斯·维里沃'</span>,</span><br><span class="line">           <span class="string">'1248294'</span>: <span class="string">'T·J·米勒'</span>,</span><br><span class="line">           <span class="string">'1274253'</span>: <span class="string">'妮可拉·佩尔茨'</span>,</span><br><span class="line">           <span class="string">'1275106'</span>: <span class="string">'纪培慧'</span>,</span><br><span class="line">           <span class="string">'1275667'</span>: <span class="string">'韩庚'</span>,</span><br><span class="line">           <span class="string">'1312271'</span>: <span class="string">'巫刚'</span>,</span><br><span class="line">           <span class="string">'1326135'</span>: <span class="string">'杰克·莱诺'</span>,</span><br><span class="line">           <span class="string">'1340189'</span>: <span class="string">'阿比盖尔·克莱恩'</span>,</span><br><span class="line">           <span class="string">'1340928'</span>: <span class="string">'邹市明'</span>&#125;,</span><br><span class="line"> <span class="string">'directors'</span>: &#123;<span class="string">'1027776'</span>: <span class="string">'迈克尔·贝'</span>&#125;,</span><br><span class="line"> <span class="string">'writers'</span>: &#123;<span class="string">'1027468'</span>: <span class="string">'伊伦·克鲁格'</span>&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">#----------</span></span><br><span class="line"> <span class="string">'rating_better_than'</span>: &#123;<span class="string">'动作片'</span>: <span class="string">'46'</span>, <span class="string">'科幻片'</span>: <span class="string">'44'</span>&#125;,</span><br><span class="line"> <span class="string">'release_date'</span>: &#123;<span class="string">'美国/中国大陆'</span>: <span class="string">'2014-06-27'</span>, <span class="string">'香港首映'</span>: <span class="string">'2014-06-19'</span>&#125;,</span><br><span class="line"> <span class="comment">#----------</span></span><br><span class="line"></span><br><span class="line"> <span class="string">'movie_aka'</span>: [<span class="string">'变形金刚：歼灭世纪(港)'</span>, <span class="string">'变形金刚4：灭绝时代'</span>, <span class="string">'变形金刚4'</span>, <span class="string">'变4'</span>, <span class="string">'Transformers4'</span>],</span><br><span class="line">  <span class="string">'movie_tags'</span>: [<span class="string">'变形金刚'</span>, <span class="string">'科幻'</span>, <span class="string">'美国'</span>, <span class="string">'动作'</span>, <span class="string">'2014'</span>, <span class="string">'美国电影'</span>, <span class="string">'Transformers'</span>, <span class="string">'电影'</span>],</span><br><span class="line"> <span class="string">'movie_country'</span>: [<span class="string">'美国'</span>, <span class="string">'中国大陆'</span>],</span><br><span class="line"> <span class="string">'movie_genre'</span>: [<span class="string">'动作'</span>, <span class="string">'科幻'</span>],</span><br><span class="line">  <span class="string">'movie_language'</span>: [ <span class="string">'英语'</span>,<span class="string">'汉语普通话'</span>, <span class="string">'粤语'</span>],</span><br><span class="line">  <span class="string">'movie_similar'</span>: [<span class="string">'3610047'</span>,</span><br><span class="line">                    <span class="string">'6082518'</span>,</span><br><span class="line">                    <span class="string">'10741834'</span>,</span><br><span class="line">                    <span class="string">'2063914'</span>,</span><br><span class="line">                    <span class="string">'3718424'</span>,</span><br><span class="line">                    <span class="string">'3231742'</span>,</span><br><span class="line">                    <span class="string">'6390823'</span>,</span><br><span class="line">                    <span class="string">'24404677'</span>,</span><br><span class="line">                    <span class="string">'6560058'</span>,</span><br><span class="line">                    <span class="string">'3217149'</span>],</span><br><span class="line"> <span class="comment">#----------          </span></span><br><span class="line"></span><br><span class="line"> <span class="string">'movie_id'</span>: <span class="string">'7054604'</span>,</span><br><span class="line"> <span class="string">'movie_imdb_id'</span>: <span class="string">'tt2109248'</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">'movie_length'</span>: <span class="string">'166'</span>,</span><br><span class="line"> <span class="string">'movie_name'</span>: <span class="string">'变形金刚4：绝迹重生 Transformers: Age of Extinction'</span>,</span><br><span class="line"> <span class="string">'movie_rating'</span>: <span class="string">'6.6'</span>,</span><br><span class="line"> <span class="string">'movie_rating_distribute'</span>: [<span class="string">'11.0'</span>, <span class="string">'28.4'</span>, <span class="string">'43.5'</span>, <span class="string">'13.1'</span>, <span class="string">'4.1'</span>],</span><br><span class="line"> <span class="string">'movie_rating_people_num'</span>: <span class="string">'178399'</span>,</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>以变形金刚四为例, 数据根据格式主要分成四类:</p>
<ol>
<li>导演, 编剧, 演员</li>
<li>数据格式为map的数据</li>
<li>数据格式为list的数据</li>
<li>数据格式为str的数据</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> xml </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python 生成器函数]]></title>
      <url>https://ivyxjc.xyz/2016/10/30/python/2016-10-30-generator/</url>
      <content type="html"><![CDATA[<h2 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h2><p>生成器函数是一个迭代器, 不过只能遍历其一次, 这是因为生成器并不将数据存储在内存之中, 生成完数据后并不保存下来.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">list=(i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"---"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createGenerator</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">yield</span> i*i</span><br><span class="line"></span><br><span class="line">gen=createGenerator()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> gen:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"---"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> gen:</span><br><span class="line">    print(i)</span><br><span class="line">out:</span><br><span class="line"></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>另外, 生成器函数并不是再调用的时候就运行的, 而是在遍历的时候才运行, 在上述代码中, 意味着生成器函数是在执行<code>for i in gen:</code>时才运行的.</p>
<p>解释器是如何知道其是生成器函数的呢? 当解释器发现<code>yield</code>时, 就知道该函数是个生成器函数, 它会设置一个标识来标记这一情况, 调用type也可以发现这一情况.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成器标志位在第5位</span></span><br><span class="line">generator_bit=<span class="number">1</span>&lt;&lt;<span class="number">5</span></span><br><span class="line">b=bool(createGenerator.__code__.co_flags &amp; generator_bit)</span><br><span class="line">print(b)</span><br><span class="line">print(type(createGenerator))</span><br><span class="line"></span><br><span class="line">out:</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">generator</span>'&gt;</span></span><br></pre></td></tr></table></figure>
<p>参考文章:</p>
<p><a href="http://aosabook.org/en/500L/a-web-crawler-with-asyncio-coroutines.html" target="_blank" rel="noopener">A Web Crawler With asyncio Coroutines</a></p>
<p><a href="http://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do" target="_blank" rel="noopener">What does the yield keyword do</a></p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> generators </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Raspberry安装]]></title>
      <url>https://ivyxjc.xyz/2016/10/30/python/raspberry/2016-10-30-raspberry-basic/</url>
      <content type="html"><![CDATA[<h2 id="更改源"><a href="#更改源" class="headerlink" title="更改源"></a>更改源</h2><p>需要更改的地方有两个:</p>
<ol>
<li><code>/etc/apt/source.list</code></li>
<li><code>/etc/apt/source.list.d/raspi.list</code></li>
</ol>
<p>将其中的网址换掉即可.</p>
<h2 id="如何连接局域网中的小米硬盘"><a href="#如何连接局域网中的小米硬盘" class="headerlink" title="如何连接局域网中的小米硬盘"></a>如何连接局域网中的小米硬盘</h2><p>命令行的方式都试了一下, 没找到有效的.</p>
<p>用的方法是远程桌面连接Raspberry, <code>GO-&gt;Network-&gt;</code>找到硬盘, 然后移动到pi文件下面.</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> generators </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[不同容器类是否线程安全]]></title>
      <url>https://ivyxjc.xyz/2016/10/26/java/concurrency/2016-10-26-collections-thread-safety/</url>
      <content type="html"><![CDATA[<table>
<thead>
<tr>
<th>非线程安全</th>
<th>线程安全</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ArrayList</code><br> <code>LinkedList</code></td>
<td><code>Vector</code></td>
</tr>
<tr>
<td><code>HashMap</code></td>
<td><code>HashTable</code></td>
</tr>
<tr>
<td><code>StringBuilder</code></td>
<td><code>StringBuffer</code></td>
</tr>
</tbody>
</table>
<a id="more"></a>
<h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><p>容器类线程安全, 非线程安全的区别可以用下面这个例子来表述:</p>
<p>以<code>ArrayList</code>和<code>Vector</code>为例, 同时建立100个线程, 每个线程都向容器中添加100个元素,<br>最后统计容器内元素的数量, 对于<code>ArrayList</code>来说, 最后的量并不一定是10000个, 甚至会出现<code>IndexOutofBoundsException</code>, 但是对于<code>Vector</code>来说, 最后的量一定是10000个, 且不会出现任何异常. 这便是线程安全与非线程安全的一个直观表现.</p>
<h3 id="非线程安全-多线程下不可使用"><a href="#非线程安全-多线程下不可使用" class="headerlink" title="非线程安全 != 多线程下不可使用"></a>非线程安全 != 多线程下不可使用</h3><p>非线程安全并不意味这不可以在多线程环境下不可使用, 上述问题出现在多个线程操作同一个<code>ArrayList</code>对象, 如果一个<code>ArrayList</code>只在一个线程下进行操作, 还是可以使用<code>ArrayList</code>的.</p>
<h3 id="如何使非线程安全容器类变得线程安全"><a href="#如何使非线程安全容器类变得线程安全" class="headerlink" title="如何使非线程安全容器类变得线程安全"></a>如何使非线程安全容器类变得线程安全</h3><p>使用<code>List&lt;Object&gt; list = Collections.synchronizedList(new ArrayList&lt;Object&gt;());</code>可以使<code>list</code>变得线程安全.</p>
<h2 id="造成非线程安全的原因"><a href="#造成非线程安全的原因" class="headerlink" title="造成非线程安全的原因"></a>造成非线程安全的原因</h2><p>一般来说, 造成非线程安全主要有两个原因:</p>
<ol>
<li>一个操作不是原子性操作</li>
<li>执行过程中可能被中断</li>
</ol>
<p>查看<code>ArrayList</code>关于<code>add(E e)</code>的相关源码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">        minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ensureExplicitCapacity(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length &gt; <span class="number">0</span>)</span><br><span class="line">        grow(minCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="list中含有null的原因"><a href="#list中含有null的原因" class="headerlink" title="list中含有null的原因"></a>list中含有null的原因</h3><p>即使不发生<code>IndexOutofBoundsException</code>异常, 最后的元素总数也不全都是100000个.<br>问题出现在<code>add(E e)</code>中的<code>elementData[size++] = e;</code>, 这句代码大致会分成以下两步:</p>
<ol>
<li><code>elementData[size] = e;</code></li>
<li><code>size++`</code></li>
</ol>
<p>如果线程A执行完第1步中断, 线程B开执行add, 执行到第1步时候因为<code>size</code>还未+1, 所以线程B仍会将e赋值给<code>elementData[size]</code>, 之后线程B执行+1操作, 线程A也执行+1操作, 也就意味着,并没有对 <code>elementData[size+1]</code>进行赋值, 其值也就为null.</p>
<h3 id="元素总量不符合预期的原因"><a href="#元素总量不符合预期的原因" class="headerlink" title="元素总量不符合预期的原因"></a>元素总量不符合预期的原因</h3><p>根本原因在于自加操作不是原子性的</p>
<p>线程B可能在线程A执行<code>size++</code>中间就开始同时执行<code>size++</code>, 这可能会使得线程A,B执行之初时size值相同, 导致元素总量小于预期.</p>
<h3 id="IndexOutofBoundsException产生原因"><a href="#IndexOutofBoundsException产生原因" class="headerlink" title="IndexOutofBoundsException产生原因"></a>IndexOutofBoundsException产生原因</h3><p>ArrayList实际上也是一个数组, 只不过可以自动扩容, 出现<code>IndexOutofBoundsException</code>说明在某些情况下, 还未扩容, 就添加元素进去了.</p>
<p>例如,线程A开始执行<code>add()</code>, 执行到<code>ensureExplicitCapacity(int minCapacity)</code>中的条件语句时, 如果此时添加的元素总数==数组的长度-1, 那么并不会执行扩容操作. 但是如果此时, 线程A中断, 线程B开始执行, 此时由于线程A还未添加元素, 元素总数仍==数组的长度-1, 添加元素, 此时若线程A恢复, 开始执行添加元素, 由于此时元素总数==数组的长度, 再向其中添加元素就会抛出<code>IndexOutofBoundsException</code>异常.</p>
<h3 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h3><p><code>Vector</code>中关于<code>add(E e)</code>的相关源码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    ensureCapacityHelper(elementCount + <span class="number">1</span>);</span><br><span class="line">    elementData[elementCount++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Java </tag>
            
            <tag> concurrency </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[工厂方法模式]]></title>
      <url>https://ivyxjc.xyz/2016/10/25/design_pattern/2016-10-25-factory-pattern/</url>
      <content type="html"><![CDATA[<h2 id="工厂方法的通用源码"><a href="#工厂方法的通用源码" class="headerlink" title="工厂方法的通用源码"></a>工厂方法的通用源码</h2><h3 id="抽象产品类"><a href="#抽象产品类" class="headerlink" title="抽象产品类"></a>抽象产品类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="具体产品类"><a href="#具体产品类" class="headerlink" title="具体产品类"></a>具体产品类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct1</span> <span class="keyword">extends</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct2</span> <span class="keyword">extends</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="抽象工厂类"><a href="#抽象工厂类" class="headerlink" title="抽象工厂类"></a>抽象工厂类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Creator</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> &lt;T extends Product&gt; <span class="function">T <span class="title">createProduct</span><span class="params">(Class&lt;T&gt; c)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="具体工厂类"><a href="#具体工厂类" class="headerlink" title="具体工厂类"></a>具体工厂类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCreator</span> <span class="keyword">extends</span> <span class="title">Creator</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> &lt;T extends Product&gt; <span class="function">T <span class="title">createProduct</span><span class="params">(Class&lt;T&gt; c)</span></span>&#123;</span><br><span class="line">    Product product=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      product=(Product)Class.forName(c.getName()).newInstance();</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">      ....</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (T)product;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="简单工厂模式"><a href="#简单工厂模式" class="headerlink" title="简单工厂模式"></a>简单工厂模式</h2><p>简单工厂模式去掉了抽象工厂类, 并且<code>createProduct()</code>方法添加了<code>static</code>. 该模式调用过程更为简单, 方便理解. 但是扩展较为困难, 不符合开闭原则.</p>
<h2 id="多工厂模式"><a href="#多工厂模式" class="headerlink" title="多工厂模式"></a>多工厂模式</h2><h2 id="利用工厂模式生成单例"><a href="#利用工厂模式生成单例" class="headerlink" title="利用工厂模式生成单例"></a>利用工厂模式生成单例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FactorySingle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton sSingleton;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Class cl=Class.forName(Singleton.class.getName());</span><br><span class="line">            Constructor constructor=cl.getDeclaredConstructor();</span><br><span class="line">            constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            sSingleton=(Singleton)constructor.newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getSingleton</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sSingleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="抽象工厂模式"><a href="#抽象工厂模式" class="headerlink" title="抽象工厂模式"></a>抽象工厂模式</h2><p>为创建一组相关或者是相互依赖的对象提供一个接口, 而不需要制定它们的具体类.</p>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[单例模式]]></title>
      <url>https://ivyxjc.xyz/2016/10/25/design_pattern/2016-10-25-singleton/</url>
      <content type="html"><![CDATA[<p>Ensure a class has only one instance, and provide a global point of access to it.</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="最基本的实例"><a href="#最基本的实例" class="headerlink" title="最基本的实例"></a>最基本的实例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emperor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Emperor emperor=<span class="keyword">new</span> Emperor();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Emperor</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Emperor <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> emperor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Java Language Specification 中规定了一个类只会被初始化一次.所以该方法是<strong>线程安全</strong>的, 但是其在方法调用前就初始化了, 比较浪费资源.</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ol>
<li>只有一个实例, 节约内存空间, 减少了系统的性能开销, 如果某一个对象的产生需要比较多的资源时, 可以在启动时直接产生一个单例对象, 使其永驻内存.</li>
<li>可以避免对资源的多重占用,</li>
<li>可以在系统设置全局的访问点, 优化和共享资源访问.</li>
</ol>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ol>
<li>单例模式一般没有接口, 扩展很困难, 除了修改代码基本上没有第二种途径可以实现</li>
<li>单例模式不利于测试, 如果单例模式没有完成, 无法进行测试</li>
<li>于单一职责原则相冲突.</li>
</ol>
<h2 id="其它实现方式"><a href="#其它实现方式" class="headerlink" title="其它实现方式"></a>其它实现方式</h2><h3 id="懒汉模式"><a href="#懒汉模式" class="headerlink" title="懒汉模式"></a>懒汉模式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance==<span class="keyword">null</span>)&#123;</span><br><span class="line">            instance=<span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该实现只会在需要的时候才会进行初始化且是线程安全的, 但是每次调用<code>getInstance()</code>都会进行同步, 会浪费资源</p>
<h3 id="Double-Check-Lock"><a href="#Double-Check-Lock" class="headerlink" title="Double Check Lock"></a>Double Check Lock</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingletonDCL</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonDCL sInstance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonDCL</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonDCL <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(sInstance==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (SingletonDCL.class)&#123;</span><br><span class="line">                <span class="keyword">if</span>(sInstance==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    sInstance=<span class="keyword">new</span> SingletonDCL();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该实现只会在需要的时候才会进行初始化, 看似线程安全, 但实际并不是.</p>
<p>假设线程A执行到<code>sInstance=new SingletonDCL()</code>, 这句代码并不是一个原子操作, 这句代码大致会被分为下面3个步骤来处理:</p>
<ol>
<li>给SingletonDCL的实例分配内存</li>
<li>调用SingletonDCL的构造函数, 初始化成员字段</li>
<li>将sInstance对象指向分配的内存空间 (此时sInstance就不是null了).</li>
</ol>
<p>如果这句代码严格按照这个顺序执行,该DCL单例模式便是线程安全的, 但是事实并非如此. 原因是JVM并没有保证上述第2和第3步的执行顺序.<br>也就是说执行步骤可能是1-3-2, 这种执行步骤就会出问题:</p>
<p>当先执行第3步时, 另一个线程B开始执行<code>getInstance()</code>, 由于此时<code>sInstance</code>已经不是<code>null</code>了, 所以线程B会返回一个还未初始化的<code>sInstance</code>, 出现了错误.</p>
<p>JVM1.5之后改善了这个问题, 在<code>sInstance</code>前加上<code>volatile</code>关键字可以确保线程安全.<br>即<code>private static volatile SingletonDCL sInstance;</code></p>
<h3 id="静态内部类单例模式"><a href="#静态内部类单例模式" class="headerlink" title="静态内部类单例模式"></a>静态内部类单例模式</h3><p>DCL单例模式并不推荐使用,《Java并发编程实践》推荐使用下面这个方法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingletonStatic</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonStatic</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonStatic <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonStaticHolder.sInstance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonStaticHolder</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SingletonStatic sInstance=<span class="keyword">new</span> SingletonStatic();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一次加载时, 并不会初始化<code>sInstance</code>, 只在第一调用<code>getInstance()</code>时初始化, 且该方法是安全的.</p>
<h3 id="枚举单例"><a href="#枚举单例" class="headerlink" title="枚举单例"></a>枚举单例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> SingletonEnum&#123;</span><br><span class="line">    INSTACNE;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"doSomething..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>枚举单例模式有以下3个优点:</p>
<ol>
<li>线程安全, 任何时候都只有一个实例</li>
<li>反序列化时, 都只会有一个实例</li>
<li>可以防止反射攻击</li>
</ol>
<h2 id="选择哪一种实现方式"><a href="#选择哪一种实现方式" class="headerlink" title="选择哪一种实现方式"></a>选择哪一种实现方式</h2><p>无论采用哪一种实现方式, 都要确保线程安全, 防止反序列化导致重新生成实例对象等一些问题. 具体选择哪一种实现方式取决于项目本身.</p>
<h2 id="关于序列化"><a href="#关于序列化" class="headerlink" title="关于序列化"></a>关于序列化</h2><p>除了枚举单例, 为了避免单例对象在被反序列化时重新生成对象, 必须加入以下方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sInstance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="单例模式扩展"><a href="#单例模式扩展" class="headerlink" title="单例模式扩展"></a>单例模式扩展</h2><p>如果生成对象的数量不受限制, 可以直接使用<code>new</code>. 如果只要有一个对象, 使用单例模式即可, 若需要且只需要两个或者三个对象, 则可以按照下面的方法:</p>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mysql基本命令]]></title>
      <url>https://ivyxjc.xyz/2016/10/24/database/2016-11-06-mysql_basic/</url>
      <content type="html"><![CDATA[<p><code>select count(column_name) from table_name;</code> 计数</p>
<p><code>UPDATE movie_name SET flag=&#39;1&#39; WHERE movie_id=214143</code> 更新<br><code></code></p>
]]></content>
      
        <categories>
            
            <category> database </category>
            
        </categories>
        
        
        <tags>
            
            <tag> database </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[面向对象六大原则(下)]]></title>
      <url>https://ivyxjc.xyz/2016/10/24/design_pattern/2016-10-24-basic-principle_2/</url>
      <content type="html"><![CDATA[<h2 id="接口隔离原则"><a href="#接口隔离原则" class="headerlink" title="接口隔离原则"></a>接口隔离原则</h2><p>Interface Segregation Principles(ISP)</p>
<ol>
<li>客户端不应该依赖它不需要的接口</li>
<li>类似的依赖关系应该建立在最小的接口上</li>
</ol>
<p>接口应该细化, 不要使用过于臃肿的接口. 客户端需要什么接口就提供什么接口, 将不需要的接口剔除掉.<br>不要将太多的方法放在同一个接口之中.</p>
<p>但是接口设计也要有度, 不可过度设计, 这个度往往根据经验和常识判断.</p>
<h2 id="迪米特法则"><a href="#迪米特法则" class="headerlink" title="迪米特法则"></a>迪米特法则</h2><p>Law of Demeter(LOD) , 最少知识原则(Least Knowledge Principle))</p>
<p>一个对象应该对其它对象有最少的了解, 另一个解释是只与直接的朋友通信.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">朋友类: 出现在成员变量, 方法的输入输出参数中的类称为成员朋友类, 而出现在方法体内部的类不属于朋友类</span><br></pre></td></tr></table></figure>
<h2 id="开闭原则"><a href="#开闭原则" class="headerlink" title="开闭原则"></a>开闭原则</h2><p>Open Close Principle(OCP)</p>
<p>一个软件实体如类, 模块和函数等应该对扩展开放, 对修改关闭.</p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IBook</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NovelBook</span> <span class="keyword">implements</span> <span class="title">IBook</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NovelBook</span><span class="params">(String name, <span class="keyword">int</span> price, String author)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.price=price;</span><br><span class="line">        <span class="keyword">this</span>.author=author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAuthor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> author;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果将来要搞打折, 一般可能会用以下两个方法来解决:</p>
<ol>
<li>在接口中添加<code>getOffPrice()</code>方法. 但是这需要对每一个实现<code>IBook</code>接口的实现类都添加该方法, 工作繁琐. 且接口应该是稳定且可靠的, 不应该经常发生变化.</li>
<li>修改实现类, 直接在<code>getPrice()</code>中实现打折处理, 但是如果仍需要知道原价是多少, 就会出问题.</li>
<li>通过扩展实现</li>
</ol>
<p>添加一个子类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OffNovelBook</span> <span class="keyword">extends</span> <span class="title">NovelBook</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OffNovelBook</span><span class="params">(String name,<span class="keyword">int</span> price, String author)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name,price,author);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> selfPrice=<span class="keyword">super</span>.getPrice();</span><br><span class="line">        <span class="keyword">int</span> offPrice=selfPrice*<span class="number">90</span>/<span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> offPrice;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/ocp_.jpg" alt=""></p>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[面向对象六大原则(上)]]></title>
      <url>https://ivyxjc.xyz/2016/10/24/design_pattern/2016-10-24-basic-principle_1/</url>
      <content type="html"><![CDATA[<h2 id="单一职责原则"><a href="#单一职责原则" class="headerlink" title="单一职责原则"></a>单一职责原则</h2><p>单一职责原则(Single Responsibility Principle,SRP)简而言之就是对于一个类或者接口, 引起其改变的应该只能有一个原因. 比如要将负责属性和行为的类分开.</p>
<h2 id="里氏替换原则"><a href="#里氏替换原则" class="headerlink" title="里氏替换原则"></a>里氏替换原则</h2><p>定义：所有引用基类的地方必须能透明地使用其子类的对象. 只要父类出现的地方, 子类就可以出现, 而且替换为子类不会产生任何错误或者一场. 但是反过来不一定可行.</p>
<ol>
<li>子类中可以增加自己特有的方法。</li>
<li>当子类的方法重载父类的方法时，方法的前置条件（即方法的形参）要比父类方法的输入参数更宽松。</li>
<li>当子类的方法实现父类的抽象方法时，方法的后置条件（即方法的返回值）要比父类更严格。</li>
</ol>
<h3 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h3><p>当子类的方法<strong>重载</strong>父类的方法时，方法的前置条件（即方法的形参）要比父类方法的输入参数更宽松。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(HashMap map)</span></span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"父类被执行..."</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(Map map)</span> </span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"子类被执行"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>子类方法和父类方法, 方法名相同, 返回类型相同, 但是参数不同, 所以不是Override, 而是Overload. 在这种情况下, 如果传入<code>HashMap</code>, 子类的<code>doSomething()</code>不会被执行.<br>这是<strong>正确</strong>的, 因为子类并没有重写父类方法, 而是重载父类方法, 所以如果父类的前置条件(形参) 范围宽于子类则不正确.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    Father f=<span class="keyword">new</span> Father();</span><br><span class="line">    HashMap map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">父类被执行</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="comment">//父类出现的地方都可以被子类代替, 且不会改变逻辑</span></span><br><span class="line">    Son f=<span class="keyword">new</span> Son();</span><br><span class="line">    HashMap map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">父类被执行</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">   <span class="comment">//子类出现的地方, 父类不一定可以代替</span></span><br><span class="line">    Son f=<span class="keyword">new</span> Son();</span><br><span class="line">    Map map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">子类被执行</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(Map map)</span></span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"父类被执行..."</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(HashMap map)</span> </span>&#123;</span><br><span class="line">        StdOut.println(<span class="string">"子类被执行"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    Father f=<span class="keyword">new</span> Father();</span><br><span class="line">    HashMap map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">父类被执行</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="comment">//父类出现的地方都可以用子类代替</span></span><br><span class="line">    Son f=<span class="keyword">new</span> Son();</span><br><span class="line">    HashMap map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">子类被执行</span><br></pre></td></tr></table></figure>
<p>可以注意到, 此时子类方法被执行了, 而子类并没有重写父类的相应的方法, 而是重载了父类的方法.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    Son f=<span class="keyword">new</span> Son();</span><br><span class="line">    Map map=<span class="keyword">new</span> HashMap();</span><br><span class="line">    f.doSomething(map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">父类被执行</span><br></pre></td></tr></table></figure>
<h3 id="后置条件"><a href="#后置条件" class="headerlink" title="后置条件"></a>后置条件</h3><p>当子类的方法实现或覆写父类的抽象方法时，方法的后置条件（即方法的返回值）要比父类更严格或相同。</p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><ol>
<li>在类中调用其他类时务必使用其父类或者接口, 如果不能使用父类或者接口, 则说明类的设计已经违背了LSP原则.</li>
<li>如果子类不能完整地实现父类的方法, 或者父类的一些方法在子类中完全和父类业务逻辑不同, 则建议不使用继承关系, 而是用依赖, 聚集, 组合等关系代替.</li>
</ol>
<h2 id="依赖倒置原则"><a href="#依赖倒置原则" class="headerlink" title="依赖倒置原则"></a>依赖倒置原则</h2><p>Dependence Inversion Principle</p>
<ol>
<li>高层模块不应该依赖低层模块</li>
<li>抽象不应该依赖细节</li>
<li>细节应依赖抽象</li>
</ol>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>高层模块</td>
<td>原子逻辑再组装就是高层模块</td>
</tr>
<tr>
<td>低层模块</td>
<td>每一个逻辑的实现都由院子逻辑组成,不分割的原子逻辑就是低层模块</td>
</tr>
</tbody>
</table>
<p>对于Java来说.</p>
<ol>
<li>模块间的依赖通过抽象产生,实现类之间不发生直接依赖关系, 其依赖关系是通过接口或者抽象类产生的</li>
<li>接口或这抽象类不依赖于实现类</li>
<li>实现类依赖接口或抽象类</li>
</ol>
<p>这样也有利于并行开发, 即使只完成了一部分工作, 仍可以进行单元测试.</p>
<p>这也符合现代开发的流程, 先写好单元测试类, 再写实现类.</p>
<h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><ol>
<li>每个类尽量都有接口或抽象类, 或者抽象类和接口都具备</li>
<li>变量的表面类型尽量是接口或者是抽象类(如果使用类的clone方法, 就必须使用实现类)</li>
<li>任何类都不应该从具体类中派生(如果实在需要继承自具体类, 尽量不要超过两层的继承)</li>
<li>尽量不要覆写基类的方法</li>
</ol>
<p>总体而言, 依赖倒置原则是六大原则中最难实现的, 也是实现开闭原则的重要途径. 总体而言, 把握住<em>面向接口编程</em>即可.</p>
]]></content>
      
        <categories>
            
            <category> OO </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[利用python解析xml, json]]></title>
      <url>https://ivyxjc.xyz/2016/10/23/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-10-29-xml-parse/</url>
      <content type="html"><![CDATA[<p>##　XML</p>
<p>需要到的库:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xml.dom.minidom <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> xml.dom.minidom</span><br></pre></td></tr></table></figure>
<p>豆瓣sitemap_index.xml格式如下(2016-10-29):</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sitemapindex</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sitemap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">loc</span>&gt;</span>https://www.douban.com/sitemap3782.xml.gz<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lastmod</span>&gt;</span>2016-10-19T10:36:31Z<span class="tag">&lt;/<span class="name">lastmod</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sitemap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sitemap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">loc</span>&gt;</span>https://www.douban.com/sitemap3783.xml.gz<span class="tag">&lt;/<span class="name">loc</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">lastmod</span>&gt;</span>2016-10-19T10:36:31Z<span class="tag">&lt;/<span class="name">lastmod</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">sitemap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sitemapindex</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>解析过程:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xml_str=douban.sitemap.xml</span><br><span class="line">DOMTree =xml.dom.minidom.parseString(xml_str)</span><br><span class="line">collection = DOMTree.documentElement</span><br><span class="line">elements=collection.getElementsByTagName(<span class="string">"sitemap"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> elements:</span><br><span class="line">    a=i.getElementsByTagName(<span class="string">"loc"</span>)</span><br><span class="line">    print(a[<span class="number">0</span>].childNodes[<span class="number">0</span>].nodeValue)</span><br></pre></td></tr></table></figure>
<p>##　Json</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">map=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3783</span>):</span><br><span class="line">    map[i]=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"text\\sitemap_config.json"</span>,<span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(map,f)</span><br><span class="line"></span><br><span class="line">map=&#123;&#125;</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"text\\sitemap_config.json"</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    map = json.load(f)</span><br><span class="line">print(map)</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> xml </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[selenium + PhantomJS]]></title>
      <url>https://ivyxjc.xyz/2016/10/23/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-10-23-selenium/</url>
      <content type="html"><![CDATA[<h2 id="初始化WebDriver"><a href="#初始化WebDriver" class="headerlink" title="初始化WebDriver"></a>初始化WebDriver</h2><h3 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.__driver=webdriver.Chrome(<span class="string">"D:\\applicationsGreen\\chromedriver_win32\\chromedriver"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="PhantomJS"><a href="#PhantomJS" class="headerlink" title="PhantomJS"></a>PhantomJS</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dcap = dict(DesiredCapabilities.PHANTOMJS)</span><br><span class="line">        dcap[<span class="string">"phantomjs.page.settings.userAgent"</span>] = (</span><br><span class="line">            <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0"</span></span><br><span class="line">        )</span><br><span class="line">self.__driver=webdriver.PhantomJS(desired_capabilities=dcap)</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> selenium </tag>
            
            <tag> PhantomJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[centos 64位更新glibc]]></title>
      <url>https://ivyxjc.xyz/2016/10/19/%E6%95%88%E7%8E%87/2016-10-29-centos-update-glibc/</url>
      <content type="html"><![CDATA[<h2 id="下载新版本glibc"><a href="#下载新版本glibc" class="headerlink" title="下载新版本glibc"></a>下载新版本glibc</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git://sourceware.org/git/glibc.git</span><br><span class="line">cd glibc</span><br><span class="line">git checkout --track -b local_glibc-2.24 origin/release/2.24/master</span><br></pre></td></tr></table></figure>
<h2 id="更新glibc"><a href="#更新glibc" class="headerlink" title="更新glibc"></a>更新glibc</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../configure --prefix=/opt/glibc-2.24</span><br></pre></td></tr></table></figure>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="These-critical-programs-are-missing-or-too-old-as-ld"><a href="#These-critical-programs-are-missing-or-too-old-as-ld" class="headerlink" title="These critical programs are missing or too old: as ld"></a>These critical programs are missing or too old: as ld</h3><p>调用<code>ld -v</code>是2.20..</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi ../configure</span><br></pre></td></tr></table></figure>
<p>在文件中寻找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">case $ac_prog_version in</span><br><span class="line">&apos;&apos;) ac_prog_version=&quot;v. ?.??, bad&quot;; ac_verc_fail=yes;;</span><br><span class="line">2.1[3-9]*|2.2[0-9]*)</span><br></pre></td></tr></table></figure></p>
<p><strong>|2.2[0-9]*</strong>是之后添加的, 因为该机的版本为2.20…, 意即该正则表达式要将本机的版本包括进去.</p>
<h3 id="checking-installed-Linux-kernel-header-files…-missing-or-too-old"><a href="#checking-installed-Linux-kernel-header-files…-missing-or-too-old" class="headerlink" title="checking installed Linux kernel header files… missing or too old!"></a>checking installed Linux kernel header files… missing or too old!</h3>]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActionBar ShareActionProvider]]></title>
      <url>https://ivyxjc.xyz/2016/10/16/android/AndroidSamples/UI/2016-10-16-ActionBar-ShareActionProvider/</url>
      <content type="html"><![CDATA[<h2 id="添加share按钮"><a href="#添加share按钮" class="headerlink" title="添加share按钮"></a>添加share按钮</h2><p>添加share按钮的主要步骤:</p>
<ol>
<li>在ActionBar中添加share按钮</li>
<li><p>从item中获取ShareActionProvider</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ShareActionProvider`&lt;br&gt; `mShareActionProvider=(ShareActionProvider) MenuItemCompat.getActionProvider(shareItem);</span><br></pre></td></tr></table></figure>
</li>
<li><p>向<code>ShareActionProvider</code>中添加<code>itent</code></p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:support</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/share_item"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"@string/menu_share"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">support:actionProviderClass</span>=<span class="string">"android.support.v7.widget.ShareActionProvider"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">support:showAsAction</span>=<span class="string">"always"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/MainActivity.java</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">    getMenuInflater().inflate(R.menu.main_menu,menu);</span><br><span class="line"></span><br><span class="line">    MenuItem shareItem=menu.findItem(R.id.share_item);</span><br><span class="line"></span><br><span class="line">    mShareActionProvider=(ShareActionProvider) MenuItemCompat.getActionProvider(shareItem);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> currentViewPagerItem=((ViewPager)findViewById(R.id.viewPager)).getCurrentItem();</span><br><span class="line">    setShareItem(currentViewPagerItem);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onCreateOptionsMenu(menu);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setShareItem</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mShareActionProvider!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        ContentItem item=mItems.get(i);</span><br><span class="line"></span><br><span class="line">        Intent intent=item.getShareIntent(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        mShareActionProvider.setShareIntent(intent);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Intent <span class="title">getShareIntent</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">    Intent intent=<span class="keyword">new</span> Intent(Intent.ACTION_SEND);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (contentType) &#123;</span><br><span class="line">        <span class="keyword">case</span> CONTENT_TYPE_IMAGE:</span><br><span class="line">            intent.setType(<span class="string">"image/jpg"</span>);</span><br><span class="line">            intent.putExtra(Intent.EXTRA_STREAM, getContentUri());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> CONTENT_TYPE_TEXT:</span><br><span class="line">            intent.setType(<span class="string">"text/plain"</span>);</span><br><span class="line">            intent.putExtra(Intent.EXTRA_TEXT, context.getString(contentResourceId));</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> intent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\ContentItem</span><br><span class="line"><span class="function"><span class="keyword">public</span> Uri <span class="title">getContentUri</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!TextUtils.isEmpty(contentAssetFilePath))&#123;</span><br><span class="line">        <span class="keyword">return</span> Uri.parse(ShareProvider.CONTENT_URI+contentAssetFilePath);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h2><h3 id="确保ShareActionProvider和所在的ViewPager的CurrentItem-对应"><a href="#确保ShareActionProvider和所在的ViewPager的CurrentItem-对应" class="headerlink" title="确保ShareActionProvider和所在的ViewPager的CurrentItem()对应"></a>确保ShareActionProvider和所在的ViewPager的<code>CurrentItem()</code>对应</h3><p>很容易被<code>onCreateOptionsMenu()</code>中下列代码迷惑, 以为ShareActionProvider已经和<code>CurrentItem()</code>对应了.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> currentViewPagerItem=((ViewPager)findViewById(R.id.viewPager)).getCurrentItem();</span><br><span class="line">setShareItem(currentViewPagerItem);</span><br></pre></td></tr></table></figure>
<p>事实上并没有, <code>onCreateOptionsMenu</code>方法只会在初始ActionBar时调用, 且也不会设置监听. 所以ShareActionProvider总是设置在了第一个item的intent中.</p>
<p>所以需要添加以下代码, 确保切换页面后, ShareActionProvider和item仍是正确对应的.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mViewPager.setOnPageChangeListener(<span class="keyword">new</span> ViewPager.OnPageChangeListener() &#123;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrolled</span><span class="params">(<span class="keyword">int</span> position, <span class="keyword">float</span> positionOffset, <span class="keyword">int</span> positionOffsetPixels)</span> </span>&#123;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageSelected</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">          setShareItem(position);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrollStateChanged</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="如何获取图片uri"><a href="#如何获取图片uri" class="headerlink" title="如何获取图片uri"></a>如何获取图片uri</h3><p>获取<code>/res/drawable</code>中图片的uri可以使用以下方法:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Uri imageUri = Uri.parse(ContentResolver.SCHEME_ANDROID_RESOURCE +</span><br><span class="line"> <span class="string">"://"</span> + getResources().getResourcePackageName(R.drawable.ic_launcher)</span><br><span class="line"> + <span class="string">'/'</span> + getResources().getResourceTypeName(R.drawable.ic_launcher) + <span class="string">'/'</span></span><br><span class="line"> +  getResources().getResourceEntryName(R.drawable.ic_launcher) );</span><br></pre></td></tr></table></figure>
<p> 等价于</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uri uri = Uri.parse(&quot;android.resource://your.package.here/drawable/image_name&quot;);</span><br></pre></td></tr></table></figure>
<p>如果不正确,可以调用第一个方法,再使用Log自行查看准确的字符串.</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Git相关命令及用法]]></title>
      <url>https://ivyxjc.xyz/2016/10/14/%E6%95%88%E7%8E%87/2016-10-14-git/</url>
      <content type="html"><![CDATA[<h2 id="add-commit-push"><a href="#add-commit-push" class="headerlink" title="add commit push"></a>add commit push</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br><span class="line">git commit -m &quot;&quot;</span><br><span class="line">git push -u origin branch</span><br></pre></td></tr></table></figure>
<p>在删除某一些文件时, 应使用<code>git add .</code>. 否则, 会出现<code>Changes not staged for commit: ...</code></p>
<h2 id="清除提交记录"><a href="#清除提交记录" class="headerlink" title="清除提交记录"></a>清除提交记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git filter-branch --force --index-filter &apos;git rm --cached --ignore-unmatch path-to-your-remove-file&apos; --prune-empty --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure>
<p>上面会在历史记录里面删除相应的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 执行垃圾回收</span><br><span class="line">rm -rf .git/refs/original/</span><br><span class="line">git gc --prune=now</span><br><span class="line">git gc --aggressive --prune=now</span><br></pre></td></tr></table></figure>
<h2 id="添加子模块"><a href="#添加子模块" class="headerlink" title="添加子模块"></a>添加子模块</h2><p>子模块的操作必须非常小心, 因为其中有很多坑.</p>
<h3 id="第一次添加子模块"><a href="#第一次添加子模块" class="headerlink" title="第一次添加子模块"></a>第一次添加子模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add git://github.com/chneukirchen/rack.git rack</span><br></pre></td></tr></table></figure>
<h3 id="删除某个子模块"><a href="#删除某个子模块" class="headerlink" title="删除某个子模块"></a>删除某个子模块</h3><p><code>git rm --cached pathOfSubmodule</code></p>
<p>然后删除_config.yml以及.git/config文件中相关记录</p>
<h3 id="更改子模块后提交对子模块的修改"><a href="#更改子模块后提交对子模块的修改" class="headerlink" title="更改子模块后提交对子模块的修改"></a>更改子模块后提交对子模块的修改</h3><p>进入子模块所在目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br><span class="line">git commit -m &quot;&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure>
<h3 id="主项目提交"><a href="#主项目提交" class="headerlink" title="主项目提交"></a>主项目提交</h3><p>我们可以直接像正常git文件一样的流程进行提交, 但是如果我们忘记提交子模块的变动, 而新的项目和子模块的变动又相关. 那么其他人从远程仓库中clone的文件可能并不能正确运行(缺少必要的子模块变动).</p>
<p>所有推荐使用以下两种方法：</p>
<ol>
<li><code>git push --recurse-submodules=check</code>. 若有子模块的变动没有推送, 那么该<code>push</code>会失败.</li>
<li><code>git push --recurse-submodules=on-demand</code>. 若有子模块的变动没有推送, 那么它会先推送子模块的变动, 然后再推送主项目.</li>
</ol>
<h3 id="子模块的更新"><a href="#子模块的更新" class="headerlink" title="子模块的更新"></a>子模块的更新</h3><p>其他人如果对子模块进行了修改, 在<code>git pull</code>之后, 再调用以下<code>git submodule update</code>更新子模块.</p>
<p>调用<code>git submodule update</code>也更新子模块的相关内容, 但是会将子模块留在一个称作 <code>detached HEAD</code>的状态. 这意味着没有本地工作分支（例如 “master”）跟踪改动。 所以你做的任何改动都不会被跟踪。即使你使用了commit提交了一些变动, 在你下一次使用<code>git submodule update</code>时, 这些变动会全部丢失.</p>
<p>所以需要进入每一个你希望对其进行修改的子模块,<code>git checkout branchName</code>检出一个分支. 从远程仓库中更新本地文件时, 使用<code>git submodule update --remote --merge</code>, 也可以使用<code>--rebase</code>.</p>
<p>如果忘记了<code>--rebase</code>或者<code>--merge</code>, git会将子模块更新为远程仓库上的状态, 而且该项目将再一次进入 <code>detached HEAD</code> 的状态. 解决方法：</p>
<ol>
<li>检出包含之前本地更改的分支</li>
<li>然后手动的merge或者rebase任何一个远程分支即可.</li>
</ol>
<p>即使没有提交子模块的更改也某有问题, 此时git只会抓取更改, 而不会覆盖本地内容.</p>
<h3 id="克隆一个带子模块的项目"><a href="#克隆一个带子模块的项目" class="headerlink" title="克隆一个带子模块的项目"></a>克隆一个带子模块的项目</h3><p>克隆一个包含子模块的项目.<code>git clone</code>下来之后, 该子模块并不会被clone下来.需要调用以下两个命令：</p>
<ol>
<li><code>git submodule init</code>来下载本地所需的子模块配置文件文件</li>
<li><code>git submodule update</code>来下载主项目中列出的合适的子模块提交</li>
</ol>
<p>也可以使用<code>git clone --recursivegit clone --recursive https://github.com/...</code>自动地初始化并更新仓库中的每一个子模块.</p>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faq </tag>
            
            <tag> git </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linux 常用命令]]></title>
      <url>https://ivyxjc.xyz/2016/10/10/Linux/2016-10-10-linux-bash/</url>
      <content type="html"><![CDATA[<h2 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h2><h3 id="解压-zip文件"><a href="#解压-zip文件" class="headerlink" title="解压.zip文件"></a>解压.zip文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip xxx.zip</span><br></pre></td></tr></table></figure>
<h3 id="解压tar-gz文件"><a href="#解压tar-gz文件" class="headerlink" title="解压tar.gz文件"></a>解压tar.gz文件</h3><h2 id="文件相关操作"><a href="#文件相关操作" class="headerlink" title="文件相关操作"></a>文件相关操作</h2><h3 id="空间使用情况"><a href="#空间使用情况" class="headerlink" title="空间使用情况"></a>空间使用情况</h3><p><code>df -h</code>: 查看空间使用情况</p>
<h3 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h3><p>mv dir1 dir2</p>
<h2 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a>进程相关</h2><h3 id="如何查看正在运行的进程"><a href="#如何查看正在运行的进程" class="headerlink" title="如何查看正在运行的进程"></a>如何查看正在运行的进程</h3><p><code>ps -A</code>:显示所有的进程<br><code>ps -a</code>:显示终端中包括其它用户的所有进程<br><code>ps -x</code>:显示无控制终端的进程</p>
<h3 id="如何关闭正在运行的进程"><a href="#如何关闭正在运行的进程" class="headerlink" title="如何关闭正在运行的进程"></a>如何关闭正在运行的进程</h3><p><code>kill -9 xxx</code>:xxx是进程的PID</p>
<h3 id="显示端口占用情况"><a href="#显示端口占用情况" class="headerlink" title="显示端口占用情况"></a>显示端口占用情况</h3><p><code>lsof -i</code></p>
<h2 id="vim相关操作"><a href="#vim相关操作" class="headerlink" title="vim相关操作"></a>vim相关操作</h2><h3 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h3><p>?pattern 光标下方查找<br>/pattern 光标上方查找</p>
<h2 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h2><p><code>crontab -l</code>:可以查看正在进行的定时任务<br><code>crontab -e</code>:可以进行修改<br><code>/etc/init.d/cron restart</code>: 重新该服务</p>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[matplotlib绘制2D，3D散点图]]></title>
      <url>https://ivyxjc.xyz/2016/10/04/python/matplotlib/2016-10-04-matplotlib-basic/</url>
      <content type="html"><![CDATA[<h2 id="2d散点图"><a href="#2d散点图" class="headerlink" title="2d散点图"></a>2d散点图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置颜色</span></span><br><span class="line">colors = [<span class="string">'#0000FF'</span>,<span class="string">'#3CB371'</span>]</span><br><span class="line"><span class="comment">#各点大小的list</span></span><br><span class="line">sizeLab=np.add(sizeLab,<span class="number">20</span>)</span><br><span class="line"><span class="comment"># print(sizeLab)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置横轴上下限</span></span><br><span class="line">plt.xlim(<span class="number">0</span>,<span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置横轴标号</span></span><br><span class="line"><span class="comment"># plt.xticks(np.linspace(0,15,5,endpoint=True))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置记号的标签</span></span><br><span class="line">plt.xticks([<span class="number">2</span>*np.pi, <span class="number">4</span>*np.pi, <span class="number">0</span>, np.pi/<span class="number">2</span>, np.pi],</span><br><span class="line">       [<span class="string">r'$2\pi$'</span>, <span class="string">r'$4\pi$'</span>, <span class="string">r'$0$'</span>, <span class="string">r'$\pi/2$'</span>, <span class="string">r'$\pi$'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置横纵坐标label</span></span><br><span class="line">plt.xlabel(<span class="string">"x 轴label"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"y 轴label"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.scatter(datingDataMat[:,<span class="number">1</span>],datingDataMat[:,<span class="number">2</span>],s=sizeLab, c=colors)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="3d散点图"><a href="#3d散点图" class="headerlink" title="3d散点图"></a>3d散点图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">fig=plt.figure()</span><br><span class="line">ax=fig.add_subplot(<span class="number">111</span>,projection=<span class="string">'3d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置坐标</span></span><br><span class="line">ax.set_xlabel(<span class="string">"飞行里程数"</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">"游戏时间百分比"</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">"冰激凌消耗量"</span>)</span><br><span class="line"></span><br><span class="line">type1=ax.scatter(dataDidnlike[:,<span class="number">0</span>], dataDidnlike[:,<span class="number">1</span>], dataDidnlike[:,<span class="number">2</span>], c=<span class="string">'#3c345b'</span>)</span><br><span class="line">type2=ax.scatter(dataSmallDoses[:,<span class="number">0</span>], dataSmallDoses[:,<span class="number">1</span>],dataSmallDoses[:,<span class="number">2</span>],c=<span class="string">"#4576f7"</span>)</span><br><span class="line">type3=ax.scatter(dataLargeDoses[:,<span class="number">0</span>], dataLargeDoses[:,<span class="number">1</span>], dataLargeDoses[:,<span class="number">2</span>],c=<span class="string">"#43ff1a"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置图例</span></span><br><span class="line">ax.legend((type1, type2, type3), (<span class="string">u'不喜欢'</span>, <span class="string">u'魅力一般'</span>, <span class="string">u'极具魅力'</span>), loc=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> matplotlib </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[numpy user guide]]></title>
      <url>https://ivyxjc.xyz/2016/10/04/python/numpy/2016-10-04-numpy-basic/</url>
      <content type="html"><![CDATA[<h2 id="numpy-tile-A-reprs"><a href="#numpy-tile-A-reprs" class="headerlink" title="numpy.tile(A,reprs)"></a>numpy.tile(A,reprs)</h2><p><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.tile.html" target="_blank" rel="noopener">numpy.tile</a></p>
<p><code>numpy.tile(A, reps)</code></p>
<p>This method will return a <code>max( d, A.ndim)</code> dimension array( <code>d= len( reprs)</code>).</p>
<p>if<code>d&gt; A.ndim</code>, it will return a d-dimension array by prepending new axes;<br><br>etc.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">&gt;&gt;&gt;np.tile(a,(<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">[[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]</span><br><span class="line"></span><br><span class="line"> [[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">  [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]]</span><br></pre></td></tr></table></figure>
<p>if <code>d&lt; A.ndim</code>, it will return an A.ndim-dimension array by prepending 1’s to it .<br>For example, for an shape of(1,2,2,3), a reps of (2,3) will be treated as (1,1,2,3)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = np.array([[[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]]])</span><br><span class="line">&gt;&gt;&gt;np.tile(a,(<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">[[[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">   [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">   [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">   [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]]]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;a = np.array([[[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]]])</span><br><span class="line">&gt;&gt;&gt;np.tile(a,(<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">[[[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">   [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]</span><br><span class="line"></span><br><span class="line">  [[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">   [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]]]</span><br></pre></td></tr></table></figure>
<h2 id="numpy-sum"><a href="#numpy-sum" class="headerlink" title="numpy.sum()"></a>numpy.sum()</h2><p><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.sum.html" target="_blank" rel="noopener">numpy.sum()</a></p>
<p><code>numpy.sum(a, axis=None, dtype=None, out=None, keepdims=False)</code></p>
<h2 id="axis"><a href="#axis" class="headerlink" title="axis"></a>axis</h2><p>This is a litte complex. <code>abs(axis)</code> must be less than <code>a.ndim</code>.</p>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/numpy_sum_1.jpg" alt=""><br><img src="http://oezmbgg4j.bkt.clouddn.com/numpy_sum_2.jpg" alt=""></p>
<h3 id="dtype"><a href="#dtype" class="headerlink" title="dtype"></a>dtype</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;b=np.array([<span class="number">0.3</span>,<span class="number">0.4</span>,<span class="number">0.9</span>,<span class="number">1.5</span>,<span class="number">1.9</span>])</span><br><span class="line">&gt;&gt;&gt;print(b.sum(dtype=np.int32))</span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="keepdims"><a href="#keepdims" class="headerlink" title="keepdims"></a>keepdims</h3><p>If this parameter is assigned to True, the it will return an array as dimension with the size that input array is</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;b=np.array([[[<span class="number">0.3</span>,<span class="number">0.4</span>,<span class="number">0.9</span>,<span class="number">1.5</span>,<span class="number">1.9</span>]]])</span><br><span class="line">&gt;&gt;&gt;print(b.sum())</span><br><span class="line"></span><br><span class="line"><span class="number">5.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;b=np.array([[[<span class="number">0.3</span>,<span class="number">0.4</span>,<span class="number">0.9</span>,<span class="number">1.5</span>,<span class="number">1.9</span>]]])</span><br><span class="line">&gt;&gt;&gt;print(b.sum(keepdims=<span class="keyword">True</span>))</span><br><span class="line"></span><br><span class="line">[[[ <span class="number">5.</span>]]]</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> numpy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActionBar PopuMenu]]></title>
      <url>https://ivyxjc.xyz/2016/09/24/android/AndroidSamples/UI/2016-09-24-ActionBar-PopupMenu/</url>
      <content type="html"><![CDATA[<h2 id="PopupMenu"><a href="#PopupMenu" class="headerlink" title="PopupMenu"></a>PopupMenu</h2><p>popupmenu可以非常方便得实现在指定view下弹出一个菜单,实现类似ActionBar中的效果.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showPopupMenu</span><span class="params">(View view)</span></span>&#123;</span><br><span class="line">        <span class="keyword">final</span> PopupAdapter adapter = (PopupAdapter) getListAdapter();</span><br><span class="line">        <span class="keyword">final</span> String item = (String) view.getTag();</span><br><span class="line"></span><br><span class="line">        PopupMenu popup = <span class="keyword">new</span> PopupMenu(getActivity(), view);</span><br><span class="line"></span><br><span class="line">        popup.getMenuInflater().inflate(R.menu.popup, popup.getMenu());</span><br><span class="line"></span><br><span class="line">        popup.setOnMenuItemClickListener(<span class="keyword">new</span> PopupMenu.OnMenuItemClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMenuItemClick</span><span class="params">(MenuItem menuItem)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">switch</span> (menuItem.getItemId())&#123;</span><br><span class="line">                    <span class="keyword">case</span> R.id.menu_remove:</span><br><span class="line">                        adapter.remove(item);</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        popup.show();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[自定义FloatingActionButtom]]></title>
      <url>https://ivyxjc.xyz/2016/09/24/android/AndroidSamples/controls/2016-10-18-custom-button/</url>
      <content type="html"><![CDATA[<h2 id="设置监听的最基本方式"><a href="#设置监听的最基本方式" class="headerlink" title="设置监听的最基本方式"></a>设置监听的最基本方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatingActionButton</span> <span class="keyword">extends</span> <span class="title">FrameLayout</span> <span class="keyword">implements</span> <span class="title">Checkable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnCheckedChangeListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onCheckedChanged</span><span class="params">(FloatingActionButton fabView, <span class="keyword">boolean</span> isChecked)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> OnCheckedChangeListener mOnCheckedChangeListener;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnCheckedChangeListener</span><span class="params">(OnCheckedChangeListener listener)</span> </span>&#123;</span><br><span class="line">        mOnCheckedChangeListener = listener;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_control </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ActionBarCompat]]></title>
      <url>https://ivyxjc.xyz/2016/09/24/android/AndroidSamples/UI/2016-09-24-ActionBar-Basic/</url>
      <content type="html"><![CDATA[<h2 id="布局文件中添加menu"><a href="#布局文件中添加menu" class="headerlink" title="布局文件中添加menu"></a>布局文件中添加menu</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">menu_main.xml</span><br><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">xmlns:support</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/menu_setting"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_action_settings"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"@string/menu_setting"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">support:showAsAction</span>=<span class="string">"never"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/menu_refresh"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_action_refresh"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"@string/menu_refresh"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">support:showAsAction</span>=<span class="string">"always"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Activity中添加menu"><a href="#Activity中添加menu" class="headerlink" title="Activity中添加menu"></a>Activity中添加menu</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">values/ids.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"menu_location"</span> <span class="attr">type</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">    getMenuInflater().inflate(R.menu.menu_main,menu);</span><br><span class="line">    MenuItem location=menu.add(<span class="number">0</span>,R.id.menu_location,<span class="number">0</span>,<span class="string">"Location"</span>);</span><br><span class="line">    location.setIcon(R.mipmap.ic_action_location);</span><br><span class="line">    MenuItemCompat.setShowAsAction(location,MenuItemCompat.SHOW_AS_ACTION_IF_ROOM);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(MenuItem item)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">        <span class="keyword">case</span> R.id.menu_setting:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">case</span> R.id.menu_location:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">case</span> R.id.menu_refresh:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><h3 id="运行时更改菜单项"><a href="#运行时更改菜单项" class="headerlink" title="运行时更改菜单项"></a>运行时更改菜单项</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mButtonForbidRefresh.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">           <span class="keyword">private</span> <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">               i++;</span><br><span class="line">               <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">                   mButtonForbidRefresh.setActivated(<span class="keyword">true</span>);</span><br><span class="line">               <span class="keyword">else</span></span><br><span class="line">                   mButtonForbidRefresh.setActivated(<span class="keyword">false</span>);</span><br><span class="line">               invalidateOptionsMenu();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onPrepareOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</span><br><span class="line">        menu.clear();</span><br><span class="line">        getMenuInflater().inflate(R.menu.menu_main, menu);</span><br><span class="line">        MenuItem item=menu.findItem(R.id.menu_refresh);</span><br><span class="line">        <span class="keyword">if</span>(mButtonForbidRefresh.isActivated())&#123;</span><br><span class="line">           item.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        MenuItem location = menu.add(<span class="number">0</span>, R.id.menu_location, Menu.CATEGORY_SECONDARY, <span class="string">"Location"</span>);</span><br><span class="line">        location.setIcon(R.mipmap.ic_action_location);</span><br><span class="line">        MenuItemCompat.setShowAsAction(location, MenuItemCompat.SHOW_AS_ACTION_IF_ROOM);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.onPrepareOptionsMenu(menu);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>menu.findItem(int id)</code><br></p>
<p><code>menu.getItem(int index)</code></p>
<h3 id="onPrepareOptionsMenu-Menu-menu-和onCreateOptionsMenu-Menu-menu-区别"><a href="#onPrepareOptionsMenu-Menu-menu-和onCreateOptionsMenu-Menu-menu-区别" class="headerlink" title="onPrepareOptionsMenu(Menu menu)和onCreateOptionsMenu(Menu menu)区别"></a>onPrepareOptionsMenu(Menu menu)和onCreateOptionsMenu(Menu menu)区别</h3><p><code>onCreateOptionsMenu(Menu menu)</code>只在最初的时候会调用每次点击menu都会调用一次<code>onPrepareOptionsMenu(Menu menu)</code>.使用<code>invalidateOptionsMenu()</code>会直接调用onPrepareOptionsMenu(Menu menu);</p>
<h3 id="多个Activity共用相同ActionBar"><a href="#多个Activity共用相同ActionBar" class="headerlink" title="多个Activity共用相同ActionBar"></a>多个Activity共用相同ActionBar</h3><p>如果应用包含多个 Activity，且其中某些 Activity 提供相同的选项菜单，则可考虑创建一个仅实现<code>onCreateOptionsMenu()</code> 和 <code>onOptionsItemSelected()</code>方法的 Activity。然后为每个应共享相同选项菜单的 Activity 扩展此类。 通过这种方式，您可以管理一个用于处理菜单操作的代码集，且每个子级类均会继承菜单行为。若要将菜单项添加到一个子级 Activity，请重写该 Activity 中的 <code>onCreateOptionsMenu()</code>。调用 <code>super.onCreateOptionsMenu(menu)</code>，以便创建原始菜单项，然后使用 <code>menu.add()</code> 添加新菜单项。此外，您还可以替代各个菜单项的超类行为。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[RecyclerView]]></title>
      <url>https://ivyxjc.xyz/2016/09/18/android/UI%E7%9B%B8%E5%85%B3/2016-09-18-RecyclerView/</url>
      <content type="html"><![CDATA[<h2 id="RecyclerView-设置布局格式"><a href="#RecyclerView-设置布局格式" class="headerlink" title="RecyclerView 设置布局格式"></a>RecyclerView 设置布局格式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mRecyclerView = (RecyclerView) v.findViewById(R.id.main_rv);</span><br><span class="line"><span class="comment">//类似ListView显示用</span></span><br><span class="line">mRecyclerView.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(getActivity()));</span><br><span class="line"><span class="comment">//类似GridView显示</span></span><br><span class="line">mRecyclerView.setLayoutManager(<span class="keyword">new</span> GridLayoutManager(getActivity(), <span class="number">3</span>));</span><br></pre></td></tr></table></figure>
<h2 id="RecyclerView-添加适配器-以及设置item点击监听"><a href="#RecyclerView-添加适配器-以及设置item点击监听" class="headerlink" title="RecyclerView 添加适配器 以及设置item点击监听"></a>RecyclerView 添加适配器 以及设置item点击监听</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MainFragment.java</span><br><span class="line"></span><br><span class="line">mRecyclerViewAdapter = <span class="keyword">new</span> RecyclerViewAdapter(getActivity(), mItems, <span class="keyword">false</span>);</span><br><span class="line">mRecyclerView.setAdapter(mRecyclerViewAdapter)</span><br><span class="line"></span><br><span class="line">mRecyclerViewAdapter.setOnItemClickListener(<span class="keyword">new</span> RecyclerViewAdapter.OnItemClickListenerCustom() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(String id, String title)</span> </span>&#123;</span><br><span class="line">                Log.i(LogKeys.MAIN_FRAGMENT, <span class="string">"item is clicked "</span>);</span><br><span class="line">                Intent intent = <span class="keyword">new</span> Intent(getActivity(), MovieDetailActivity.class);</span><br><span class="line">                intent.putExtra(TransferKeys.MAIN_MOVIE_DETAIL_ID, id);</span><br><span class="line">                intent.putExtra(TransferKeys.MAIN_MOVIE_DETAIL_MOVIE_NAME, title);</span><br><span class="line">                startActivity(intent);</span><br><span class="line">                Log.i(LogKeys.MAIN_FRAGMENT, <span class="string">"startactivity"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RecyclerViewAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">RecyclerView</span>.<span class="title">ViewHolder</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Context mContext;</span><br><span class="line">    <span class="keyword">private</span> List&lt;MainItem&gt; mData;</span><br><span class="line">    <span class="keyword">private</span> OnItemClickListenerCustom mCallback;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> mIsComingMovie;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mTotalCount;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnItemClickListenerCustom</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(String id,String title)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RecyclerViewAdapter_Main</span><span class="params">(Context context, List&lt;MainItem&gt; data,</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">boolean</span> isComingMovie)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.mContext = context;</span><br><span class="line">        <span class="keyword">this</span>.mData = data;</span><br><span class="line">        <span class="keyword">this</span>.mIsComingMovie=isComingMovie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">(ArrayList&lt;MainItem&gt; data)</span></span>&#123;</span><br><span class="line">        mData.addAll(data);</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RecyclerView.<span class="function">ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span> </span>&#123;</span><br><span class="line">        View view=LayoutInflater.from(mContext)</span><br><span class="line">                                .inflate(R.layout.item_movie_main,parent,<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ItemViewHolder(view);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(RecyclerView.ViewHolder holder, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        ((ItemViewHolder)holder).update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mData.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnItemClickListener</span><span class="params">(OnItemClickListenerCustom listener)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mCallback=listener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ItemViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">        TextView textTitle;</span><br><span class="line">        MainItem mMainItem;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ItemViewHolder</span><span class="params">(View itemView)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(itemView);</span><br><span class="line">            <span class="comment">//初始化控件</span></span><br><span class="line">            itemView.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">//填充控件</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(mCallback!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                mCallback.onItemClick(mMainItem.getMovieId(),mMainItem.getTitle());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="RecyclerView上滑加载"><a href="#RecyclerView上滑加载" class="headerlink" title="RecyclerView上滑加载"></a>RecyclerView上滑加载</h2><p>要使FetchItemTask顺序执行, 否则当下滑触发loadMoreData时,会出现多个线程, 若这几个线程同时<br>进行,会导致数据重复加载, 这些Task顺序执行, 只需要在doInBackground执行时<br>检查star&lt;mRecyclerViewAdapter.getStart()<br>若true, 则说明该线程为重复线程 return null<br>否则, 执行之后的步骤</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">MainFragmentBase.java</span><br><span class="line">mRecyclerView.addOnScrollListener(<span class="keyword">new</span> RecyclerView.OnScrollListener()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> lastVisibleItem;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrollStateChanged</span><span class="params">(RecyclerView recyclerView,</span></span></span><br><span class="line"><span class="function"><span class="params">                                     <span class="keyword">int</span> newState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onScrollStateChanged(recyclerView, newState);</span><br><span class="line">        <span class="keyword">if</span> (newState == SCROLL_STATE_IDLE</span><br><span class="line">                &amp;&amp; lastVisibleItem + <span class="number">1</span> &gt;= mRecyclerViewAdapter.getItemCount()</span><br><span class="line">                &amp;&amp; mRecyclerViewAdapter.getItemCount() &lt; mRecyclerViewAdapter.getTotalDataCount()) &#123;</span><br><span class="line">            loadMoreData(mRecyclerViewAdapter.getStart());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrolled</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onScrolled(recyclerView, dx, dy);</span><br><span class="line">        LinearLayoutManager layoutManager = (LinearLayoutManager) mRecyclerView.getLayoutManager();</span><br><span class="line">        lastVisibleItem = layoutManager.findLastVisibleItemPosition();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">loadMoreData</span><span class="params">(<span class="keyword">int</span> start)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MainFragment.java extentds MainFragmentBase.java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> FetchItemTask(<span class="number">0</span>).executeOnExecutor(AsyncTask.SERIAL_EXECUTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">loadMoreData</span><span class="params">(<span class="keyword">int</span> start)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> FetchItemTask(start).executeOnExecutor(AsyncTask.SERIAL_EXECUTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">FetchItemTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Void</span>, <span class="title">ArrayList</span>&lt;<span class="title">MainItem</span>&gt;&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> start=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FetchItemTask</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">        start=s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ArrayList&lt;MainItem&gt; <span class="title">doInBackground</span><span class="params">(Void... params)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(start&lt;mRecyclerViewAdapter.getStart())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span></span><br><span class="line">        &#125;</span><br><span class="line">        DoubanFetchrMain df=<span class="keyword">new</span> DoubanFetchrMain(<span class="number">0</span>,start);</span><br><span class="line">        mRecyclerViewAdapter.setTotalCount(df.getTotalCount());</span><br><span class="line">        <span class="keyword">return</span> df.fetchItems_SubjectInTheaters();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(ArrayList&lt;MainItem&gt; galleryItems)</span></span>&#123;</span><br><span class="line">        mItems = galleryItems;</span><br><span class="line">        <span class="keyword">if</span>(mItems==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        mRecyclerViewAdapter.addMoreData(mItems,start);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h2><p>点击图片进入电影详细页面时, 如果在详细页面图片未加载时返回, 应用会crash.<br><br>应该是此时ImageView已经被销毁了, 所以就造成NullPointerException.</p>
<p>官方说已经解决这个问题, 但是下面这写法还是会crash.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Glide.with(getActivity())</span><br><span class="line">     .load(url)</span><br><span class="line">     .diskCacheStrategy(DiskCacheStrategy.ALL)</span><br><span class="line">     .centerCrop()</span><br><span class="line">     .into(imageMovie);</span><br></pre></td></tr></table></figure>
<p>更改为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">onCreate(...)&#123;</span><br><span class="line">mRequestManager=Glide.with(getActivity());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">mRequestManager</span><br><span class="line">           .load(url)</span><br><span class="line">           .diskCacheStrategy(DiskCacheStrategy.ALL)</span><br><span class="line">           .centerCrop()</span><br><span class="line">           .into(imageMovie);</span><br></pre></td></tr></table></figure>
<p>这样就不会出问题.</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_RecyclerView </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CriminalIntent程序中ViewPager相关内容]]></title>
      <url>https://ivyxjc.xyz/2016/07/08/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AndroidBigNerdRanceGuide/CriminalIntent%E5%BC%80%E5%8F%91/2016-07-08-ViewPager/</url>
      <content type="html"><![CDATA[<h2 id="FragmenPagerAdapter和FragmenStatePagerAdapter"><a href="#FragmenPagerAdapter和FragmenStatePagerAdapter" class="headerlink" title="FragmenPagerAdapter和FragmenStatePagerAdapter"></a>FragmenPagerAdapter和FragmenStatePagerAdapter</h2><p>这两者的区别主要在于卸载不再需要的fragment时采取的方法不同。</p>
<p>使用FragmentStatePagerAdapter会销毁掉不需要的fragment。事务提交后，可以将fragment从activity的FragmentManager中彻底移除。该类名中的<code>state</code>表明在销毁fragment时，它会将<code>onSaveInstanceState(Bundle)</code>方法中的Bundle信息保存下来。用户切换回来时，保存的实例可用于回复生成新的fragment。</p>
<p>FragmentPagerAdapter对于不再需要的fragment，FragmentManager选择调用事务的<code>detach(fragment)</code>方法，而非<code>remove(fragment)</code>方法，FragmentPagerAdapter只是销毁fragment的视图，但是仍将实例保留在FragmentManager中。FragmentPagerAdapter创建的fragment不会被销毁。</p>
<p>由上可知:</p>
<ol>
<li>FragmentStatePagerAdapter更省内存，所以当有大量的fragment时，推荐使用FragmentStatePagerAdapter.</li>
<li>但是当用户界面只有少量fragment时，推荐FragmentPagerAdapter。</li>
</ol>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_view_pager </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[简易计算器开发]]></title>
      <url>https://ivyxjc.xyz/2016/07/07/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/%E4%B8%AA%E4%BA%BA%E5%BC%80%E5%8F%91/2016-07-07-calculator/</url>
      <content type="html"><![CDATA[<h2 id="edittext按回车时操作"><a href="#edittext按回车时操作" class="headerlink" title="edittext按回车时操作"></a>edittext按回车时操作</h2><p>如果有多行，没一行有多个edittext时，按回车时，它会到下一行的edittext之中，而不是同一行的下一个editext。</p>
<p>在xml文件中添加<code>imeOptions</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:inputType</span>=<span class="string">"numberDecimal"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/editText3"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:imeOptions</span>=<span class="string">"actionNext"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>但是最后一行按回车回跳到下一行最后一个而不是下一行第一个。</p>
<h2 id="listfragment自己编写listadapter中button监听问题"><a href="#listfragment自己编写listadapter中button监听问题" class="headerlink" title="listfragment自己编写listadapter中button监听问题"></a>listfragment自己编写listadapter中button监听问题</h2><p>listfragment自己编写listadapter中button总是监听最后一个item中的数据。</p>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/listview_button_click.gif" alt=""></p>
<p>无论点击哪一个button都是计算最后一行。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CriminalIntent程序中Fragment，Activity通信]]></title>
      <url>https://ivyxjc.xyz/2016/07/06/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AndroidBigNerdRanceGuide/CriminalIntent%E5%BC%80%E5%8F%91/2016-07-06-CriminalIntent-Intent/</url>
      <content type="html"><![CDATA[<h2 id="最简单的应用"><a href="#最简单的应用" class="headerlink" title="最简单的应用"></a>最简单的应用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Intent intent=<span class="keyword">new</span> Intent(getActivity(), ActivityCrimeBase.class);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure>
<h2 id="使用extra添加信息"><a href="#使用extra添加信息" class="headerlink" title="使用extra添加信息"></a>使用extra添加信息</h2><h3 id="附加extra信息"><a href="#附加extra信息" class="headerlink" title="附加extra信息"></a>附加extra信息</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intent.putExtra(FragmentCrime.EXTRA_CRIME_ID,c.getId());</span><br></pre></td></tr></table></figure>
<h3 id="获取extra信息"><a href="#获取extra信息" class="headerlink" title="获取extra信息"></a>获取extra信息</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FragmentCrime.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String EXTRA_CRIME_ID=<span class="string">"com.jc.criminalIntent2.crime_id"</span>;</span><br><span class="line">....</span><br><span class="line">....</span><br><span class="line">UUID crimeId=(UUID)getActivity()</span><br><span class="line">                .getIntent()</span><br><span class="line">                .getSerializableExtra(EXTRA_CRIME_ID);</span><br></pre></td></tr></table></figure>
<p>此方法会破坏fragment的封装性，因为这时fragment总是需要由某个具体的activity托管。</p>
<p>为了解决这一问题，可以就爱你个<code>mCrimeId</code>存放在fragment的arguments bundle中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ActivityCrime.java</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityCrime</span> <span class="keyword">extends</span> <span class="title">ActivitySetFragmentBase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Fragment <span class="title">createFragment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        UUID crimeId=(UUID)getIntent()</span><br><span class="line">                .getSerializableExtra(FragmentCrime.EXTRA_CRIME_ID);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> FragmentCrime.newInstance(crimeId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FragmentCrime.java</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">     UUID crimeId=(UUID)getArguments()</span><br><span class="line">             .getSerializable(EXTRA_CRIME_ID);</span><br><span class="line">     mCrime=CrimeLab.get(getActivity()).getCrime(crimeId);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FragmentCrime <span class="title">newInstance</span><span class="params">(UUID crimeId)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">     Bundle args=<span class="keyword">new</span> Bundle();</span><br><span class="line">     args.putSerializable(EXTRA_CRIME_ID,crimeId);</span><br><span class="line">     FragmentCrime fragment=<span class="keyword">new</span> FragmentCrime();</span><br><span class="line">     fragment.setArguments(args);</span><br><span class="line">     <span class="keyword">return</span> fragment;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_fragment </tag>
            
            <tag> android_activity </tag>
            
            <tag> android_adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[代理相关]]></title>
      <url>https://ivyxjc.xyz/2016/07/06/%E6%95%88%E7%8E%87/2016-07-06-proxy/</url>
      <content type="html"><![CDATA[<h2 id="github使用代理"><a href="#github使用代理" class="headerlink" title="github使用代理"></a>github使用代理</h2><p>git添加代理：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy &apos;http://127.0.0.1:1080&apos;</span><br><span class="line">git config --global https.proxy &apos;http://127.0.0.1:1080&apos;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faq </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CriminalIntent程序中ListFragment相关内容]]></title>
      <url>https://ivyxjc.xyz/2016/07/06/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AndroidBigNerdRanceGuide/CriminalIntent%E5%BC%80%E5%8F%91/2016-07-06-CriminalIntent-ListFragment/</url>
      <content type="html"><![CDATA[<h2 id="定制adapter"><a href="#定制adapter" class="headerlink" title="定制adapter"></a>定制adapter</h2><p>adapter负责：</p>
<ol>
<li>创建必要的视图对象</li>
<li>用模型层数据填充视图对性爱那个</li>
<li>将准备好的视图对象返回给ListView</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">内部类</span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">CrimeAdapter</span> <span class="keyword">extends</span> <span class="title">ArrayAdapter</span>&lt;<span class="title">Crime</span>&gt;</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">CrimeAdapter</span><span class="params">(ArrayList&lt;Crime&gt; crimes)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(getActivity(),<span class="number">0</span>,crimes);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup parent)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(convertView==<span class="keyword">null</span>)&#123;</span><br><span class="line">                convertView=getActivity()</span><br><span class="line">                        .getLayoutInflater()</span><br><span class="line">                        .inflate(R.layout.list_item_crime,<span class="keyword">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Crime c=(Crime)(getListAdapter()).getItem(position);</span><br><span class="line"></span><br><span class="line">            TextView titleTextView=(TextView)convertView.findViewById(R.id.list_item_crime_title_TextView);</span><br><span class="line">            TextView dateTextView=(TextView)convertView.findViewById(R.id.list_item_crime_date_TextView);</span><br><span class="line">            CheckBox solvedCheckBox=(CheckBox)convertView.findViewById(R.id.list_item_crime_isSolved_CheckBox);</span><br><span class="line"></span><br><span class="line">            solvedCheckBox.setChecked(c.isSolved());</span><br><span class="line">            <span class="keyword">return</span> convertView;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>注： 由于CheckBox默认是可聚焦的，也就是点击列表向会被解读为切换CheckBox的状态，因而无法触发<code>onListItemClick()</code>方法。解决方法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">CheckBox</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/list_item_crime_isSolved_CheckBox"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentRight</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:focusable</span>=<span class="string">"false"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_adapter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[重装电脑时的设置问题]]></title>
      <url>https://ivyxjc.xyz/2016/07/03/%E6%95%88%E7%8E%87/2016-07-03-Reset-PC/</url>
      <content type="html"><![CDATA[<h2 id="调换Ctrl和Caps-Lock键"><a href="#调换Ctrl和Caps-Lock键" class="headerlink" title="调换Ctrl和Caps Lock键"></a>调换<code>Ctrl</code>和<code>Caps Lock</code>键</h2><p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout</code>中添加<code>Scancode Map</code>二进制项，内容为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0000 00 00 00 00 00 00 00 00</span><br><span class="line">0008 03 00 00 00 3A 00 1D 00</span><br><span class="line">0010 1D 00 3A 00 00 00 00 00</span><br></pre></td></tr></table></figure>
<h2 id="java环境设置"><a href="#java环境设置" class="headerlink" title="java环境设置"></a>java环境设置</h2><p>环境变量中添加<code>JAVA_HOME</code>:<code>C:\Program Files\Java\jdk1.8.0_91</code></p>
<p><code>Path</code>中添加<code>$JAVA_HOME$\jre\bin</code>和<code>$JAVA_HOME$\bin</code></p>
<h2 id="python环境变量设置"><a href="#python环境变量设置" class="headerlink" title="python环境变量设置"></a>python环境变量设置</h2><p><code>path</code>中添加<code>c:\python35</code></p>
<h2 id="jetbrains系列idea设置"><a href="#jetbrains系列idea设置" class="headerlink" title="jetbrains系列idea设置"></a>jetbrains系列idea设置</h2><p>更改程序主目录下<code>bin/idea.properties</code>中的内容</p>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faq </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[在Centos 6中升级python]]></title>
      <url>https://ivyxjc.xyz/2016/06/09/%E6%95%88%E7%8E%87/2016-06-09-update-python/</url>
      <content type="html"><![CDATA[<p>Centos默认的python使用的是<code>python2.6</code>,我常用的是<code>python3.5</code>,所以需要升级python.<br><a id="more"></a></p>
<p>安装过程:</p>
<ol>
<li>下载python3.5.1<br><code>wget https://www.python.org/ftp/python/3.5.1/Python-3.5.1.tgz</code></li>
<li>解压并安装<ol>
<li><code>tar zxvf Python-3.5.1.tgz</code></li>
<li><code>cd Python-3.5.1</code></li>
<li><code>./configure --prefix=/usr/local/python3.5</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ol>
</li>
<li>备份原有python命令执行文件<br><code>mv /usr/bin/python /usr/bin/pythonbak</code></li>
<li>创建新的python软连接<br><code>ln -s /usr/local/python3.5/bin/python3.5 /usr/bin/python</code></li>
</ol>
<p>问题:</p>
<ol>
<li><p>2.3步可能出现<code>no acceptable C compiler found in $PATH</code>问题,这是因为完整的安装<code>development tools</code>.<br> 解决方法:<code>yum groupinstall &quot;Development Tools&quot;</code></p>
</li>
<li><p>pip无法使用,出现<code>versionconflic</code>的问题,好像是因为pip版本的问题.进入pip的目录,删除pip.再直接下载上述错误信息中显示的<code>requirement.parse()</code>中的pip版本,解压缩,安装即可.</p>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faq </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Sunshine开发实战:架构(与官方原版有一些不同)]]></title>
      <url>https://ivyxjc.xyz/2016/06/03/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/Sunshine%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/2016-06-03-sunshine-build-custom/</url>
      <content type="html"><![CDATA[<h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h2><p>通过搜索按钮,进入搜索界面,进行搜索,返回搜索结果,选择,将地址存入数据库中.</p>
<h2 id="刷新"><a href="#刷新" class="headerlink" title="刷新"></a>刷新</h2><p>点击刷新按钮,联网获取数据,处理数据,若数据非null,存入数据库,从数据库中读取数据,刷新UI.</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Sunshine开发实战:测试]]></title>
      <url>https://ivyxjc.xyz/2016/06/03/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/Sunshine%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/2016-06-03-android-test/</url>
      <content type="html"><![CDATA[<h2 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPractice</span> <span class="keyword">extends</span> <span class="title">AndroidTestCase</span> </span>&#123;</span><br><span class="line">    <span class="comment">//测试前进行的工作</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setUp();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//所有测试的类必须以test开头</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testThatDemonstratesAssertations</span><span class="params">()</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">5</span>;</span><br><span class="line">        <span class="keyword">int</span> b=<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">int</span> c=<span class="number">5</span>;</span><br><span class="line">        <span class="keyword">int</span> d=<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        assertEquals(<span class="string">"X should be equal"</span>,a,c);</span><br><span class="line">        assertTrue(<span class="string">"Y should be true"</span>,d&gt;a);</span><br><span class="line">        assertFalse(<span class="string">"Z should be false"</span>,a==b);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//测试之后进行的工作</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.tearDown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后点击<code>run &#39;Tests in ...</code>即可.<br><img src="http://oezmbgg4j.bkt.clouddn.com/android_test_run.png" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_test </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Sunshine开发实战:数据持久化]]></title>
      <url>https://ivyxjc.xyz/2016/06/02/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/Sunshine%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/2016-06-02-data-persistence/</url>
      <content type="html"><![CDATA[<p>##　Sunshine应用数据存储总体框架<br><img src="http://oezmbgg4j.bkt.clouddn.com/sunshine_data_persistence.png" alt=""></p>
<h2 id="WeatherContract"><a href="#WeatherContract" class="headerlink" title="WeatherContract"></a>WeatherContract</h2><p>A contract is an agreement between the data model, storeage, and views, presentation, describing how information is accessed.<br>事实上就是在一个类中规定好所有相关的数据表中相应的表名,列名等等.</p>
<h2 id="WeatherDBHelper"><a href="#WeatherDBHelper" class="headerlink" title="WeatherDBHelper"></a>WeatherDBHelper</h2><p>创建数据库并进行初始化</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_data </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Activity的生命周期]]></title>
      <url>https://ivyxjc.xyz/2016/06/02/android/lifecycle/2016-06-02-lifecycle-basic/</url>
      <content type="html"><![CDATA[<p>Android中Activity的生命周期. <br><br><code>onCreate()</code>–&gt;<code>onStart()</code>–&gt;<code>onResume()</code>–&gt;<code>onPause()</code>–&gt;<code>onPause()</code>–&gt;<code>onDestory()</code><br><a id="more"></a></p>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><ol>
<li><code>onCreate()`</code></li>
<li><code>onStart()</code></li>
<li><code>onResume()</code></li>
<li><code>onPause()</code></li>
<li><code>onPause()</code></li>
<li><code>onDestory()</code></li>
</ol>
<h3 id="onCreate-的作用"><a href="#onCreate-的作用" class="headerlink" title="onCreate()的作用"></a><code>onCreate()</code>的作用</h3><ol>
<li>实例化组件并将组件放在屏幕上</li>
<li>引用已经实例化的组件</li>
<li>为组件设置监听器以处理用户交互</li>
<li>访问外部模型数据</li>
</ol>
<h2 id="翻转屏幕对生命周期的影响"><a href="#翻转屏幕对生命周期的影响" class="headerlink" title="翻转屏幕对生命周期的影响"></a>翻转屏幕对生命周期的影响</h2><p>翻转屏幕会导致<code>Activity</code>先会被销毁再重新创建，若不加以处理会导致很多意外的问题。顺序为<code>onPause()</code>,<code>onStop()</code>,<code>onDestory()</code>,<code>onCreate()</code>,<code>onStart()</code>,<code>onResume()</code></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_lifecycle </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[如何处理耗时操作(使用AsyncTask, AsyncAdapter)]]></title>
      <url>https://ivyxjc.xyz/2016/05/15/android/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/2016-05-15-async/</url>
      <content type="html"><![CDATA[<p>使用<code>AsyncTask</code>虽然可以非常简单将耗时操作与<code>UI线程</code>分开, 但是仍是耗时操作和<code>Activity</code>的生命周期绑定在了一起, 那么可能翻转屏幕就会使得该操作中断. 所以使用<code>Service</code>是更好的方法, <code>google</code>也给出了专用的解决方案, 使用<code>AsyncAdapter</code>.<br><a id="more"></a></p>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/async_1.png" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> concurrency </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Volley的介绍和一些相关用法]]></title>
      <url>https://ivyxjc.xyz/2016/05/13/android/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/2016-05-13-volley/</url>
      <content type="html"><![CDATA[<h2 id="Use-newRequestQueue和发送Request"><a href="#Use-newRequestQueue和发送Request" class="headerlink" title="Use newRequestQueue和发送Request"></a>Use newRequestQueue和发送Request</h2><p>使用<code>RequestQueue</code>并向其中传递<code>Request</code>对象可以.<code>RequestQueue</code>管理和网络操作相关的一些线程,b</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Instantiate the RequestQueue.</span></span><br><span class="line">RequestQueue queue = Volley.newRequestQueue(<span class="keyword">this</span>);</span><br><span class="line">String url =<span class="string">"http://www.google.com"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Request a string response from the provided URL.</span></span><br><span class="line">StringRequest stringRequest = <span class="keyword">new</span> StringRequest(Request.Method.GET, url,</span><br><span class="line">            <span class="keyword">new</span> Response.Listener&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResponse</span><span class="params">(String response)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Display the first 500 characters of the response string.</span></span><br><span class="line">        mTextView.setText(<span class="string">"Response is: "</span>+ response.substring(<span class="number">0</span>,<span class="number">500</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="keyword">new</span> Response.ErrorListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onErrorResponse</span><span class="params">(VolleyError error)</span> </span>&#123;</span><br><span class="line">        mTextView.setText(<span class="string">"That didn't work!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// Add the request to the RequestQueue.</span></span><br><span class="line">queue.add(stringRequest);</span><br></pre></td></tr></table></figure>
<h2 id="取消一个Request"><a href="#取消一个Request" class="headerlink" title="取消一个Request"></a>取消一个Request</h2><p>可以使用<code>cacel</code>方法取消一个Request,防止其总是在连接网络.</p>
<p>所以常在<code>onStop()</code>方法中调用<code>cancel</code>相关方法.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ublic static final String TAG = &quot;MyTag&quot;;</span><br><span class="line">StringRequest stringRequest; // Assume this exists.</span><br><span class="line">RequestQueue mRequestQueue;  // Assume this exists.</span><br><span class="line"></span><br><span class="line">// Set the tag on the request.</span><br><span class="line">stringRequest.setTag(TAG);</span><br><span class="line"></span><br><span class="line">// Add the request to the RequestQueue.</span><br><span class="line">mRequestQueue.add(stringRequest);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onStop</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onStop();</span><br><span class="line">    <span class="keyword">if</span> (mRequestQueue != <span class="keyword">null</span>) &#123;</span><br><span class="line">        mRequestQueue.cancelAll(TAG);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_lib </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[android编程中的一些常见问题和解决办法]]></title>
      <url>https://ivyxjc.xyz/2016/05/11/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/%E4%B8%AA%E4%BA%BA%E5%BC%80%E5%8F%91/2016-05-11-android-qa/</url>
      <content type="html"><![CDATA[<h3 id="1-如何解决有些函数只能接受String而无法接受Int"><a href="#1-如何解决有些函数只能接受String而无法接受Int" class="headerlink" title="1.如何解决有些函数只能接受String而无法接受Int"></a>1.如何解决有些函数只能接受<code>String</code>而无法接受<code>Int</code></h3><p>这样就无法使用<code>R.string...</code>.</p>
<p>解决方法:<br><br><code>getResources().getString(R.string.aaa))</code></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Service]]></title>
      <url>https://ivyxjc.xyz/2016/05/06/android/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6/2016-05-06-service-basic/</url>
      <content type="html"><![CDATA[<h2 id="服务的生命周期"><a href="#服务的生命周期" class="headerlink" title="服务的生命周期"></a>服务的生命周期</h2><p>使用startService()<br><br><img src="http://oezmbgg4j.bkt.clouddn.com/servicelifecycle.png" alt=""></p>
<p>一旦调用<code>startService()</code>相应的服务就会启动, 并回调<code>onStartCommand()</code>方法. 如果该服务没有创建过, 那么<code>onCreate()</code>会先于<code>onStartCommand()</code>方法执行. 服务启动之后会一直保持运行状态,知道<code>stopService()</code>或<code>stopSelf()</code>方法被调用. 即使度从此调用<code>startService()</code>方法, 每个服务只会存在一个实例,所以只需要调用一次<code>stopService()</code>或<code>stopSelf()</code>方法, 服务就会停止下来.</p>
<p>另一种方法，使用bindService()<br><br><img src="http://oezmbgg4j.bkt.clouddn.com/servicelifecycle2.png" alt=""></p>
<p>这会先回调服务中的<code>onBind()</code>方法,若该服务之前没有被创建过,那么<code>onCreate()</code>方法会先于<code>onBind()</code>方法执行.</p>
<p>注意: 若一个服务既<code>startService()</code>又<code>bindService()</code>, 那么只要<code>stopService()</code>和<code>unbindService()</code>都被调用后,服务的<code>onDestroy()</code>方法才会执行.</p>
<p>只能解绑定一次,不可以多次解绑定.</p>
<h2 id="两种方式的区别"><a href="#两种方式的区别" class="headerlink" title="两种方式的区别"></a>两种方式的区别</h2><p>Start方式特点:<br>1.服务与启动源没有任何关系<br>2.无法得到服务对象</p>
<p>Bind方式特点:<br>1.通过<code>IBinder</code>接口实例,返回一个<code>ServiceConnnection</code>对象给启动源.<br>2.通过<code>ServiceConnection</code>对象的相关方法可以得到<code>Service</code>对象.</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_service </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[数根]]></title>
      <url>https://ivyxjc.xyz/2016/04/26/algorithm/oj/LeetCode/2016-04-26-easy-add-digits/</url>
      <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>数根就是指将一个数的各位数字相加之后得到一个数字，若该数大于等于10则继续该运算所得到的那个数。</p>
<p>例如：<br>158 –》 1+5+8=14 –》 1+4=5</p>
<h2 id="O-n-解法"><a href="#O-n-解法" class="headerlink" title="O(n) 解法"></a>O(n) 解法</h2><p>就是按照树根的定义来做。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addDigits</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">while</span>(num&gt;=<span class="number">10</span>)&#123;</span><br><span class="line">       <span class="keyword">int</span> [] tmp=getDigits(num);</span><br><span class="line">       num=<span class="number">0</span>;</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tmp.length;i++)&#123;</span><br><span class="line">           num+=tmp[i];</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] getDigits(<span class="keyword">int</span> num)&#123;</span><br><span class="line">   <span class="keyword">int</span> tmp=num;</span><br><span class="line">   <span class="keyword">int</span> [] digits=<span class="keyword">new</span> <span class="keyword">int</span>[(<span class="keyword">int</span>)Math.log(num)];</span><br><span class="line">   <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">   <span class="keyword">while</span>(tmp!=<span class="number">0</span>)&#123;</span><br><span class="line">       digits[index]=tmp%<span class="number">10</span>;</span><br><span class="line">       tmp=tmp/<span class="number">10</span>;</span><br><span class="line">       index+=<span class="number">1</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> digits;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="O-1-解法"><a href="#O-1-解法" class="headerlink" title="O(1)解法"></a>O(1)解法</h2><p>树根有一些很巧妙的数学规律，使得该题可以在O(1)时间内完成。</p>
<p>例：</p>
<p>$12345=1<em>10000+2</em>1000+3<em>100+4</em>10+5*1$</p>
<p>$$=1<em>9999+2</em>999+3<em>99+4</em>9+5*0+(1+2+3+4+5)$$</p>
<p>我们发现一个数的各位数字之和和该数和9同余。</p>
<p>所以树根与原数也应该同余（当一个数为9的倍数时，树根即为9）、</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addDigits</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">9</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">9</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num%<span class="number">9</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> math </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[283 将0移到数组末尾]]></title>
      <url>https://ivyxjc.xyz/2016/04/26/algorithm/oj/LeetCode/2016-04-26-easy-move-zeroes/</url>
      <content type="html"><![CDATA[<p>将数组中的0移动数组尾部，其它数字顺序不变。<br>必须就地完成</p>
<h2 id="解法I（用时34ms）"><a href="#解法I（用时34ms）" class="headerlink" title="解法I（用时34ms）"></a>解法I（用时34ms）</h2><p>就是遍历数组，当一个数为0时，将该0和后面每一个数字都替换</p>
<p>用zeroFinalIndex作为一个flag,该数后面的数都为0，初始值为nums.length。每有一个数为0，zeroFinalIndex–</p>
<p>注意点：当有连续的0时，两个0替换，替换完成时nums[i]==0，此时i不应该+1.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveZeroes</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> zeroFinalIndex=nums.length;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]==<span class="number">0</span>&amp;&amp;i&lt;zeroFinalIndex)&#123;</span><br><span class="line">            <span class="keyword">int</span> j=i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(j&lt;zeroFinalIndex&amp;&amp;nums[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                i--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;zeroFinalIndex)&#123;</span><br><span class="line">                exch(nums,j-<span class="number">1</span>,j);</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            zeroFinalIndex--;</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="解法II（用时1ms）"><a href="#解法II（用时1ms）" class="headerlink" title="解法II（用时1ms）"></a>解法II（用时1ms）</h2><p>即将不为0的数字和第一个0交换，关键在于找到第一个0的位置 <code>zeroIndex</code>。</p>
<p>首先将<code>zeroIndex</code>设为0，即使该数不为0，也只是自己和自己交换，不影响结果。</p>
<p>当遇到一个数为0，此时<code>zeroIndex</code>等于该数的秩（即第一个0的秩序），等到<code>numsIndex</code>增加到一个不为0的数，和它交换。</p>
<p><code>zeroIndex</code>再+1仍是第一个0所在的位置。<br>因为若只有一个0，则<code>nusm[zeroIndex]</code>和<code>nums[numsIndex]</code>交换后，<code>zeroIndex</code>所在的数仍为0。</p>
<p>若有连续多个0，第一0交换后，<code>zeroIndex++</code>后仍为交换后第一个0所在的位置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">moveZeroesII</span><span class="params">(<span class="keyword">int</span> [] nums)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> zeroIndex=<span class="number">0</span>,numIndex=<span class="number">0</span>;numIndex&lt;nums.length;numIndex++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[numIndex]!=<span class="number">0</span>)&#123;</span><br><span class="line">            exch(nums,zeroIndex++,numIndex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> array </tag>
            
            <tag> twoPointer </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Maximum Depth of Binary Tree]]></title>
      <url>https://ivyxjc.xyz/2016/04/26/algorithm/oj/LeetCode/2016-04-26-easy-MaximunDepthofBinary/</url>
      <content type="html"><![CDATA[<h2 id="寻找二叉树最长路径"><a href="#寻找二叉树最长路径" class="headerlink" title="寻找二叉树最长路径"></a>寻找二叉树最长路径</h2><h3 id="递归的方法"><a href="#递归的方法" class="headerlink" title="递归的方法"></a>递归的方法</h3><p>1.节点为<code>null</code>时，返回深度为0<br>2.节点的左右子节点中有一个为<code>null</code>时，返回<code>1+maxDepth(root.left(or root.right))</code><br>3.若节点的左右子节点都不为<code>null</code>时，返回两者中大的那一个。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(root.left!=<span class="keyword">null</span>&amp;&amp; root.right!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> max(<span class="number">1</span>+maxDepth(root.left),<span class="number">1</span>+maxDepth(root.right));</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(root.left==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>+maxDepth(root.right);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>+maxDepth(root.left);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (a&gt;b?a:b);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> recursion </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[LeetCode SingleNum 136,127,260]]></title>
      <url>https://ivyxjc.xyz/2016/04/21/algorithm/oj/LeetCode/2016-04-21-medium-SingleNum/</url>
      <content type="html"><![CDATA[<p>这三题题意基本一样。<br>1.136 题：每个数字出现两遍，一个数字例外。找出这个数字。<br>2.137 题：每个数字出现三遍，一个数字例外。找出这个数字。<br>3.260 题：每个数字出现两遍，两个数字例外。找出这个数字。</p>
<h2 id="使用排序的方法"><a href="#使用排序的方法" class="headerlink" title="使用排序的方法"></a>使用排序的方法</h2><p>以136题为例：</p>
<p>这种方法先将给的数组<code>int[] num</code>排序，因为数字相同则会在一起，则只需要比较<code>num[i]</code>和<code>nums[i+1]</code>若不相同，则返回<code>num[i]</code>其中<code>i=i+2</code>。<br>特殊情况：<br>数字出现在最末尾。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    sort(nums);</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length-<span class="number">1</span>;)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]==nums[i+<span class="number">1</span>])&#123;</span><br><span class="line">            i+=<span class="number">2</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res=nums[i];</span><br><span class="line">            i+=<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> nums[nums.length-<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用位操作的方法"><a href="#使用位操作的方法" class="headerlink" title="使用位操作的方法"></a>使用位操作的方法</h2><h3 id="136题"><a href="#136题" class="headerlink" title="136题"></a>136题</h3><p>因为数字会出现两次，所以对所有数字取<strong>异或</strong>会使得最后的数字即所求的数字。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> diff=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i:nums)&#123;</span><br><span class="line">        diff=diff^i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res=diff;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="137题"><a href="#137题" class="headerlink" title="137题"></a>137题</h3><p>因为每个数字会重复三遍，所以统计32位中每一位上1出现的次数，若次数不为3的整数倍，则说明所求数字该位为1。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">singleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> [] count=<span class="keyword">new</span> <span class="keyword">int</span>[Integer.BYTES*<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;count.length;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;nums.length;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>((nums[j]&amp;tmp)!=<span class="number">0</span>)&#123;</span><br><span class="line">                count[i]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(count[i]%<span class="number">3</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">            res=res|tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="260题"><a href="#260题" class="headerlink" title="260题"></a>260题</h3><p>同样是先对所有数字取异或，因为有两个数字只出现了一次，所以最终的结果<code>diff</code>是这两个数字的异或值。</p>
<p>因为这两个数字不相同，所以这两个数字的二进制必定有某一位不相同。假设在<code>Xth</code>位上，一个数为0，另一个数为1。</p>
<p>那么把所有数字分为两类，一类是在<code>Xth</code>为0的，另一类是在<code>Xth</code>为1的。</p>
<p>关键是如何找到<code>Xth</code>位。方法时<code>diff ^=-diff</code>。<br>该式子会找出最右侧的两个数字不同的位置，并将该为置为1，其余位置为0。其实就是找<code>diff</code>中为1的最右边的位置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] singleNumber(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">    <span class="keyword">int</span> diff = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : nums) &#123;</span><br><span class="line">        diff ^= num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    diff &amp;= -diff;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] rets = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : nums)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">//将数字分为两类，一类为某一位为0，另一类为某一位为1</span></span><br><span class="line">        <span class="keyword">if</span> ((num &amp; diff) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            rets[<span class="number">0</span>] ^= num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            rets[<span class="number">1</span>] ^= num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> rets;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> quicksort </tag>
            
            <tag> sort </tag>
            
            <tag> bit manipulation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[LeetCode 343,122 整数拆分求积 递增区间寻找]]></title>
      <url>https://ivyxjc.xyz/2016/04/21/algorithm/oj/LeetCode/2016-04-21-medium-343-122/</url>
      <content type="html"><![CDATA[<h2 id="122-Best-Time-to-Buy-and-Sell-Stock-II"><a href="#122-Best-Time-to-Buy-and-Sell-Stock-II" class="headerlink" title="122 Best Time to Buy and Sell Stock II"></a>122 Best Time to Buy and Sell Stock II</h2><p>Say you have an array for which the ith element is the price of a given stock on day i.</p>
<p>Design an algorithm to find the maximum profit. You may complete as many transactions as you like (ie, buy one and sell one share of the stock multiple times). However, you may not engage in multiple transactions at the same time (ie, you must sell the stock before you buy again).</p>
<p>已知物品每天的价格，讨论通过买卖可以赚到的最多利润。卖之前必须买，再一次买之前必须卖掉。</p>
<p>寻找所有递增区间，区间尾头之差即单次利润。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span>[] prices)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> maxProfit=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;prices.length;)&#123;</span><br><span class="line">        <span class="keyword">int</span> plus=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> flag=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (i+plus&lt;prices.length&amp;&amp;prices[i+plus-<span class="number">1</span>]&lt;prices[i+plus])&#123;</span><br><span class="line">            plus+=<span class="number">1</span>;</span><br><span class="line">            flag=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">1</span>)&#123;</span><br><span class="line">            maxProfit+=prices[i+plus-<span class="number">1</span>]-prices[i];</span><br><span class="line">        &#125;</span><br><span class="line">        i+=plus;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxProfit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="343-Integer-Break"><a href="#343-Integer-Break" class="headerlink" title="343 Integer Break"></a>343 Integer Break</h2><p>给一个自然数n，把它拆分为若干个数的和，记这若干个数的乘积为M，求M的最大值。</p>
<p>方法：尽可能将这个数拆分成3，原因下方解释。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">integerBreak</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">3</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">4</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mod=n%<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">    res=(<span class="keyword">int</span>)Math.pow(<span class="number">3</span>,n/<span class="number">3</span>);</span><br><span class="line">    System.out.println(res);</span><br><span class="line">    <span class="keyword">if</span>(mod==<span class="number">1</span>)&#123;</span><br><span class="line">        res=res/<span class="number">3</span>*<span class="number">4</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(mod==<span class="number">2</span>)&#123;</span><br><span class="line">        res=res*<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>因为有不等式<br>$$\sqrt[k]{x_1x_2x_3x_4…x_k}\leq \frac{x_1x_2x_3x_4…x_k}{k}$$</p>
<p>设$$$n=x_1+x_2+x_3+x_4+x_5+…+x_k$$$，$$$P=x_1x_2x_3x_4x_5+…x_k$$$。</p>
<p>所以有$$$P \leq (\frac{n}{k})^k$$$</p>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> oj </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Handler与多线程]]></title>
      <url>https://ivyxjc.xyz/2016/04/05/android/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/2016-04-05-handler-threads/</url>
      <content type="html"><![CDATA[<p>Handler是android中一套用来更新UI的机制，也是一套消息处理机制。</p>
<p>在非UI线程中更新UI会报错，但是直接在OnCreate()方法中并不会报错，因为此时检查机制还未使用，但是不要这么做。必须在UI线程中更新UI。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mHandler.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mTextView.setText(<span class="string">"update thread"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="sendMessage-和removeCallbacks"><a href="#sendMessage-和removeCallbacks" class="headerlink" title="sendMessage()和removeCallbacks()"></a>sendMessage()和removeCallbacks()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Handler mHandler=<span class="keyword">new</span> Handler()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        mTextView.setText(<span class="string">""</span>+msg.arg1+msg.obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">new</span> Thread()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>);</span><br><span class="line"><span class="comment">//          Message message=new Message();</span></span><br><span class="line">            Message message=mHandler.obtainMessage();</span><br><span class="line">            Person person=<span class="keyword">new</span> Person();</span><br><span class="line">            message.arg1=<span class="number">100</span>;</span><br><span class="line">            person.age=<span class="number">10</span>;</span><br><span class="line">            person.name=<span class="string">"aaa"</span>;</span><br><span class="line">            message.obj=person;</span><br><span class="line">            message.sendToTarget();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;.start();</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mHandler.removeCallbacks(mMyRunnable);</span><br></pre></td></tr></table></figure>
<h3 id="消息截获"><a href="#消息截获" class="headerlink" title="消息截获"></a>消息截获</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Handler mHandler=<span class="keyword">new</span> Handler(<span class="keyword">new</span> Handler.Callback() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(getApplicationContext(),<span class="string">""</span>+<span class="number">1</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">        <span class="comment">//若返回true，则下面的handleMessage不会执行，表示别截获</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line"><span class="comment">//            mTextView.setText(""+msg.arg1+msg.obj);</span></span><br><span class="line">        Toast.makeText(getApplicationContext(),<span class="string">""</span>+<span class="number">2</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="handler总结"><a href="#handler总结" class="headerlink" title="handler总结"></a>handler总结</h2><p><code>handler</code>负责发送消息，<code>Looper</code>负责接收Handler发送的消息，并将消息发给<code>handler</code>自己。</p>
<h3 id="使用Handler更新UI的原因"><a href="#使用Handler更新UI的原因" class="headerlink" title="使用Handler更新UI的原因"></a>使用Handler更新UI的原因</h3><p>如果在一个<code>Activity</code>中有多个线程去更新UI，若都没有加锁会导致<strong>界面更新混乱</strong>。若都加锁，则会导致<strong>性能下降</strong>。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> concurrency </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[虚拟机环境搭建python以及相关问题解决]]></title>
      <url>https://ivyxjc.xyz/2016/04/01/%E6%95%88%E7%8E%87/2016-04-01-Linux-python-env-tips/</url>
      <content type="html"><![CDATA[<h2 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove pip</span><br><span class="line">wget .../get-pip.py</span><br><span class="line">python get-pip.py</span><br></pre></td></tr></table></figure>
<h2 id="安装scrapy"><a href="#安装scrapy" class="headerlink" title="安装scrapy"></a>安装scrapy</h2><p>安装scrapy出现<code>Python.h No such file...</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-dev</span><br></pre></td></tr></table></figure>
<p>若出现<code>failed to build wheel for Cryptography</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libssl-dev libffi-dev python-dev</span><br></pre></td></tr></table></figure>
<h2 id="安装pycharm"><a href="#安装pycharm" class="headerlink" title="安装pycharm"></a>安装pycharm</h2><p>进入pycharm文件内</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./pycharm.sh</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /usr/share/applications/Pycharm.desktop</span><br><span class="line">然后输入</span><br><span class="line">[Desktop Entry]</span><br><span class="line">Type=Application</span><br><span class="line">Name=Pycharm</span><br><span class="line">GenericName=Pycharm3</span><br><span class="line">Comment=Pycharm3:The Python IDE</span><br><span class="line">Exec=&quot;/XXX/pycharm-community-3.4.1/bin/pycharm.sh&quot; %f</span><br><span class="line">Icon=/XXX/pycharm-community-3.4.1/bin/pycharm.png</span><br><span class="line">Terminal=pycharm</span><br><span class="line">Categories=Pycharm;</span><br></pre></td></tr></table></figure>
<p>然后进入<code>/usr/share/applications/</code>双击打开即可。</p>
<h2 id="VMware和主机共享文件夹"><a href="#VMware和主机共享文件夹" class="headerlink" title="VMware和主机共享文件夹"></a>VMware和主机共享文件夹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install open-vm-tools-dkms</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gksu gedit/etc/fstab</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> 效率 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> faq </tag>
            
            <tag> spider </tag>
            
            <tag> bs4 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Scrapy入门]]></title>
      <url>https://ivyxjc.xyz/2016/03/31/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-03-31-scrapy/</url>
      <content type="html"><![CDATA[<h2 id="creating-a-project"><a href="#creating-a-project" class="headerlink" title="creating a project"></a>creating a project</h2><p>run <code>scrapy startproject tutorial</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---scrapy.cfg</span><br><span class="line">---tutorial/</span><br><span class="line">-------__init__.py</span><br><span class="line">-------items.py</span><br><span class="line">-------pipelines.py</span><br><span class="line">-------settring.py</span><br><span class="line">-------spiders/</span><br><span class="line">-----------__init__.py</span><br></pre></td></tr></table></figure>
<h2 id="items-py"><a href="#items-py" class="headerlink" title="items.py"></a>items.py</h2><p><code>Items</code> are containers that will be loaded with the scraped data;like simple python dicts.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DmozItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    title = scrapy.Field()</span><br><span class="line">    link = scrapy.Field()</span><br><span class="line">    desc = scrapy.Field()</span><br></pre></td></tr></table></figure>
<h2 id="第一个spider"><a href="#第一个spider" class="headerlink" title="第一个spider"></a>第一个spider</h2><p>四个步骤：<br> 1.创建一个Scrapy项目<br> 2.定义Item容器<br> 3.编写爬虫<br> 4.存储内容</p>
<p>创建一个Spider，必须继承scrapy.Spider类。且自定义一些属性：<br> 1.<code>name</code>:用于区别Spider，必须是唯一的。<br> 2.<code>start_urls</code>:<br> 3.<code>parse()</code>:个初始URL完成下载后生成的<code>Response</code> 对象将会作为唯一的参数传递给该函数。 该方法负责解析返回的数据(response data)，提取数据(生成item)以及生成需要进一步处理的URL的<code>Request</code>对象。</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> bs4 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python文件处理]]></title>
      <url>https://ivyxjc.xyz/2016/03/29/python/os/2016-03-29-python-os/</url>
      <content type="html"><![CDATA[<h2 id="遍历文件夹下所有的文件"><a href="#遍历文件夹下所有的文件" class="headerlink" title="遍历文件夹下所有的文件"></a>遍历文件夹下所有的文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.listdir(path)</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> regex </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[BeautifulSoup4入门]]></title>
      <url>https://ivyxjc.xyz/2016/03/29/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-03-29-beautiful-soup4-basic/</url>
      <content type="html"><![CDATA[<h2 id="对象的种类"><a href="#对象的种类" class="headerlink" title="对象的种类"></a>对象的种类</h2><p>BeautifulSoup会将HTML文档抓换成一个树形结构, 每个节点都是Python对象，所有对象可以分为4类：<code>Tag</code>,<code>NavigableString</code>,<code>BeautifulSoup</code>,<code>Comment</code>。</p>
<h3 id="Tag"><a href="#Tag" class="headerlink" title="Tag"></a>Tag</h3><p><code>Tag</code>与XML或HTML中的tag相同：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(&apos;&lt;b class=&quot;boldest&quot;&gt;Extremely bold&lt;/b&gt;&apos;)</span><br><span class="line">tag = soup.b</span><br><span class="line">print(type(tag))</span><br><span class="line">print(tag)</span><br><span class="line"></span><br><span class="line">--&lt;class &apos;bs4.element.Tag&apos;&gt;</span><br><span class="line">--&lt;b class=&quot;boldest&quot;&gt;Extremely bold&lt;/b&gt;</span><br></pre></td></tr></table></figure>
<h4 id="name"><a href="#name" class="headerlink" title="name"></a>name</h4><p>每一个Tag都有自己的name，可以通过<code>.name</code>。改变tag的name，将会影响通过当前BS对象生成的HTML文档</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(&apos;&lt;b class=&quot;boldest&quot;&gt;Extremely bold&lt;/b&gt;&apos;,&quot;html.parser&quot;)</span><br><span class="line">tag = soup.b</span><br><span class="line">print(tag)</span><br><span class="line">print(tag.name)</span><br><span class="line">tag.name=&quot;blockquote&quot;</span><br><span class="line">print(tag)</span><br><span class="line"></span><br><span class="line">---&lt;b class=&quot;boldest&quot;&gt;Extremely bold&lt;/b&gt;</span><br><span class="line">---b</span><br><span class="line">---&lt;blockquote class=&quot;boldest&quot;&gt;Extremely bold&lt;/blockquote&gt;</span><br></pre></td></tr></table></figure>
<h4 id="attributes"><a href="#attributes" class="headerlink" title="attributes"></a>attributes</h4><p>一个tag可能有多个属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(&apos;&lt;b class=&quot;boldest&quot;&gt;Extremely bold&lt;/b&gt;&apos;,&quot;html.parser&quot;)</span><br><span class="line">tag = soup.b</span><br><span class="line">print(tag[&apos;class&apos;])</span><br><span class="line">print(tag.attrs)</span><br><span class="line"></span><br><span class="line">---[&apos;boldest&apos;]</span><br><span class="line">---&#123;&apos;class&apos;: [&apos;boldest&apos;]&#125;</span><br></pre></td></tr></table></figure>
<p>tag的属性可以被添加，删除或修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(<span class="string">'&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;'</span>,<span class="string">"html.parser"</span>)</span><br><span class="line">tag = soup.b</span><br><span class="line"><span class="comment">#更改属性</span></span><br><span class="line">tag[<span class="string">'class'</span>]=<span class="string">"verybold"</span></span><br><span class="line">tag[<span class="string">'id'</span>]=<span class="number">1</span></span><br><span class="line">print(tag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除属性</span></span><br><span class="line"><span class="keyword">del</span> tag[<span class="string">'class'</span>]</span><br><span class="line">print(tag)</span><br><span class="line">print(tag.get(<span class="string">'class'</span>))</span><br><span class="line"></span><br><span class="line">---&lt;b class="verybold" id="1"&gt;Extremely bold&lt;/b&gt;</span><br><span class="line">---&lt;b id="1"&gt;Extremely bold&lt;/b&gt;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<h5 id="多值属性"><a href="#多值属性" class="headerlink" title="多值属性"></a>多值属性</h5><p>多值属性即为可包含多个值的属性，最常见的即为<code>class</code><br><code>xml</code>中没有多值属性</p>
<p>多值属性的返回类型是list</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">css_soup = BeautifulSoup(<span class="string">'&lt;p class="body strikeout"&gt;&lt;/p&gt;'</span>,<span class="string">"html.parser"</span>)</span><br><span class="line">print(css_soup.p[<span class="string">'class'</span>])</span><br><span class="line"></span><br><span class="line">---[<span class="string">'body'</span>, <span class="string">'strikeout'</span>]</span><br></pre></td></tr></table></figure>
<p>若某个属性看起来像多值属性，但是在任何版本HTML中都没有被定义为多值属性，那么BS会将这个属性作为字符串返回</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id_soup = BeautifulSoup(<span class="string">'&lt;p id="my id"&gt;&lt;/p&gt;'</span>,<span class="string">"html.parser"</span>)</span><br><span class="line">print(id_soup.p[<span class="string">'id'</span>])</span><br><span class="line"></span><br><span class="line">---my id</span><br></pre></td></tr></table></figure>
<h3 id="NavigableString"><a href="#NavigableString" class="headerlink" title="NavigableString"></a>NavigableString</h3><p><code>NavigableString</code>不支持<code>.content</code>,<code>.string</code>,<code>find()</code>方法。</p>
<p>如果想在Beautiful Soup之外使用<code>NavigableString</code>对象,需要调用<code>unicode()</code>方法,将该对象转换成普通的Unicode字符串,否则就算Beautiful Soup已方法已经执行结束,该对象的输出也会带有对象的引用地址.这样会浪费内存.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(<span class="string">'&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;'</span>,<span class="string">"html.parser"</span>)</span><br><span class="line">tag = soup.b</span><br><span class="line">print(tag.string)</span><br><span class="line">print(type(tag.string))</span><br><span class="line">tag.string.replace_with(<span class="string">"No long bold"</span>)</span><br><span class="line">print(tag)</span><br><span class="line"></span><br><span class="line">---Extremely bold</span><br><span class="line">---&lt;<span class="class"><span class="keyword">class</span> '<span class="title">bs4</span>.<span class="title">element</span>.<span class="title">NavigableString</span>'&gt;</span></span><br><span class="line">---&lt;b class="boldest"&gt;No long bold&lt;/b&gt;</span><br></pre></td></tr></table></figure>
<h2 id="BeautifulSoup"><a href="#BeautifulSoup" class="headerlink" title="BeautifulSoup"></a>BeautifulSoup</h2><p><code>BeautifulSoup</code>对象表示的是一个文档的全部内容.大部分时候,可以把它当作 Tag 对象,它支持 遍历文档树 和 搜索文档树 中描述的大部分的方法.</p>
<p><code>BeautifuSoup</code>没有name和attribute属性。但有一个值为<code>[document]</code>的特殊属性<code>.name</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">soup = BeautifulSoup(<span class="string">'&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;'</span>,<span class="string">"html.parser"</span>)</span><br><span class="line">print(soup.name)</span><br><span class="line"></span><br><span class="line">---[document]</span><br></pre></td></tr></table></figure>
<h3 id="Comment"><a href="#Comment" class="headerlink" title="Comment"></a>Comment</h3><h2 id="遍历文档树"><a href="#遍历文档树" class="headerlink" title="遍历文档树"></a>遍历文档树</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">html_doc = &quot;&quot;&quot;</span><br><span class="line">&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse&apos;s story&lt;/title&gt;&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;p class=&quot;title&quot;&gt;&lt;b&gt;The Dormouse&apos;s story&lt;/b&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p class=&quot;story&quot;&gt;Once upon a time there were three little sisters; and their names were</span><br><span class="line">&lt;a href=&quot;http://example.com/elsie&quot; class=&quot;sister&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,</span><br><span class="line">&lt;a href=&quot;http://example.com/lacie&quot; class=&quot;sister&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt; and</span><br><span class="line">&lt;a href=&quot;http://example.com/tillie&quot; class=&quot;sister&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;;</span><br><span class="line">and they lived at the bottom of a well.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>
<h3 id="content和-children"><a href="#content和-children" class="headerlink" title=".content和.children"></a><code>.content</code>和<code>.children</code></h3><p>tag的<code>.contents</code>属性可以将tag的子节点以列表的方式输出:<br>通过tag的<code>.children</code>生成器,可以对tag的子节点进行循环:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(soup.title.contents)</span><br><span class="line">print(soup.title.contents[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">---[<span class="string">"The Dormouse's story"</span>]</span><br><span class="line">---The Dormouse<span class="string">'s story</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> soup.head.children:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">---&lt;title&gt;The Dormouse<span class="string">'s story&lt;/title&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="descendants"><a href="#descendants" class="headerlink" title=".descendants"></a><code>.descendants</code></h3><p><code>.descendants</code>属性可以对所有tag的子孙节点进行递归循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(soup.head.contents)</span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> soup.head.descendants:</span><br><span class="line">    print(child)</span><br><span class="line"></span><br><span class="line">print(len(list(soup.children)))</span><br><span class="line">print(len(list(soup.descendants)))</span><br><span class="line"></span><br><span class="line">---[&lt;title&gt;The Dormouse<span class="string">'s story&lt;/title&gt;]</span></span><br><span class="line">---&lt;title&gt;The Dormouse's story&lt;/title&gt;</span><br><span class="line">---The Dormouse<span class="string">'s story</span></span><br><span class="line"><span class="string">---2</span></span><br><span class="line"><span class="string">---25</span></span><br></pre></td></tr></table></figure>
<h3 id="string"><a href="#string" class="headerlink" title=".string"></a><code>.string</code></h3><p>如果tag只有一个<code>NavigableString</code>类型子节点,那么这个tag可以使用<code>.string</code>得到子节点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(soup.head.string)</span><br><span class="line"></span><br><span class="line">---The Dormouse<span class="string">'s story</span></span><br></pre></td></tr></table></figure>
<h3 id="strings和stripped-strings"><a href="#strings和stripped-strings" class="headerlink" title=".strings和stripped_strings"></a><code>.strings</code>和<code>stripped_strings</code></h3><p>如果tag中有多个字符串，可以使用<code>.strings</code>循环获取<br>使用<code>.stripped_strings</code>可以去除多余空白内容：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> string <span class="keyword">in</span> soup.stripped_strings:</span><br><span class="line">    print(repr(string))</span><br></pre></td></tr></table></figure>
<h3 id="parent和-parents"><a href="#parent和-parents" class="headerlink" title=".parent和.parents"></a><code>.parent</code>和<code>.parents</code></h3><p>通过<code>.parent</code>属性来获取某个元素的父节点<br>通过元素的<code>.parents</code>属性可以递归得到元素的所有父辈节点。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> parent <span class="keyword">in</span> soup.a.parents:</span><br><span class="line">    <span class="keyword">if</span> parent <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        print(parent)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(parent.name)</span><br><span class="line"></span><br><span class="line">---p</span><br><span class="line">---html</span><br><span class="line">---[document]</span><br></pre></td></tr></table></figure>
<h3 id="兄弟节点"><a href="#兄弟节点" class="headerlink" title="兄弟节点"></a>兄弟节点</h3><h4 id="next-sibling和-previous-sibling"><a href="#next-sibling和-previous-sibling" class="headerlink" title=".next_sibling和.previous_sibling"></a><code>.next_sibling</code>和<code>.previous_sibling</code></h4><p>使用<code>。next_sibling</code>和<code>.previous_sibling</code>属性来查询兄弟节点</p>
<p>实际文档中的tag的 .next_sibling 和 .previous_sibling 属性通常是字符串或空白。因为中间可能会隔着一些字符以及标点。</p>
<h4 id="next-siblings和-previous-siblings"><a href="#next-siblings和-previous-siblings" class="headerlink" title=".next_siblings和.previous_siblings"></a><code>.next_siblings</code>和<code>.previous_siblings</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for sibling in soup.a.next_siblings:</span><br><span class="line">    print(repr(sibling))</span><br><span class="line"></span><br><span class="line">---&apos;,\n&apos;</span><br><span class="line">---&lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;</span><br><span class="line">---&apos; and\n&apos;</span><br><span class="line">---&lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;</span><br><span class="line">&apos;;\nand they lived at the bottom of a well.&apos;</span><br></pre></td></tr></table></figure>
<h3 id="重现解析过程"><a href="#重现解析过程" class="headerlink" title="重现解析过程"></a>重现解析过程</h3><h4 id="next-element和-previous-element"><a href="#next-element和-previous-element" class="headerlink" title=".next_element和.previous_element"></a><code>.next_element</code>和<code>.previous_element</code></h4><p><code>next_element</code>属性指向解析过程中下一个被解析的对象(字符串或tag),结果可能与<code>.next_sibling</code>相同,但通常是不一样的.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">last_a_tag=soup.find(<span class="string">"a"</span>,id=<span class="string">"link3"</span>)</span><br><span class="line">print(last_a_tag)</span><br><span class="line">print(last_a_tag.next_sibling)</span><br><span class="line">print(last_a_tag.next_element)</span><br><span class="line"></span><br><span class="line">---&lt;a class="sister" href="http://example.com/tillie" id="link3"&gt;Tillie&lt;/a&gt;</span><br><span class="line">---;</span><br><span class="line">---<span class="keyword">and</span> they lived at the bottom of a well.</span><br><span class="line">---Tillie</span><br></pre></td></tr></table></figure>
<h4 id="next-elements和-previous-elements"><a href="#next-elements和-previous-elements" class="headerlink" title=".next_elements和.previous_elements"></a><code>.next_elements</code>和<code>.previous_elements</code></h4><h2 id="搜索文档树"><a href="#搜索文档树" class="headerlink" title="搜索文档树"></a>搜索文档树</h2><h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> tag <span class="keyword">in</span> soup.find_all(re.compile(<span class="string">"^b"</span>)):</span><br><span class="line">    print(tag.name)</span><br></pre></td></tr></table></figure>
<h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><p>如果传入列表参数,Beautiful Soup会将与列表中任一元素匹配的内容返回.</p>
<h4 id="True"><a href="#True" class="headerlink" title="True"></a>True</h4><p>True可以匹配任何值,但是不会返回字符串节点</p>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>如果没有合适过滤器,那么还可以定义一个方法,方法只接受一个元素参数,如果这个方法返回True表示当前元素匹配并且被找到,如果不是则反回False。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def has_class_but_no_id(tag):</span><br><span class="line">    return tag.has_attr(&apos;class&apos;) and not tag.has_attr(&apos;id&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="find-all"><a href="#find-all" class="headerlink" title="find_all()"></a>find_all()</h3><h4 id="name参数"><a href="#name参数" class="headerlink" title="name参数"></a>name参数</h4><h4 id="keyword参数"><a href="#keyword参数" class="headerlink" title="keyword参数"></a>keyword参数</h4><p><code>soup.find_all(id=&#39;link2&#39;)</code></p>
<h4 id="按CSS搜索"><a href="#按CSS搜索" class="headerlink" title="按CSS搜索"></a>按CSS搜索</h4><p>因为<code>class</code>是python保留字，所以用<code>class_</code><br>例：<br><code>soup.find_all(&quot;a&quot;,class_=&quot;sister&quot;)</code></p>
<p><code>class_</code>参数同样接受不同类型的过滤器 ,字符串,正则表达式,方法或 True :</p>
<p>tag的<code>class</code>属性是 多值属性 .按照CSS类名搜索tag时,可以分别搜索tag中的每个CSS类名:</p>
<h4 id="text参数"><a href="#text参数" class="headerlink" title="text参数"></a>text参数</h4><p>通过<code>text</code>参数可以搜搜文档中的字符串内容.</p>
<h4 id="limit参数"><a href="#limit参数" class="headerlink" title="limit参数"></a>limit参数</h4><p><code>limit</code>参数限制返回结果的数量</p>
<h4 id="recursive参数"><a href="#recursive参数" class="headerlink" title="recursive参数"></a>recursive参数</h4><p>调用tag的<code>find_all()</code>方法时,Beautiful Soup会检索当前tag的所有子孙节点,如果只想搜索tag的直接子节点,可以使用参数 <code>recursive=False</code>.</p>
<h4 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">soup.find_all(&quot;a&quot;)</span><br><span class="line">soup(&quot;a&quot;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">soup.title.find_all(text=True)</span><br><span class="line">soup.title(text=True)</span><br></pre></td></tr></table></figure>
<h3 id="find"><a href="#find" class="headerlink" title="find()"></a>find()</h3><p>只返回一个结果</p>
<h3 id="find-parents-和find-parent"><a href="#find-parents-和find-parent" class="headerlink" title="find_parents()和find_parent()"></a><code>find_parents()</code>和<code>find_parent()</code></h3><h3 id="find-next-siblings-和find-next-sibling"><a href="#find-next-siblings-和find-next-sibling" class="headerlink" title="find_next_siblings()和find_next_sibling()`"></a><code>find_next_siblings()和</code>find_next_sibling()`</h3><h3 id="find-all-next-和find-next"><a href="#find-all-next-和find-next" class="headerlink" title="find_all_next()和find_next()"></a><code>find_all_next()</code>和<code>find_next()</code></h3><h3 id="find-all-previous-和find-previous"><a href="#find-all-previous-和find-previous" class="headerlink" title="find_all_previous()和find_previous()"></a><code>find_all_previous()</code>和<code>find_previous()</code></h3><h3 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h3><p>在Tag或BeautifulSoup对象的<code>.select()</code>方法中传入字符串参数,即可使用CSS选择器的语法找到tag:</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> bs4 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[正则表达式（python）]]></title>
      <url>https://ivyxjc.xyz/2016/03/27/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-03-27-regex/</url>
      <content type="html"><![CDATA[<h2 id="re方法"><a href="#re方法" class="headerlink" title="re方法"></a>re方法</h2><h3 id="re-search"><a href="#re-search" class="headerlink" title="re.search()"></a>re.search()</h3><p><code>re.search(pattern,string,flags=0)</code><br>例：<code>re.search(r&#39;love&#39;,&#39;I love you&#39;)</code></p>
<h3 id="re-findall"><a href="#re-findall" class="headerlink" title="re.findall()"></a>re.findall()</h3><p>返回一个符合pattern的全部字符的list。</p>
<h3 id="re-compile"><a href="#re-compile" class="headerlink" title="re.compile()"></a>re.compile()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p=re.compile(<span class="string">r'[a-z]'</span>)</span><br><span class="line">res=re.findall(p,<span class="string">'iLadfaww'</span>)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">[<span class="string">'i'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>, <span class="string">'f'</span>, <span class="string">'a'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p=re.compile(<span class="string">r'[a-z]+'</span>,re.IGNORECASE)</span><br><span class="line">res=p.search(<span class="string">'ADSwqefS'</span>,<span class="number">2</span>,<span class="number">5</span>)<span class="comment">#后两个参数表示范围</span></span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">2</span>, <span class="number">5</span>), match=<span class="string">'Swq'</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p=re.compile(<span class="string">r'(Love) (You)'</span>)</span><br><span class="line">res=p.search(<span class="string">'I Love You'</span>)</span><br><span class="line">print(res.group(<span class="number">0</span>))</span><br><span class="line">print(res.group(<span class="number">1</span>))</span><br><span class="line">print(res.group(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">print(res.start())</span><br><span class="line">print(res.end())</span><br><span class="line">print(res.span())</span><br><span class="line"></span><br><span class="line">Love You</span><br><span class="line">Love</span><br><span class="line">You</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<h2 id="编译标志"><a href="#编译标志" class="headerlink" title="编译标志"></a>编译标志</h2><p><a href="http://bbs.fishc.com/forum.php?mod=viewthread&amp;tid=57207&amp;extra=page%3D1%26filter%3Dtypeid%26typeid%3D403" target="_blank" rel="noopener">编译标志</a></p>
<p>编译标志有两个名字：完整名和简写名</p>
<p>1.ASCII,A：使得<code>\w</code>,<code>\b</code>,<code>\s</code>和<code>\d</code>只能匹配ASCII字符<br>2.DOTALL,S：使得<code>.</code>匹配任何符号，包括换行符<br>3.IGNORECASE,I：不区分大小写<br>4.LOCALE,L：支持当前的语言，区域设置<br>5.MULTILINE,M：多行匹配，影响<code>^</code>和<code>$</code><br>6.VERBOSE,X ：启用详细的正则表达式</p>
<h2 id="正则Pattern"><a href="#正则Pattern" class="headerlink" title="正则Pattern"></a>正则Pattern</h2><p><a href="http://bbs.fishc.com/forum.php?mod=viewthread&amp;tid=57691&amp;extra=page%3D1%26filter%3Dtypeid%26typeid%3D403" target="_blank" rel="noopener">Python3正则表达式特殊符号及用法</a></p>
<p><code>\d</code>：匹配数字<br><code>\D</code>:与<code>\d</code>相反，相当于<code>[^0-9]</code></p>
<p><code>\s</code>：匹配任何空白字符（包含空格，换行符，制表符等），相当于<code>[\t\n\r\f\v]</code><br><code>\S</code>：与上相反</p>
<p><code>\w</code>匹配任何单词字符<br><code>\W</code>与上相反</p>
<p><code>\b</code>匹配单词的开始或者结束。<code>\b</code>在字符类中可表示空格<br><code>\B</code>与上相反</p>
<p><code>.</code>：匹配除换行符以外的任何字符</p>
<p><code>|</code>：或</p>
<p><code>*</code>:匹配前面的表达式0次或者而多次=={0,}<br><code>+</code>:匹配前面的表达式1次或者多次=={1,}<br><code>?</code>:匹配前面的表达式0次或者1次=={0,1}</p>
<p><code>\</code>:<br>1.转义字符<br>2.类似于<code>\d</code>这种用途<br>3.引用序号对应的子组所对应的字符串(两位数)<br><code>r&#39;(ABC)(.com)\2&#39;匹配的就是&#39;ABC.com.com’</code><br>4.(三位数，首位可为0)表示八进制数所代表的ASCII码</p>
<p><code>[..]</code>:字符类，匹配所包含的任意一个字符</p>
<p><code>^</code>:<br>1.匹配字符串的开始位置<br>2.如果设置了re.MULTILINE标志，则表示换行符之后的位置<br>3.<code>[^..]</code>取反，只能放在最开头。若不在最开头，则表示<code>^</code>本身。</p>
<p><code>%</code>：<br>1.匹配字符串的结束位置，<br>2.如果设置了re.MULTILINE标志，则表示换行符之前的位置</p>
<p><code>{M,N}</code>：匹配前面的内容M~N次</p>
<p><code>[a-z]</code>：匹配a-z</p>
<p><code>ab{3}z</code>:匹配abbbc</p>
<p><code>ab{3,10}c</code>：匹配a(3-10个)bc</p>
<h2 id="零宽断言"><a href="#零宽断言" class="headerlink" title="零宽断言"></a>零宽断言</h2><p><code>\b</code> <code>^</code> <code>$</code> <code>\A</code> <code>\Z</code> 等用于指定位置，这个位置应满足的一定的条件（即断言），称为零宽断言。</p>
<h3 id="前向肯定断言"><a href="#前向肯定断言" class="headerlink" title="前向肯定断言"></a>前向肯定断言</h3><p><code>(?=exp)</code></p>
<p>例<code>abc(?=.com)</code>只会匹配后面紧跟着<code>.com</code>的<code>abc</code></p>
<h3 id="前向否定断言"><a href="#前向否定断言" class="headerlink" title="前向否定断言"></a>前向否定断言</h3><p><code>(?!exp)</code></p>
<h3 id="后向肯定断言"><a href="#后向肯定断言" class="headerlink" title="后向肯定断言"></a>后向肯定断言</h3><p><code>(?&lt;=exp)</code></p>
<p>例：<code>(?&lt;=abc).com</code>只会匹配前面为<code>abc</code>的<code>.com</code></p>
<h3 id="后向否定断言"><a href="#后向否定断言" class="headerlink" title="后向否定断言"></a>后向否定断言</h3><p><code>(?&lt;!exp)</code></p>
<h2 id="贪婪与非贪婪"><a href="#贪婪与非贪婪" class="headerlink" title="贪婪与非贪婪"></a>贪婪与非贪婪</h2><p>默认是贪婪模式（在符合条件下尽可能多的匹配）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">res=re.search(<span class="string">r'ABC&#123;2,8&#125;'</span>,<span class="string">'ABCCCCCC'</span>)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">8</span>), match=<span class="string">'ABCCCCCC'</span>&gt;</span><br></pre></td></tr></table></figure>
<p>可以利用<code>?</code>变为非贪婪模式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">res=re.search(<span class="string">r'ABC&#123;2,8&#125;?'</span>,<span class="string">'ABCCCCCC'</span>)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">4</span>), match=<span class="string">'ABCC'</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="捕获"><a href="#捕获" class="headerlink" title="捕获"></a>捕获</h2><p>使用<code>(....)</code>会捕获其中内容</p>
<p>使用<code>(?:...)</code>不会捕获其中内容</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="匹配ip地址"><a href="#匹配ip地址" class="headerlink" title="匹配ip地址"></a>匹配ip地址</h3><p><code>res=re.search(r&#39;((\d\d|\d|1\d\d|2[0-4]\d|25[0-5])\.){3}((\d\d|\d|1\d\d|2[0-4]\d|25[0-5]))&#39;,&#39;2.1.1.1&#39;)</code></p>
<p>相关博客：<a href="http://bbs.fishc.com/thread-57073-1-1.html" target="_blank" rel="noopener">Python3如何优雅地使用正则表达式</a></p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> regex </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Python Spider入门]]></title>
      <url>https://ivyxjc.xyz/2016/03/27/python/Spider/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2016-03-27-python-spider/</url>
      <content type="html"><![CDATA[<h2 id="添加header和data"><a href="#添加header和data" class="headerlink" title="添加header和data"></a>添加header和data</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">request=urllib.request.Request(url)</span><br><span class="line">response=urllib.request.urlopen(request)</span><br><span class="line"><span class="comment">#response是一个http.client.HTTPResponse对象</span></span><br><span class="line">print(response.geturl()) <span class="comment">#获取网址</span></span><br><span class="line">print(response.info())  <span class="comment">#获取信息</span></span><br><span class="line">print(response.getcode()) <span class="comment"># http状态码</span></span><br><span class="line"></span><br><span class="line">html=response.read()</span><br></pre></td></tr></table></figure>
<p><code>urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</code><br>1.data参数：the HTTP request will be a POST instead of a GET when the data parameter is provided.data should be a buffer in the standard application/x-www-form-urlencoded format. The urllib.parse.urlencode() function takes a mapping or sequence of 2-tuples and returns a string in this format.<br></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data=&#123;&#125;</span><br><span class="line">data[<span class="string">'type'</span>]=<span class="string">'AUTO'</span></span><br><span class="line">data[<span class="string">'i'</span>]=content</span><br><span class="line">data[<span class="string">'doctype'</span>]=<span class="string">'json'</span></span><br><span class="line">data[<span class="string">'xmlVersion'</span>]=<span class="number">1.8</span></span><br><span class="line">data[<span class="string">'keyfrom'</span>]=<span class="string">'fanyi.web'</span></span><br><span class="line">data[<span class="string">'ue'</span>]=<span class="string">'UTF-8'</span></span><br><span class="line">data[<span class="string">'action'</span>]=<span class="string">'FY_BY_CLICKBUTTON'</span></span><br><span class="line">data[<span class="string">'typoResult'</span>]=<span class="string">'true'</span></span><br><span class="line"></span><br><span class="line">data=urllib.parse.urlencode(data).encode(<span class="string">'utf-8'</span>)</span><br></pre></td></tr></table></figure>
<p>2.headers：一个字典，可以直接从浏览器中复制过来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">header=&#123;&#125;</span><br><span class="line"><span class="comment">#添加header的第一种方法</span></span><br><span class="line">header[<span class="string">'User-Agent'</span>]=<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0'</span></span><br><span class="line">request=urllib.request.Request(url,data,header)</span><br><span class="line"><span class="comment">#也可使用以下方法</span></span><br><span class="line">request.add_header(<span class="string">'User-Agent'</span>,<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="获取Response-Headers"><a href="#获取Response-Headers" class="headerlink" title="获取Response Headers"></a>获取Response Headers</h2><p>下面代码是用来判断 网页是否使用<code>gzip</code>压缩过。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> response.getheaders():</span><br><span class="line">    <span class="keyword">if</span> i[<span class="number">0</span>]==<span class="string">"Content-Encoding"</span>:</span><br><span class="line">        <span class="keyword">if</span>(i[<span class="number">-1</span>]==<span class="string">"gzip"</span>):</span><br><span class="line">            html=gzip.decompress(html)</span><br></pre></td></tr></table></figure></p>
<h2 id="使用代理"><a href="#使用代理" class="headerlink" title="使用代理"></a>使用代理</h2><p>1.参数是一个字典{‘类型’：‘代理ip:端口号’}<br><code>proxy_support=urllib.request.ProxyHandler({})</code><br>2.定制、创建一个openner<br><code>opener=urllib.request.build_opener(proxy_support)
3a.安装opener</code>urllib.request.install_opener(opener)<code>3b.调用opener</code>opener.open(url)`</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">proxy_support=urllib.request.ProxyHandler(&#123;<span class="string">'http'</span>:random.choice(iplist)&#125;)</span><br><span class="line"></span><br><span class="line">opener=urllib.request.build_opener(proxy_support)</span><br><span class="line">opener.addheaders=[(<span class="string">'User-Agent'</span>,<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0'</span>)]</span><br><span class="line">urllib.request.install_opener(opener)</span><br><span class="line"></span><br><span class="line">req=urllib.request.Request(url)</span><br><span class="line">response=urllib.request.urlopen(req)</span><br></pre></td></tr></table></figure>
<h2 id="爬知乎图片"><a href="#爬知乎图片" class="headerlink" title="爬知乎图片"></a>爬知乎图片</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment">#打开网页</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">url_open</span><span class="params">(url)</span>:</span></span><br><span class="line">    iplist=[</span><br><span class="line">        <span class="string">'49.77.22.1:8118'</span>,</span><br><span class="line">        <span class="string">'58.134.102.3:12696'</span>,</span><br><span class="line">        <span class="string">'120.26.213.55:9999'</span>...]</span><br><span class="line"></span><br><span class="line">    proxy_support=urllib.request.ProxyHandler(&#123;<span class="string">'http'</span>:random.choice(iplist)&#125;)</span><br><span class="line"></span><br><span class="line">    opener=urllib.request.build_opener(proxy_support)</span><br><span class="line">    opener.addheaders=[(<span class="string">'User-Agent'</span>,<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0'</span>)]</span><br><span class="line"></span><br><span class="line">    urllib.request.install_opener(opener)</span><br><span class="line"></span><br><span class="line">    req=urllib.request.Request(url)</span><br><span class="line">    response=urllib.request.urlopen(req)</span><br><span class="line">    html=response.read()</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取图片地址，返回图片地址的list</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_imgs</span><span class="params">(url)</span>:</span></span><br><span class="line">    html=url_open(url).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">    img_address=[]</span><br><span class="line">    a=html.find(<span class="string">'data-original'</span>)</span><br><span class="line">    <span class="keyword">while</span>(a!=<span class="number">-1</span>):</span><br><span class="line">        b=html.find(<span class="string">'.jpg'</span>,a,a+<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">if</span>(b!=<span class="number">-1</span>):</span><br><span class="line">            <span class="comment"># print(html[a+15:b+4])</span></span><br><span class="line">            img_address.append(html[a+<span class="number">15</span>:b+<span class="number">4</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            b=a+<span class="number">9</span></span><br><span class="line">        a=html.find(<span class="string">'data-original='</span>,b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> img_address:</span><br><span class="line">        print(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> img_address</span><br><span class="line"></span><br><span class="line"><span class="comment">#存储到本地</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_imgs</span><span class="params">(img_address)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> img_address:</span><br><span class="line">        <span class="comment"># print(i)</span></span><br><span class="line">        filename=i.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">with</span> open(filename,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            img=url_open(i)</span><br><span class="line">            f.write(img)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zhihuPic</span><span class="params">(url,folder=<span class="string">"zhihu"</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span>(os.path.exists(folder)):</span><br><span class="line">        os.chdir(folder)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        os.mkdir(folder)</span><br><span class="line">        os.chdir(folder)</span><br><span class="line">    img_address=get_imgs(url)</span><br><span class="line">    save_imgs(img_address)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    zhihuPic(<span class="string">"https://www.zhihu.com/question/22070147"</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> spider </tag>
            
            <tag> pythonspider </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[跨程序共享数据]]></title>
      <url>https://ivyxjc.xyz/2016/03/26/android/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/2016-03-26-content-provider/</url>
      <content type="html"><![CDATA[<p>可以利用<code>getContentResolver()</code>获取<code>ContentResolver</code>. <code>ContentResolver</code>中提供了一系列方法用于对数据进行CRUD操作.<br><a id="more"></a></p>
<h2 id="ContentProvider"><a href="#ContentProvider" class="headerlink" title="ContentProvider"></a>ContentProvider</h2><p>通过<code>getContentResolver()</code>获取<code>ContentResolver</code>的实例，<code>ContentResolver</code>中提供了一系列方法用于对数据进行CRUD操作.<br>其中<br> 1.insert() 用于添加<br> 2.update() 用于更新<br> 3.delete() 用于删除<br> 4.query()  用于查询</p>
<h3 id="内容URI及用法"><a href="#内容URI及用法" class="headerlink" title="内容URI及用法"></a>内容URI及用法</h3><p><code>ContentResolver</code>中的CRUD操作是不接受表名参数的，而是使用一个<code>Uri</code>参数代替。该参数被称为内容<code>URI</code>，由两部分组成：authority和path。<br>内容<code>URI</code>标准写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">content://com.example.app.provider/table1</span><br></pre></td></tr></table></figure>
<p>需要将内容<code>URI</code>解析成<code>Uri</code>对象才可以作为参数传入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uri uri=Uri.parse(<span class="string">"content://com.example.app.provider/table1"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="查询操作"><a href="#查询操作" class="headerlink" title="查询操作"></a>查询操作</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cursor cursor=getContentResolver().query(uri,projection,selection,selectionArgs,orderBy);</span><br></pre></td></tr></table></figure>
<p>其它操作与之类似，也和SQLite中的操作相像。<br><img src="/assets/img/posts/content_provider_query.png" alt=""></p>
<h2 id="自定义ContentProvider"><a href="#自定义ContentProvider" class="headerlink" title="自定义ContentProvider"></a>自定义ContentProvider</h2><p>可以<code>extends ContentProvider</code>，需要覆盖父类的6个方法.</p>
<p> 1.<code>public boolean onCreate()</code>:初始化ContentProvider时调用，完成对数据库的创建和升级，返回true则表示ContentProvider初始化成功，返回false表示失败。<strong>注意：只有存在<code>ContentResolver</code>尝试访问该程序中的而数据时，ContentProvider才会初始化</strong>。<br> 2.<code>public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder)</code>：从ContentProvider中查询数据。使用<code>uri</code>参数来确定查询哪一张表，<code>projection</code>用于确定查询哪些列，<code>selection</code>和<code>selectionArgs</code>用来约束查询内容，<code>sordOreder</code>参数用于对结果进行排序，查询结果放在<code>Cursor</code>中返回。<br> 3.<code>public Uri insert(Uri uri, ContentValues values)</code>：向<code>ContentProvider</code>中添加一条数据。<br> 4.<code>public int delete(Uri uri, String selection, String[] selectionArgs)</code>：从<code>ContentProvider</code>中删除数据。<br> 5.<code>public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs)</code>：更新数据<br> 6.<code>public String getType(Uri uri)</code>:根据传入的内容URI来返回相对应的MIME类型。</p>
<p>一个内容URI对应的MIME字符串由三部分组成：<br> 1.必须以vnd开头。<br> 2.如果内容URI以路径结尾，则后街<code>androi.cursor.dir/</code>,如果内容URI以id结尾，则后接<code>android.cursor.item/</code>。<br> 3.最后街上<code>vnd.&lt;authority&gt;.&lt;path&gt;</code></p>
<h2 id="安全性保证"><a href="#安全性保证" class="headerlink" title="安全性保证"></a>安全性保证</h2><p>因为所有的CRUD操作都一定要匹配到相应的内容URI格式才能进行，所以我们可以控制外部程序能够获得的存储内容。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_data </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Notification初步]]></title>
      <url>https://ivyxjc.xyz/2016/03/26/android/%E6%8E%A7%E4%BB%B6/Notification/2016-03-26-Notification-basic/</url>
      <content type="html"><![CDATA[<h2 id="通知"><a href="#通知" class="headerlink" title="通知"></a>通知</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MainActivity.java</span><br><span class="line"></span><br><span class="line">NotificationManager notificationManager=(NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);</span><br><span class="line"></span><br><span class="line">Notification.Builder builder=<span class="keyword">new</span> Notification.Builder(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置点击通知进入NotificationActivity</span></span><br><span class="line">Intent intent=<span class="keyword">new</span> Intent(<span class="keyword">this</span>,NotificationActivity.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二个参数int requestCode相同，表示是同一个pendingIntent</span></span><br><span class="line">PendingIntent pi=PendingIntent.getActivity(<span class="keyword">this</span>,<span class="number">0</span>,intent,PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置通知栏 布局，内容等...</span></span><br><span class="line">builder.setSmallIcon(R.mipmap.ic_launcher);</span><br><span class="line">builder.setContentTitle(<span class="string">"Notification Title"</span>);</span><br><span class="line">builder.setContentText(<span class="string">"Notification text"</span>);</span><br><span class="line">builder.setContentIntent(pi);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个参数在应用中是唯一的，代表这个通知</span></span><br><span class="line">notificationManager.notify(<span class="number">11</span>, builder.build());</span><br></pre></td></tr></table></figure>
<ol>
<li>FLAG_CANCEL_CURRENT:如果当前系统中已经存在一个相同的PendingIntent对象，那么就将先将已有的PendingIntent取消，然后重新生成一个PendingIntent对象。</li>
<li>FLAG_NO_CREATE:如果当前系统中不存在相同的PendingIntent对象，系统将不会创建该PendingIntent对象而是直接返回null。</li>
<li>FLAG_ONE_SHOT:该PendingIntent只作用一次。在该PendingIntent对象通过send()方法触发过后，PendingIntent将自动调用cancel()进行销毁，那么如果你再调用send()方法的话，系统将会返回一个SendIntentException。</li>
<li>FLAG_UPDATE_CURRENT:如果系统中有一个和你描述的PendingIntent对等的PendingInent，那么系统将使用该PendingIntent对象，但是会使用新的Intent来更新之前PendingIntent中的Intent对象数据，例如更新Intent中的Extras。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NotificationActivity.java</span><br><span class="line"></span><br><span class="line">NotificationManager manager=(NotificationManager)getSystemService(NOTIFICATION_SERVICE);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使通知在通知栏消失</span></span><br><span class="line">manager.cancel(<span class="number">11</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置声音</span></span><br><span class="line">Uri soundUri=Uri.fromFile(<span class="keyword">new</span> File(<span class="string">"/system/media/audio/ringtones/Boxbeat.ogg"</span>));</span><br><span class="line">builder.setSound(soundUri);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置震动上</span></span><br><span class="line"><span class="comment">//下标为偶数和0的标识手机静止的时长，奇数标识手机震动的时长</span></span><br><span class="line"><span class="keyword">long</span> [] vibrates=&#123;<span class="number">0</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1000</span>&#125;;</span><br><span class="line">builder.setVibrate(vibrates);</span><br></pre></td></tr></table></figure>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="/assets/img/posts/notification.gif" alt=""></p>
<h2 id="短信"><a href="#短信" class="headerlink" title="短信"></a>短信</h2><h3 id="接收短信"><a href="#接收短信" class="headerlink" title="接收短信"></a>接收短信</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mReceiveFilter=<span class="keyword">new</span> IntentFilter();</span><br><span class="line">mReceiveFilter.addAction(<span class="string">"android.provider.Telephony.SMS_RECEIVED"</span>);</span><br><span class="line">mMessageReceiver=<span class="keyword">new</span> MessageReceiver();</span><br><span class="line">registerReceiver(mMessageReceiver,mReceiveFilter);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessageReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">            Bundle bundle=intent.getExtras();</span><br><span class="line"></span><br><span class="line">            Object[] pdus=(Object[])bundle.get(<span class="string">"pdus"</span>);<span class="comment">//提取短信消息</span></span><br><span class="line"></span><br><span class="line">            SmsMessage[] messages=<span class="keyword">new</span> SmsMessage[pdus.length];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;messages.length;i++)&#123;</span><br><span class="line">                messages[i]=SmsMessage.createFromPdu((<span class="keyword">byte</span>[])pdus[i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String address=messages[<span class="number">0</span>].getOriginatingAddress();</span><br><span class="line"></span><br><span class="line">            String fullMessage=<span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span>(SmsMessage message:messages)&#123;</span><br><span class="line">                fullMessage+=message.getMessageBody();<span class="comment">//获取短信内容</span></span><br><span class="line">            &#125;</span><br><span class="line">            sender.setText(address);</span><br><span class="line">            content.setText(fullMessage);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="拦截短信"><a href="#拦截短信" class="headerlink" title="拦截短信"></a>拦截短信</h3><p>系统发出的短信广播是一条有序广播，所以可以先获得该广播，再中止广播传递即可。</p>
<p>1.提高MessageReceiver的优先级，让它能够先于系统短信程序接收到短信广播。<br>2.调用<code>abortBroadcast()</code>方法，中止广播传递。</p>
<h3 id="发送短信"><a href="#发送短信" class="headerlink" title="发送短信"></a>发送短信</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mSendButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            Log.i(<span class="string">"AAABBB"</span>, <span class="string">"before"</span>);</span><br><span class="line">            SmsManager smsManager = SmsManager.getDefault();</span><br><span class="line">            Log.i(<span class="string">"AAABBB"</span>, <span class="string">"getDefault"</span>);</span><br><span class="line">            smsManager.sendTextMessage(mTo.getText().toString(), <span class="keyword">null</span>, mEditText.toString(), <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AlertDialog]]></title>
      <url>https://ivyxjc.xyz/2016/03/25/android/%E6%8E%A7%E4%BB%B6/AlertDialog/2016-03-25-Alert-Dialog/</url>
      <content type="html"><![CDATA[<h2 id="在Activity中调用AlertDialog"><a href="#在Activity中调用AlertDialog" class="headerlink" title="在Activity中调用AlertDialog"></a>在Activity中调用AlertDialog</h2><p>只能在<code>Activity</code>中调用<code>AlertDialog</code>，所以要想在<code>Receiver</code>中使用<code>AlerDialog</code>，可以在<code>Receiver</code>中用<code>starActivity()</code>启动有<code>AlertDialog</code>的<code>Activity</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(<span class="keyword">final</span> Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">    Intent i=<span class="keyword">new</span> Intent(context,AlertDialogActivity.class);</span><br><span class="line">    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);;</span><br><span class="line">    context.startActivity(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AlertDialogActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        AlertDialog.Builder dialogBuilder=<span class="keyword">new</span> AlertDialog.Builder(<span class="keyword">this</span>);</span><br><span class="line">        dialogBuilder.setTitle(<span class="string">"Warning"</span>);</span><br><span class="line"></span><br><span class="line">        dialogBuilder.setMessage(<span class="string">"you are force to be offline"</span>);</span><br><span class="line">        dialogBuilder.setCancelable(<span class="keyword">false</span>);</span><br><span class="line">        dialogBuilder.setPositiveButton(<span class="string">"OK"</span>,</span><br><span class="line">                <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                        ActivityCollector.finishAll();</span><br><span class="line">                        Intent intent = <span class="keyword">new</span> Intent(AlertDialogActivity.<span class="keyword">this</span>,LoginActivity.class);</span><br><span class="line">                        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">                        startActivity(intent);<span class="comment">//重新启动LoginActivity</span></span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        AlertDialog alertDialog=dialogBuilder.create();</span><br><span class="line"></span><br><span class="line">        alertDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_SYSTEM_ALERT);</span><br><span class="line">        alertDialog.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_control </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[数据持久化]]></title>
      <url>https://ivyxjc.xyz/2016/03/25/android/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/2016-03-25-data-persistence/</url>
      <content type="html"><![CDATA[<h2 id="数据存储到文件"><a href="#数据存储到文件" class="headerlink" title="数据存储到文件"></a>数据存储到文件</h2><p><code>Context</code>类提供了一个<code>openFileOutput()</code>方法，可以将数据存储到指定的文件中。接受两个参数，</p>
<ol>
<li>第一个参数是文件名(无需包含路径)，默认存储 到<code>/data/data/&lt;package name&gt;/files/</code>目录下。</li>
<li>第二个参数是文件的操作模式，主要有两种：<code>MODE_PRIVATE</code>和<code>MODE_APPEND</code>。其中<code>MODE_PRIVATE</code>是默认的操作模式，表示当指定同样文件名的时候，所写入的内容将会覆盖原文件中的内容。<code>MODE_APPEND</code>则表示如果该文件已存在就往文件里面追加内容。还有另外两种模式：<code>MODE_WORLD_READABLE</code>和<code>MODE_WORLD_WRITEABLE</code>表示允许其它的应用程序对该程序中的文件进行读写操作，已被废弃。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(String inputText)</span></span>&#123;</span><br><span class="line">    FileOutputStream out=<span class="keyword">null</span>;</span><br><span class="line">    BufferedWriter writer=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        out=openFileOutput(<span class="string">"data"</span>, Context.MODE_PRIVATE);</span><br><span class="line">        writer=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(out));</span><br><span class="line">        writer.write(inputText);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(writer!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                writer.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">load</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FileInputStream in=<span class="keyword">null</span>;</span><br><span class="line">    BufferedReader reader=<span class="keyword">null</span>;</span><br><span class="line">    StringBuilder content=<span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        in=openFileInput(<span class="string">"data"</span>);</span><br><span class="line">        reader=<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">        String line=<span class="string">""</span>;</span><br><span class="line">        <span class="keyword">while</span> ((line=reader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            content.append(line);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(reader!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                reader.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> content.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="SharedPreferences存储"><a href="#SharedPreferences存储" class="headerlink" title="SharedPreferences存储"></a>SharedPreferences存储</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//存储数据</span></span><br><span class="line">SharedPreferences.Editor editor=getSharedPreferences(<span class="string">"data"</span>,MODE_PRIVATE).edit();</span><br><span class="line">editor.putString(<span class="string">"name"</span>,<span class="string">"Tom"</span>);</span><br><span class="line">editor.putInt(<span class="string">"age"</span>, <span class="number">28</span>);</span><br><span class="line">editor.putBoolean(<span class="string">"married"</span>, <span class="keyword">false</span>);</span><br><span class="line">editor.commit();</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取数据</span></span><br><span class="line"></span><br><span class="line">SharedPreferences preferences=getSharedPreferences(<span class="string">"data"</span>,MODE_PRIVATE);</span><br><span class="line">String name=preferences.getString(<span class="string">"name"</span>, <span class="string">""</span>);</span><br><span class="line"><span class="keyword">boolean</span> married=preferences.getBoolean(<span class="string">"married"</span>, <span class="keyword">false</span>);</span><br><span class="line"><span class="keyword">int</span> age=preferences.getInt(<span class="string">"age"</span>,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><p>安卓提供了一个<code>SQLiteOpenHelper</code>帮助类，可以借助这个类对数据库进行创建和升级。</p>
<h3 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//建表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> Book&#123;</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">integer</span> primary <span class="keyword">key</span> autoincrement,</span><br><span class="line">    author <span class="built_in">text</span>,</span><br><span class="line">    price <span class="built_in">real</span>,</span><br><span class="line">    pages <span class="built_in">integer</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">text</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><code>integer</code>:整型</li>
<li><code>real</code>：浮点型</li>
<li><code>text</code>：文本类型</li>
<li><code>blob</code>：二进制类型</li>
</ol>
<h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SQLiteDatabase db=dbHelper.getWritableDatabase();</span><br><span class="line">ContentValues values=<span class="keyword">new</span> ContentValues();</span><br><span class="line">values.put(<span class="string">"author"</span>,<span class="string">"Dan Brown"</span>);</span><br><span class="line">values.put(<span class="string">"name"</span>,<span class="string">"The Da Vinci Code"</span>);</span><br><span class="line">values.put(<span class="string">"pages"</span>,<span class="number">454</span>);</span><br><span class="line">values.put(<span class="string">"price"</span>, <span class="number">16.96</span>);</span><br><span class="line">db.insert(<span class="string">"Book"</span>,<span class="keyword">null</span>,values);</span><br><span class="line">values.clear();</span><br></pre></td></tr></table></figure>
<p>向数据库中添加数据</p>
<h3 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h3><p>可以使用<br><code>db.update(String Table,ContenValues values,String WhereClauses,String[] WhereArgs)</code></p>
<p>第三个参数对应SQL语句中的<code>where</code>，其中用<code>?</code>作占位符，第四个参数则表示<code>?</code>的内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表示将name为The Da Vinci Code 的价格改为10.99</span></span><br><span class="line">ConteValues values=<span class="keyword">new</span> ContentValues();</span><br><span class="line">values.put(<span class="string">"price"</span>,<span class="number">10.99</span>);</span><br><span class="line">db.update(<span class="string">"Book"</span>,values,<span class="string">"name=?"</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"The Da Vinci Code"</span>&#125;)；</span><br></pre></td></tr></table></figure>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><p>可以使用<code>db.delete(String Table,String WhereClauses,String[] WhereArgs)</code><br>第二，三两个参数用来约束删除某一行或几行的数据，不指定的话就默认删除所有行。</p>
<h3 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h3><table>
<thead>
<tr>
<th>query()方法参数</th>
<th>对应SQL部分</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>table</td>
<td>from table_name</td>
<td>指定查询的表名</td>
</tr>
<tr>
<td>columns</td>
<td>select column1,column2</td>
<td>指定查询的列名</td>
</tr>
<tr>
<td>selection</td>
<td>where column=value</td>
<td>指定where的约束条件</td>
</tr>
<tr>
<td>selectionArgs</td>
<td>-</td>
<td>为where中的占位符提供具体的数值</td>
</tr>
<tr>
<td>groupBy</td>
<td>group by column</td>
<td>指定需要group by的列</td>
</tr>
<tr>
<td>having</td>
<td>having column=value</td>
<td>对group by后的结果进一步约束</td>
</tr>
<tr>
<td>orderBy</td>
<td>order by column1, column2</td>
<td>指定查询结果的排序方式</td>
</tr>
</tbody>
</table>
<p><code>Cursor cursor = db.query(&quot;Book&quot;, null, null, null, null, null, null);</code><br>上式查询表中所有数据</p>
<h3 id="直接使用SQL语句"><a href="#直接使用SQL语句" class="headerlink" title="直接使用SQL语句"></a>直接使用SQL语句</h3><p>除查询之外的所有方法可以条用<code>db.execSQL(...)</code>接执行SQL语句<br>查询数据的方法时可调用它<code>db.rawQuery(...)</code>接执行SQL语句</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyDatabaseHelper</span> <span class="keyword">extends</span> <span class="title">SQLiteOpenHelper</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CREATE_BOOK=<span class="string">"create table Book ("</span> +</span><br><span class="line">            <span class="string">"id integer primary key autoincrement,"</span> +</span><br><span class="line">            <span class="string">"author text,"</span> +</span><br><span class="line">            <span class="string">"price real,"</span> +</span><br><span class="line">            <span class="string">"pages integer,"</span> +</span><br><span class="line">            <span class="string">"name text)"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyDatabaseHelper</span><span class="params">(Context context, String name, SQLiteDatabase.CursorFactory factory, <span class="keyword">int</span> version)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, name, factory, version);</span><br><span class="line">        mContext=context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(SQLiteDatabase db)</span> </span>&#123;</span><br><span class="line">        db.execSQL(CREATE_BOOK);</span><br><span class="line">        <span class="comment">//db.execSQL(CREATE_CATEGORY);</span></span><br><span class="line">        Toast.makeText(mContext,<span class="string">"Create succeeded"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUpgrade</span><span class="params">(SQLiteDatabase db, <span class="keyword">int</span> oldVersion, <span class="keyword">int</span> newVersion)</span> </span>&#123;</span><br><span class="line">        db.execSQL(<span class="string">"drop table if exists Book"</span>);</span><br><span class="line">        db.execSQL(<span class="string">"drop table if exists Category"</span>);</span><br><span class="line">        onCreate(db);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MyDatabaseHelper dbHelper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line"><span class="comment">//最后一个数是版本号，若版本号比原先高，则会调用  SQLiteOpenHelper中的onUpgrade()。</span></span><br><span class="line">        dbHelper=<span class="keyword">new</span> MyDatabaseHelper(<span class="keyword">this</span>,<span class="string">"BookStore.db"</span>,<span class="keyword">null</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        Button button=(Button)findViewById(R.id.button);</span><br><span class="line"></span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                dbHelper.getWritableDatabase();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        Button addData=(Button)findViewById(R.id.add_data);</span><br><span class="line">        addData.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                SQLiteDatabase db=dbHelper.getWritableDatabase();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//向数据库中添加数据</span></span><br><span class="line">                ContentValues values=<span class="keyword">new</span> ContentValues();</span><br><span class="line">                values.put(<span class="string">"author"</span>,<span class="string">"Dan Brown"</span>);</span><br><span class="line">                values.put(<span class="string">"name"</span>,<span class="string">"The Da"</span>);</span><br><span class="line">                values.put(<span class="string">"pages"</span>,<span class="number">454</span>);</span><br><span class="line">                values.put(<span class="string">"price"</span>, <span class="number">16.96</span>);</span><br><span class="line">                db.insert(<span class="string">"Book"</span>,<span class="keyword">null</span>,values);</span><br><span class="line">                values.clear();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_data </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[广播机制初步]]></title>
      <url>https://ivyxjc.xyz/2016/03/20/android/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6/2016-03-20-broadcast-basic/</url>
      <content type="html"><![CDATA[<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>标准广播(Normal broadcasts)是一种完全异步执行的广播，在广播发出后，所有的广播接收器都在同一时刻受到这条广播消息，没有先后顺序。效率高，无法被截断。</p>
<p>有序广播(Ordered broadcasts)是一种同步执行的广播，同一时刻，只有一个广播接收器能受到这条广播消息，当这个广播接收器中的逻辑执行完毕后，广播才会继续传递。<br>有先后顺序，优先级高的会先收到广播消息，并且前面的广播接收器可以截断正在传递的广播。</p>
<p>接受广播：广播接收器(Broadcast Receiver)</p>
<h2 id="系统广播"><a href="#系统广播" class="headerlink" title="系统广播"></a>系统广播</h2><h2 id="注册广播"><a href="#注册广播" class="headerlink" title="注册广播"></a>注册广播</h2><p>动态注册的广播接收器一定要取消注册，一般是在<code>onDestroy()</code>方法中通过调用<code>unregisterReceiver()</code>方法来实现的。</p>
<h3 id="动态注册"><a href="#动态注册" class="headerlink" title="动态注册"></a>动态注册</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IntentFilter mIntentFilter;</span><br><span class="line">    <span class="comment">// Whether there is a Wi-Fi connection.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> wifiConnected = <span class="keyword">false</span>;</span><br><span class="line">    <span class="comment">// Whether there is a mobile connection.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> mobileConnected = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TextView mWifiTextView;</span><br><span class="line">    <span class="keyword">private</span> TextView mMobileTextView;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> NetworkChangeReceiver mNetworkChangeReceiver;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        mWifiTextView=(TextView)findViewById(R.id.wifi);</span><br><span class="line">        mMobileTextView=(TextView)findViewById(R.id.mobile_network);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        注册广播接收器</span></span><br><span class="line"><span class="comment">        当网络发生变化时，系统发出的是一条值为"android.net.conn.CONNECTIVITY_CHANGE"的广播消息</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        mIntentFilter=<span class="keyword">new</span> IntentFilter();</span><br><span class="line">        mIntentFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);</span><br><span class="line">        mNetworkChangeReceiver=<span class="keyword">new</span> NetworkChangeReceiver();</span><br><span class="line">        registerReceiver(mNetworkChangeReceiver,mIntentFilter);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册的广播接收都需要解除注册</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        unregisterReceiver(mNetworkChangeReceiver);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NetworkChangeReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line"><span class="comment">//            Toast.makeText(context,"network change",Toast.LENGTH_SHORT).show();</span></span><br><span class="line">            ConnectivityManager connMgr =</span><br><span class="line">                    (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);</span><br><span class="line">            NetworkInfo activeInfo = connMgr.getActiveNetworkInfo();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (activeInfo != <span class="keyword">null</span> &amp;&amp; activeInfo.isConnected()) &#123;</span><br><span class="line">                wifiConnected = activeInfo.getType() == ConnectivityManager.TYPE_WIFI;</span><br><span class="line">                mobileConnected = activeInfo.getType() == ConnectivityManager.TYPE_MOBILE;</span><br><span class="line">                <span class="keyword">if</span>(wifiConnected) &#123;</span><br><span class="line"><span class="comment">//                    Toast.makeText(context,"wifi is connected",Toast.LENGTH_LONG).show();</span></span><br><span class="line">                    mWifiTextView.setText(<span class="string">"Wifi is connected"</span>);</span><br><span class="line">                    mMobileTextView.setText(<span class="string">"mobile network is not connected"</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mobileConnected) &#123;</span><br><span class="line"><span class="comment">//                    Toast.makeText(context,"mobile network is connected",Toast.LENGTH_LONG).show();</span></span><br><span class="line">                    mWifiTextView.setText(<span class="string">"Wifi is not connected"</span>);</span><br><span class="line">                    mMobileTextView.setText(<span class="string">"mobile network is connected"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//                Toast.makeText(context,"no network",Toast.LENGTH_LONG).show();</span></span><br><span class="line">                mWifiTextView.setText(<span class="string">"Wifi is not connected"</span>);</span><br><span class="line">                mMobileTextView.setText(<span class="string">"mobile network is not connected"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外还需在增加以下两个权限，否则会在打开的时候崩溃。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><p><img src="http://oezmbgg4j.bkt.clouddn.com/broadcast_network_connectivity.gif" alt=""></p>
<h3 id="静态注册"><a href="#静态注册" class="headerlink" title="静态注册"></a>静态注册</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BootCompleteReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(context,<span class="string">"Boot Complete"</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在AndroidManifest.xml中需要添加下列语句：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">user-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.RECEIVE_BOOT_COMPLETED"</span>/&gt;</span></span><br><span class="line">......</span><br><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">	<span class="attr">...</span>&gt;</span></span><br><span class="line">	.....</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">receiver</span> <span class="attr">android:name</span>=<span class="string">".BootCompleteReceiver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.BOOT_COMPLETED"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="自定义广播"><a href="#自定义广播" class="headerlink" title="自定义广播"></a>自定义广播</h2><p>写一个自定义的广播接收器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBroadcastReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(context,<span class="string">"received in MyBroadcastReceiver"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发出一个广播</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Intent intent=<span class="keyword">new</span> Intent(<span class="string">"com.jc.broadcast_1.MY_BROADCAST"</span>);</span><br><span class="line">sendBroadcast(intent);</span><br></pre></td></tr></table></figure>
<p>在一个应用程序中发出的广播，也是可以被其它应用程序所接收到的。</p>
<h2 id="发送有序广播"><a href="#发送有序广播" class="headerlink" title="发送有序广播"></a>发送有序广播</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendOrderedBroadcast(Intent intent,String receiverPermission);</span><br></pre></td></tr></table></figure>
<p>这样可以截断广播，<br>在<code>onReceiver(...)</code>方法里调用<code>abortBroadcast()</code>方法，就表示将这条广播截断。后面的广播就无法再接收到这条广播。</p>
<h2 id="本地广播"><a href="#本地广播" class="headerlink" title="本地广播"></a>本地广播</h2><p>只能在应用程序的内部进行传递，并且广播接收器也只能接受来自本应用发出的广播。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mLocalBroadcastManager=LocalBroadcastManager.getInstance(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        Intent intent=<span class="keyword">new</span> Intent(<span class="string">"com.jc.broadcast_2.LOCAL_BROADCAST"</span>);</span><br><span class="line">        mLocalBroadcastManager.sendBroadcast(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">mIntentFilter=<span class="keyword">new</span> IntentFilter();</span><br><span class="line">mIntentFilter.addAction(<span class="string">"com.jc.broadcast_2.LOCAL_BROADCAST"</span>);</span><br><span class="line">mLocalReceiver=<span class="keyword">new</span> LocalReceiver();</span><br><span class="line">mLocalBroadcastManager.registerReceiver(mLocalReceiver,mIntentFilter);</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_broadcast </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fragment和Activity通信]]></title>
      <url>https://ivyxjc.xyz/2016/03/19/android/UI%E7%9B%B8%E5%85%B3/Fragment/2016-03-19-Fragment-message-transportation/</url>
      <content type="html"><![CDATA[<h2 id="Fragment和Activity通信"><a href="#Fragment和Activity通信" class="headerlink" title="Fragment和Activity通信"></a>Fragment和Activity通信</h2><p>为了方便碎片和活动之间进行通信，FragmentManager 提供了一个类似于<code>findViewById()</code>的方法，专门用于从布局文件中获取碎片的实例，代码如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RightFragment rightFragment = (RightFragment) getFragmentManager()</span><br><span class="line">.findFragmentById(R.id.right_fragment);</span><br></pre></td></tr></table></figure>
<p>这样即可调用Fragment中的方法<br>在Fragment中都可以用getActivity()方法来得到和当前Fragment相关联的Activity实例。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MainActivity activity=(MainActivity)getActivity();</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CriminalIntent程序中Fragment相关内容]]></title>
      <url>https://ivyxjc.xyz/2016/03/17/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AndroidBigNerdRanceGuide/CriminalIntent%E5%BC%80%E5%8F%91/2016-03-17-Diaglog/</url>
      <content type="html"><![CDATA[<h2 id="实现DialogFragment方法"><a href="#实现DialogFragment方法" class="headerlink" title="实现DialogFragment方法"></a>实现DialogFragment方法</h2><ol>
<li>创建DialogPickerFragment类</li>
<li>创建AlertDialog</li>
<li>通过FragmentManager在屏幕上显示对话框</li>
</ol>
<p>##　创建DialogFrgment</p>
<p>在屏幕上显示DialogFrgment时,托管Activity的FragmentManager会调用以下方法:</p>
<p><code>public Dialog onCreateDialog(Bundle savedInstanceState)</code></p>
<p>1.2.</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FragmentDataPicker</span> <span class="keyword">extends</span> <span class="title">DialogFragment</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AlertDialog.Builder(getActivity())</span><br><span class="line">                .setTitle(R.string.date_picker_title)</span><br><span class="line">                .setPositiveButton(android.R.string.ok,<span class="keyword">null</span>)</span><br><span class="line">                .create();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mDateButton.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                FragmentManager fm=getActivity()</span><br><span class="line">                        .getSupportFragmentManager();</span><br><span class="line"></span><br><span class="line">                FragmentDataPicker dialog=<span class="keyword">new</span> FragmentDataPicker();</span><br><span class="line">                dialog.show(fm,DIALOG_DATE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>android有三种用于对话框的按钮：positive按钮，negative按钮和neutral按钮。</p>
<h3 id="设置对话框的显示内容"><a href="#设置对话框的显示内容" class="headerlink" title="设置对话框的显示内容"></a>设置对话框的显示内容</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">View v=getActivity().getLayoutInflater()</span><br><span class="line">                .inflate(R.layout.dialog_date,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> AlertDialog.Builder(getActivity())</span><br><span class="line">      .setView(v)</span><br><span class="line">          .setTitle(R.string.date_picker_title)</span><br><span class="line">          .setPositiveButton(android.R.string.ok,<span class="keyword">null</span>)</span><br><span class="line">          .create();</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_fragment </tag>
            
            <tag> android_project </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CriminalIntent程序中Fragment相关内容]]></title>
      <url>https://ivyxjc.xyz/2016/03/14/android/%E5%BC%80%E5%8F%91%E5%AE%9E%E6%88%98/AndroidBigNerdRanceGuide/CriminalIntent%E5%BC%80%E5%8F%91/2016-03-14-CriminalIntent-Fragment/</url>
      <content type="html"><![CDATA[<h2 id="Activity中托管UI-fragment有两种方式："><a href="#Activity中托管UI-fragment有两种方式：" class="headerlink" title="Activity中托管UI fragment有两种方式："></a>Activity中托管UI fragment有两种方式：</h2><ol>
<li>添加fragment到acitivity中</li>
<li>在activity代码中添加fragment</li>
</ol>
<p>第一种方法即将fragment添加到acitivity的布局中，这样会使得fragment视图和activity视图绑定。</p>
<p>第二种方法可以在运行时控制fragment，可以决定何时将fragment添加到activity中，也可以移除当前fragment，用其它fragment代替当前fragment…</p>
<p>为了能够灵活地设计UI，所以常用第二种方式来添加fragment。</p>
<h3 id="详细步骤"><a href="#详细步骤" class="headerlink" title="详细步骤"></a>详细步骤</h3><h4 id="托管UI-fragment"><a href="#托管UI-fragment" class="headerlink" title="托管UI fragment"></a>托管UI fragment</h4><ol>
<li>需要在activity视图层级结构中为fragment试图安排位置。</li>
</ol>
<h4 id="创建UI-fragment"><a href="#创建UI-fragment" class="headerlink" title="创建UI fragment"></a>创建UI fragment</h4><ol>
<li>通过定义布局文件中的组件,组装界面</li>
<li>创建fragment类并设置试图为定义的布局</li>
<li>通过代码的方式,连接布局文件中生成的组件</li>
</ol>
<p><code>Fragment</code>类要实现两个方法–<code>onCreate()</code>和<code>onCreateView()</code>方法。<code>onCreateView()</code>方法用来生成fragment视图的布局。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    View v=inflater.inflate(R.layout.fragment_crime,container,<span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>onCreateView()</code>方法也是生成其它组件的地方。</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><ol>
<li>设置容器</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">activity_crime.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/fragment_container"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>编写fragment布局文件</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fragment_crime.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/crime_title_edit_text"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">"@string/crime_title_hint"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>3.使用代码添加fragment</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">activity_main.java</span><br><span class="line"></span><br><span class="line">FragmentManager fm=getSupportFragmentManager();</span><br><span class="line">        Fragment fragment=fm.findFragmentById(R.id.fragment_container);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(fragment==<span class="keyword">null</span>)&#123;</span><br><span class="line">            fragment=<span class="keyword">new</span> FragmentCrime();</span><br><span class="line">            fm.beginTransaction()</span><br><span class="line">                    .add(R.id.fragment_container,fragment)</span><br><span class="line">                    .commit();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h4 id="添加UI-fragment到FragmentManager"><a href="#添加UI-fragment到FragmentManager" class="headerlink" title="添加UI fragment到FragmentManager"></a>添加UI fragment到FragmentManager</h4><p>FragmentManager主要处理：</p>
<ol>
<li>fragment队列</li>
<li>fragment事务的回退栈</li>
</ol>
<h2 id="Fragment与Activity数据传送"><a href="#Fragment与Activity数据传送" class="headerlink" title="Fragment与Activity数据传送"></a>Fragment与Activity数据传送</h2><p>Fragment传送数据到Activity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Intent i=<span class="keyword">new</span> Intent(getActivity(),CrimeActivity.class);</span><br><span class="line">i.putExtra(CrimeFragment.EXTRA_CRIME_ID,c.getId());</span><br><span class="line">startActivity(i);</span><br></pre></td></tr></table></figure>
<p>Activity中接受数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    UUID crimeId=(UUID)getActivity().getIntent()</span><br><span class="line">            .getSerializableExtra(EXTRA_CRIME_ID);</span><br><span class="line"></span><br><span class="line">    mCrime=CrimeLab.get(getActivity()).getCrime(crimeId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[adb常用命令]]></title>
      <url>https://ivyxjc.xyz/2016/03/10/android/adb/2016-03-10-adb-console/</url>
      <content type="html"><![CDATA[<h2 id="设备相关"><a href="#设备相关" class="headerlink" title="设备相关"></a>设备相关</h2><p><strong>adb devices</strong>:查看连接的设备<br></p>
<p><strong>adb -s  serial number shell</strong> :serial number及上命令得到的设备编号</p>
<h2 id="录制屏幕相关"><a href="#录制屏幕相关" class="headerlink" title="录制屏幕相关"></a>录制屏幕相关</h2><p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD<br><strong>adb screerecord /sdcard/test.mp4</strong>：录制手机实况视频到test.mp4，按<strong>ctrl+c</strong>结束，否则录制320s。</p>
<p><strong>adb screerecord –size 1280*720 /sdcard/test.mp4</strong> :制定视频大小</p>
<p><strong> adb shell screenrecord –bit-rate 6000000 /sdcard/test.mp4</strong> :制定视频码率</p>
<p><strong>adb shell screenrecord –rotate /sdcard/test.mp4</strong> :旋转</p>
<h1 id="adb-pull-sdcard-test-mp4-E-导出视频"><a href="#adb-pull-sdcard-test-mp4-E-导出视频" class="headerlink" title="adb pull /sdcard/test.mp4 E:/ :导出视频"></a><strong>adb pull /sdcard/test.mp4 E:/</strong> :导出视频</h1><p><strong>adb screenrecord /sdcard/test.mp4</strong>：录制手机实况视频到test.mp4，按<strong>ctrl+c</strong>结束，否则录制320s。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_adb </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fragment初步]]></title>
      <url>https://ivyxjc.xyz/2016/03/09/android/UI%E7%9B%B8%E5%85%B3/Fragment/2016-03-09-Fragment-basic/</url>
      <content type="html"><![CDATA[<h2 id="Fragment概要"><a href="#Fragment概要" class="headerlink" title="Fragment概要"></a>Fragment概要</h2><p><img src="http://oezmbgg4j.bkt.clouddn.com/fragmentIntro.png" alt=""></p>
<h2 id="onCreateView-方法"><a href="#onCreateView-方法" class="headerlink" title="onCreateView()方法"></a><strong>onCreateView()</strong>方法</h2><p>Fragment第一次绘制它的用户界面时，系统会调用此方法。为了方便绘制Fragment的UI，此方法必须返回一个View，如果不显示UI，返回null。</p>
<h3 id="标识Fragment方法"><a href="#标识Fragment方法" class="headerlink" title="标识Fragment方法"></a>标识Fragment方法</h3><p>android:id 提供一个唯一的ID 或<br>android:tag 提供一个唯一的字符串tag</p>
<h2 id="静态加载"><a href="#静态加载" class="headerlink" title="静态加载"></a>静态加载</h2><p>在<strong>Activity</strong>的layout文件中声明<strong>Fragment</strong>，其中<strong>android:name</strong>属性制定了在layout中实例化的Fragment类。</p>
<p>静态加载Fragment必须要给Fragment一个唯一的标识。</p>
<p>文件目录：<br><br>——src<br><br>————Fragment_1.java (extends Fragment)<br><br>————Fragment_2.java   (extends Activity)<br><br>————MainActivity.java    (extends Activity)<br><br><br><br>——layout<br><br>————fragment_1.xml<br><br>————fragment_2.xml<br><br>————activity_main.xml<br></p>
<p><strong>Fragment1.java</strong>利用<strong>fragment_1.xml</strong>返回一个<strong>view</strong>，<strong>activity.xml</strong>中的<strong>android:name=”com.jc.fragmentbasic.FragmentFirst”</strong>，然后<strong>MainActivity</strong>调用<code>setContentView(R.layout.activity_main);`</code></p>
<h3 id="fragment-1和fragment-2-xml和activity-main-xml"><a href="#fragment-1和fragment-2-xml和activity-main-xml" class="headerlink" title="fragment_1和fragment_2.xml和activity_main.xml"></a>fragment_1和fragment_2.xml和activity_main.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"This is fragment 1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"#0000FF"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"25sp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"#00FF00"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"This is fragment 2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">"#FF0000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">"#00F0F0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">"25sp"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:baselineAligned</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">android:orientation</span>=<span class="string">"horizontal"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/fragment1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.jc.fragment_1.Fragment_1"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"0dip"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">"1"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">fragment</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/fragment2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">"com.jc.fragment_1.Fragment_2"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"0dip"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">"1"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Fragment-1-java和Fragment-2-java和MainActivity-java"><a href="#Fragment-1-java和Fragment-2-java和MainActivity-java" class="headerlink" title="Fragment_1.java和Fragment_2.java和MainActivity.java"></a>Fragment_1.java和Fragment_2.java和MainActivity.java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fragment_1</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_1,container,<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fragment_2</span> <span class="keyword">extends</span> <span class="title">Fragment</span></span>&#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inflater.inflate(R.layout.fragment_2,container,<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="加载过程的代码"><a href="#加载过程的代码" class="headerlink" title="加载过程的代码"></a>加载过程的代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> R.id.first:&#123;</span><br><span class="line">    Intent intent=<span class="keyword">new</span> Intent(<span class="keyword">this</span>,MainActivity.class);</span><br><span class="line">    startActivity(intent);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="http://oezmbgg4j.bkt.clouddn.com/fragment_basic_1.png" alt=""></p>
<h2 id="动态加载"><a href="#动态加载" class="headerlink" title="动态加载"></a>动态加载</h2><p>根据用户的交互情况，对Fragment进行添加，移除，替换，以及执行其他动作，提交Activity的每一套变化被称作一个<strong>事务</strong>。</p>
<p>每一事务都是同时执行一套变化，可以在一个事务中设置你所有执行的变化，包括add(),remove(),replace()，然后提交个Activity，必须调用commit()方法。</p>
<p>如果允许使用Back键返回前一Fragment的状态，调用commit()之前可以加入addToBackStack()方法。</p>
<p>1.获取到FragmentManager，在Activity中可以直接通过getFragmentManager得到。</p>
<p>2.调用beginTransaction方法开启一个事务。</p>
<p>3.向容器内加入Fragment，一般使用replace方法实现，需要传入容器的id和Fragment的实例。</p>
<p>4.提交事务，调用commit方法提交。</p>
<h3 id="加载过程代码"><a href="#加载过程代码" class="headerlink" title="加载过程代码"></a>加载过程代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> R.id.dynamic:&#123;</span><br><span class="line">    FragmentDynamic fragmentDynamic=<span class="keyword">new</span> FragmentDynamic();</span><br><span class="line">    FragmentManager fragmentManager=getFragmentManager();</span><br><span class="line">    FragmentTransaction beginTransaction=fragmentManager.beginTransaction();</span><br><span class="line">    beginTransaction.add(R.id.frame,fragmentDynamic);</span><br><span class="line">    beginTransaction.commit();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="fragment生命周期"><a href="#fragment生命周期" class="headerlink" title="fragment生命周期"></a>fragment生命周期</h2><p>关键方法：<strong>onAttach()</strong>,<strong>onCreateView()</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FragmentThird</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 每次创建会绘制Fragment的View组件时回调该方法。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        View v=inflater.inflate(R.layout.fragment_third,container,<span class="keyword">false</span>);</span><br><span class="line"><span class="comment">//        Log.i("Main","Fragment third--onCreateView()");</span></span><br><span class="line">        TextView textView=(TextView)v.findViewById(R.id.textview_third);</span><br><span class="line">        textView.setText(<span class="string">"第三个Fragment"</span>);</span><br><span class="line">        Log.i(<span class="string">"Main"</span>,<span class="string">"Fragment third--onCreateView()"</span>);</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当Fragment被添加到Activity时候会回调这个方法，并且只调用一次</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttach</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onAttach(context);</span><br><span class="line">        Log.i(<span class="string">"Main"</span>,<span class="string">"Fragment third--on attach()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建Fragment时会回调，只会调用一次</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        Log.i(<span class="string">"Main"</span>,<span class="string">"Fragment third--onCreate()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *当Fragment所在的Activity启动完成后调用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onActivityCreated</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityCreated(savedInstanceState);</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onActivityCreated()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 启动Fragment</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStart();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onStart()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 回复Fragment时会被回调，调用onStart()方法后面一定会调用</span></span><br><span class="line"><span class="comment">     * onResume方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onResume();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onResume()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 暂停Fragment</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onPause();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>,<span class="string">"Fragment third--onPause()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 停止Fragment</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onStop();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>,<span class="string">"Fragment third--onStop()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁Fragment所包含的View组件时调用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroyView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroyView();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onDestroyView()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁Framgent时会被调用</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onDestroy()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 与onAttach()方法对应</span></span><br><span class="line"><span class="comment">     * Fragment从Activity中删除时会回调该方法，并且只会调用一次</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDetach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDetach();</span><br><span class="line">        Log.i(<span class="string">"Main"</span>, <span class="string">"Fragment third--onDetach()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Log结果：</span><br><span class="line">启动应用：<span class="keyword">null</span></span><br><span class="line"></span><br><span class="line">启动Fragment：</span><br><span class="line">I/Main(<span class="number">8163</span>): Fragment third--<span class="function">on <span class="title">attach</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onCreate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onCreateView</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onActivityCreated</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onResume</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">屏幕锁屏：</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onPause</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">解锁：</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onResume</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">切换到其它的Fragment:</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onPause</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStop</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDestroyView</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDestroy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDetach</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">回到桌面:</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onPause</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">回到Fragment:</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStart</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onResume</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">退出Fragment：</span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onPause</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onStop</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDestroyView</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDestroy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">I/<span class="title">Main</span><span class="params">(<span class="number">8163</span>)</span>: Fragment third--<span class="title">onDetach</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Activity和Fragment通信"><a href="#Activity和Fragment通信" class="headerlink" title="Activity和Fragment通信"></a>Activity和Fragment通信</h2><p>Activity —&gt; Fragment:在Activity中创建Bundle数据包，并调用Fragment的setArguments(Bundle bundle)方法。</p>
<p>Fragment —&gt; Activity：需要在Fragment中定义一个内部回调接口，让包含该Fragment的Activity实现该回调接口。这样Fragment可调用回调方法将数据传递给Activity。</p>
<h2 id="相关博客网址"><a href="#相关博客网址" class="headerlink" title="相关博客网址"></a>相关博客网址</h2><p><a href="http://blog.csdn.net/guolin_blog/article/details/8881711" target="_blank" rel="noopener">Android Fragment完全解析，关于碎片你所需知道的一切</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
            <tag> android_fragment </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ProgressBar和ProgressDialog]]></title>
      <url>https://ivyxjc.xyz/2016/03/09/android/%E6%8E%A7%E4%BB%B6/Bar/2016-03-09-ProgressBar/</url>
      <content type="html"><![CDATA[<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>可以精确显示进度(可以显示刻度或者百分比)</p>
<p>不可以精确显示进度()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示两种进度条</span></span><br><span class="line">setProgressBarVisibility(<span class="keyword">true</span>);</span><br><span class="line">setProgressBarIndeterminateVisibility(<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure>
<p>还可分类为圆圈型，直线型。</p>
<h2 id="ProgressBar属性"><a href="#ProgressBar属性" class="headerlink" title="ProgressBar属性"></a>ProgressBar属性</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">android:max="100"</span><br><span class="line">android:progress="50"----第一进度</span><br><span class="line">android:secondaryProgress="80"---第二进度</span><br><span class="line">android:indeterminate="true"---设置是否精确显示，true显示不精确显示进度，false表示精确显示进度</span><br></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">first=progressBar.getProgress();<span class="comment">//获取第一进度条的进度</span></span><br><span class="line">second=progressBar.getSecondaryProgress();<span class="comment">//获取第二进度条的进度</span></span><br><span class="line">max=progressBar.getMax();<span class="comment">//获取进度条的最大进度</span></span><br><span class="line"><span class="keyword">int</span> firstPercent=(<span class="keyword">int</span>)(first/(<span class="keyword">float</span>)max*<span class="number">100</span>);</span><br><span class="line"><span class="keyword">int</span> seconPercent=(<span class="keyword">int</span>)(second/(<span class="keyword">float</span>)max*<span class="number">100</span>);</span><br><span class="line">text.setText(<span class="string">"FirstProgress"</span>+firstPercent+<span class="string">"%  SecondProgress"</span>+seconPercent+<span class="string">"%"</span>);</span><br><span class="line"></span><br><span class="line">addButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">reduceButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">resetButton.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (v.getId())&#123;</span><br><span class="line">        <span class="keyword">case</span> R.id.add:&#123;</span><br><span class="line">            first+=<span class="number">5</span>;</span><br><span class="line">            second+=<span class="number">5</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> R.id.reduce:&#123;</span><br><span class="line">            first-=<span class="number">5</span>;</span><br><span class="line">            second-=<span class="number">5</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> R.id.reset:&#123;</span><br><span class="line">            first=<span class="number">0</span>;</span><br><span class="line">            second=<span class="number">10</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//也可使用incrementProgress</span></span><br><span class="line">    progressBar.setProgress(first);</span><br><span class="line">    progressBar.setSecondaryProgress(second);</span><br><span class="line">    <span class="keyword">int</span> firstPercent=(<span class="keyword">int</span>)(first/(<span class="keyword">float</span>)max*<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">int</span> seconPercent=(<span class="keyword">int</span>)(second/(<span class="keyword">float</span>)max*<span class="number">100</span>);</span><br><span class="line">    text.setText(<span class="string">"FirstProgress"</span> + firstPercent + <span class="string">"%  SecondProgress"</span> + seconPercent+<span class="string">"%"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/progressbar.gif" alt=""></p>
<h2 id="ProgressDialog"><a href="#ProgressDialog" class="headerlink" title="ProgressDialog"></a>ProgressDialog</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/showDialog"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"Dialog"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> R.id.showDialog:&#123;</span><br><span class="line">    <span class="comment">//新建ProgressDialog的对象</span></span><br><span class="line">    prodialog=<span class="keyword">new</span> ProgressDialog(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//设置显示风格</span></span><br><span class="line">    prodialog.setProgress(ProgressDialog.STYLE_HORIZONTAL);</span><br><span class="line">    <span class="comment">//设置标题</span></span><br><span class="line">    prodialog.setTitle(<span class="string">"IVYXJC"</span>);</span><br><span class="line">    <span class="comment">//设置对话框文本</span></span><br><span class="line">    prodialog.setMessage(<span class="string">"Welcome to ProgressDialog"</span>);</span><br><span class="line">    <span class="comment">//设置图标</span></span><br><span class="line">    prodialog.setIcon(android.R.drawable.ic_dialog_alert);</span><br><span class="line">    <span class="comment">//设定最大进度</span></span><br><span class="line">    prodialog.setMax(<span class="number">100</span>);</span><br><span class="line">    <span class="comment">//设定初始化已经增长到的进度</span></span><br><span class="line">    prodialog.incrementProgressBy(<span class="number">50</span>);</span><br><span class="line">    <span class="comment">//进度条是明确显示进度的</span></span><br><span class="line">    prodialog.setIndeterminate(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设定一个确定按钮</span></span><br><span class="line">    prodialog.setButton(DialogInterface.BUTTON_POSITIVE,<span class="string">"确定"</span>,<span class="keyword">new</span> DialogInterface.OnClickListener()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>,<span class="string">"欢迎"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    prodialog.show();</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/progressdialog.gif" alt=""></p>
<h2 id="自定义ProgressBar的样式"><a href="#自定义ProgressBar的样式" class="headerlink" title="自定义ProgressBar的样式"></a>自定义ProgressBar的样式</h2><p>ProgressBar的样式是可以自定义的，可参考默认的样式更改。</p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_bar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[使用WebView显示网页]]></title>
      <url>https://ivyxjc.xyz/2016/03/07/android/%E6%8E%A7%E4%BB%B6/WebView/2016-03-07-%E4%BD%BF%E7%94%A8WebView%E6%98%BE%E7%A4%BA%E7%BD%91%E9%A1%B5/</url>
      <content type="html"><![CDATA[<h2 id="访问权限"><a href="#访问权限" class="headerlink" title="访问权限"></a>访问权限</h2><p>调用第三方或者系统默认浏览器不需要使用网络访问权限，但是自己写WebView访问网络资源需要配置网络访问权限。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="使用loadUrl"><a href="#使用loadUrl" class="headerlink" title="使用loadUrl()"></a>使用loadUrl()</h2><p>web资源： webView.loadUrl(“<a href="http://www.bing.com&quot;)" target="_blank" rel="noopener">http://www.bing.com&quot;)</a>;</p>
<p>本地文件：webView.loadUrl(“file:///android_asset/xx.html”);</p>
<p>本地文件放在 asset文件夹中</p>
<p>//使页面获得焦点<br>webView.requestFocus();</p>
<h2 id="处理页面导航"><a href="#处理页面导航" class="headerlink" title="处理页面导航"></a>处理页面导航</h2><p>当用户点击webView中的链接时，通常由默认浏览器打开并加载目标url，需要覆盖该默认处理方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">webView.setWebViewClient(<span class="keyword">new</span> WebViewClient()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//返回True的时候控制网页在WebView中打开</span></span><br><span class="line">                <span class="comment">//返回False控制网页在默认浏览器中打开。</span></span><br><span class="line">                view.loadUrl(url);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//WebViewClient帮助WebView处理一些页面控制和请求通知,还有其它很多方法，如下</span></span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageStarted</span><span class="params">(WebView view, String url, Bitmap favicon)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">super</span>.onPageStarted(view, url, favicon);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">super</span>.onPageFinished(view, url);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<h2 id="WebView使用Javascript"><a href="#WebView使用Javascript" class="headerlink" title="WebView使用Javascript"></a>WebView使用Javascript</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebSettings settings=webView.getSettings();</span><br><span class="line">settings.setJavaScriptEnabled(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>
<h2 id="设置返回键逻辑"><a href="#设置返回键逻辑" class="headerlink" title="设置返回键逻辑"></a>设置返回键逻辑</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(keyCode==KeyEvent.KEYCODE_BACK)&#123;</span><br><span class="line">        <span class="keyword">if</span>(webView.canGoBack())&#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,webView.getUrl(),Toast.LENGTH_SHORT).show();</span><br><span class="line">            webView.goBack();<span class="comment">//返回上一界面</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyDown(keyCode, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="判断加载页面过程"><a href="#判断加载页面过程" class="headerlink" title="判断加载页面过程"></a>判断加载页面过程</h2><h2 id="使用本地缓存"><a href="#使用本地缓存" class="headerlink" title="使用本地缓存"></a>使用本地缓存</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebSettings settings=webView.getSettings();   settings.setCacheMode(WebSettings.LOAD_CACHE_ELSE_NETWORK);</span><br></pre></td></tr></table></figure>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingLeft</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingRight</span>=<span class="string">"0dp"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ProgressBar</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/progressBar"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">"?android:attr/progressBarStyleHorizontal"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentTop</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">WebView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/webView"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">"@id/progressBar"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentEnd</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">WebView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">webView.setWebChromeClient(<span class="keyword">new</span> WebChromeClient()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgressChanged</span><span class="params">(WebView view, <span class="keyword">int</span> newProgress)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (newProgress == <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="comment">//网页已经加载完毕</span></span><br><span class="line">            progressCompleted();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//网页正在加载</span></span><br><span class="line">            progressUnCompleted(newProgress);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">progressCompleted</span><span class="params">()</span></span>&#123;</span><br><span class="line">        progressBar.setProgress(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">progressUnCompleted</span><span class="params">(<span class="keyword">int</span> newProgress)</span></span>&#123;</span><br><span class="line">        progressBar.setProgress(newProgress);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="http://oezmbgg4j.bkt.clouddn.com/webview.gif" alt=""></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_control </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python3注意点]]></title>
      <url>https://ivyxjc.xyz/2016/03/06/python/2016-03-06-python3-%E6%B3%A8%E6%84%8F%E7%82%B9/</url>
      <content type="html"><![CDATA[<h2 id="dict-set-list-tuple"><a href="#dict-set-list-tuple" class="headerlink" title="dict set list tuple"></a>dict set list tuple</h2><p>tuple是不可变对象。</p>
<p>dict的key值最好使用不可变对象，例如<strong>字符串</strong>。最好不要用tuple。如果tuple中含有可变对象的话，还是会有错误：<code>TypeError: unhashable type: &#39;list&#39;</code>。</p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>函数的默认参数最好是<strong>不可变对象</strong>。</p>
<p>如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_some</span><span class="params">(L=[])</span>:</span></span><br><span class="line">    <span class="keyword">if</span> L <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        L=[]</span><br><span class="line">    L.append(<span class="string">"some"</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">调用</span><br><span class="line">&gt;&gt;&gt;add_some[]</span><br><span class="line">[&apos;some&apos;]</span><br><span class="line">&gt;&gt;&gt;add_some[]</span><br><span class="line">[&apos;some&apos;,&apos;some&apos;]</span><br></pre></td></tr></table></figure>
<h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><p>在参数前加*即可使用可变参数，如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(*numbers)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> numbers:</span><br><span class="line">        sum = sum + n * n</span><br><span class="line">    <span class="keyword">return</span> sum</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;calc(1,2,3,4)</span><br><span class="line">30</span><br><span class="line">&gt;&gt;&gt;calc()</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<p>在list，tuple前加*可以使之变为可变参数传入函数之中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;list1=[1,2,3,4]</span><br><span class="line">&gt;&gt;&gt;calc(*list1)</span><br><span class="line">30</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python3 </tag>
            
            <tag> python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Layout_Gravity和Gravity]]></title>
      <url>https://ivyxjc.xyz/2016/02/22/android/UI%E7%9B%B8%E5%85%B3/%E5%B8%83%E5%B1%80/2016-02-22-Layout-Gravity%E5%92%8CGravity/</url>
      <content type="html"><![CDATA[<h2 id="Android-Layout-Gravity和Gravity"><a href="#Android-Layout-Gravity和Gravity" class="headerlink" title="Android Layout_Gravity和Gravity"></a>Android Layout_Gravity和Gravity</h2><p>简单来说layout_gravity表示子控件在父容器的位置，gravity表示控件内容在控件内的位置。<br><img src="http://i.stack.imgur.com/xKdfI.png" alt="如图所示"></p>
<p>上面图片的xml代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_weight</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">"#e3e2ad"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">"vertical"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">"24sp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"gravity="</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如何设置为wrap_content 则gravity失效--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#bcf5b1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"left"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#aacaff"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"center_horizontal"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#bcf5b1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"right"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#aacaff"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"center"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--match_parent改为wrap_content则下面的layout_gravity失效--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_weight</span>=<span class="string">"1"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">"#d6c6cd"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:textSize</span>=<span class="string">"24sp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"layout_gravity="</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"left"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#bcf5b1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"left"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"center_horizontal"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#aacaff"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"center_horizontal"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#bcf5b1"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">"@+id/"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_gravity</span>=<span class="string">"center"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">"#aacaff"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">"center"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>参考<br>1.<a href="http://stackoverflow.com/questions/3482742/gravity-and-layout-gravity-on-android" target="_blank" rel="noopener">Gravity and layout_gravity on Android</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> android </tag>
            
            <tag> android_UI </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[PAT 1010 Radix 25]]></title>
      <url>https://ivyxjc.xyz/2016/02/21/algorithm/oj/PAT/2016-02-21-1010%E9%A2%98-Radix-25%E5%88%86/</url>
      <content type="html"><![CDATA[<p>该题未全部完成，未通过全部测例 20/25</p>
<p>这道题目是<a href="http://www.patest.cn/contests/pat-a-practise" target="_blank" rel="noopener">PAT甲级习题</a>中通过率最低的一道题，通过率只有$0.08$。我暂时也未能通过全部测例，还差4个测例。应该是边界条件未考虑充分。</p>
<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>Each input file contains one test case. Each case occupies a line which contains 4 positive integers:<br><br>$N_1$ $N_2$ tag radix<br><br>Here $N_1$ and $N_2$ each has no more than 10 digits. A digit is less than its radix and is chosen from the set {0-9, a-z} where 0-9 represent the decimal numbers 0-9, and a-z represent the decimal numbers 10-35. The last number “radix” is the radix of N1 if “tag” is 1, or of N2 if “tag” is 2. <br></p>
<p>中文大意：<br>输入4个数<br>其中第四个数表示第三个数所指的那个数$N$的进制，现在来判断另一个数$M$在哪一种进制下回合$N$相同，若存在则输出进制，否则输出”Impossible”。<br></p>
<h2 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h2><h3 id="String-Convert-to-Long"><a href="#String-Convert-to-Long" class="headerlink" title="String Convert to Long"></a>String Convert to Long</h3><p>就是输入数据，由于数据中可能含有字母，仍存储为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">//已知字符串和进制，算出对应的十进制数</span><br><span class="line">public static long strToLong(String str,long radix)&#123;</span><br><span class="line">    long res=0;</span><br><span class="line">    int tmp=0;</span><br><span class="line">    for(int i=str.length()-1;i&gt;=0;i--)&#123;</span><br><span class="line">        res+=map.get(str.charAt(i))*Math.pow(radix,tmp++);</span><br><span class="line">    &#125;</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="获得未知进制数中最大的字符所代表的十进制数"><a href="#获得未知进制数中最大的字符所代表的十进制数" class="headerlink" title="获得未知进制数中最大的字符所代表的十进制数"></a>获得未知进制数中最大的字符所代表的十进制数</h3><p>因为进制数一定要大于最大的字符，所以可以通过这一步获得进制的下限</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String resNumStr = dataStr[resRadixNumPosi];</span><br><span class="line">    <span class="comment">//获取未知进制数中最大的字符所代表的十进制数</span></span><br><span class="line">    <span class="keyword">int</span> biggestCharInResNumStr = map.get(resNumStr.charAt(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resNumStr.length(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (map.get(resNumStr.charAt(i)) &gt; biggestCharInResNumStr) &#123;</span><br><span class="line">            biggestCharInResNumStr = map.get(resNumStr.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h3><p>下限即上一步所求出的数+1<br>上限即为已知进制的数</p>
<p>退出条件:<br>    若上下限相同，检查对应两个数在该进制是否相同<br>    若下限大于上限，输出Impossible; return;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">findRadix</span><span class="params">(<span class="keyword">long</span> num,String str,<span class="keyword">long</span> radixBegin,<span class="keyword">long</span> radixEnd)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(radixBegin&gt;radixEnd)&#123;</span><br><span class="line">        System.out.println(<span class="string">"Impossible"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(radixBegin==radixEnd)&#123;</span><br><span class="line">        <span class="keyword">if</span>(strToLong(str,radixBegin)==num)&#123;</span><br><span class="line">            System.out.println(radixBegin);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"Impossible"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> radixMiddle=(radixBegin+radixEnd)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">long</span> middleRadixNum=strToLong(str,radixMiddle);</span><br><span class="line">    <span class="keyword">if</span>(middleRadixNum&gt;num)&#123;</span><br><span class="line">        findRadix(num,str,radixBegin,radixMiddle);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(middleRadixNum==num)&#123;</span><br><span class="line">        System.out.println(radixMiddle);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        findRadix(num,str,radixMiddle+<span class="number">1</span>,radixEnd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="边界条件"><a href="#边界条件" class="headerlink" title="边界条件"></a>边界条件</h3><ol>
<li>N1和N2一样时，应该输出其中最大字符所代表的数值再+1；</li>
</ol>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> PAT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by xgh on 2016/2/21.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">_1010_Radix_25</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;Character,Integer&gt; map=<span class="keyword">new</span> HashMap&lt;Character, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String[] dataStr = (in.nextLine()).split(<span class="string">" "</span>);</span><br><span class="line">        <span class="keyword">int</span> charRepNum = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> i = <span class="string">'a'</span>; i &lt;= <span class="string">'z'</span>; i++) &#123;</span><br><span class="line">            map.put(i, charRepNum++);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">            map.put((<span class="keyword">char</span>) (i + <span class="number">48</span>), i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> givenRadixNumPosi = Integer.parseInt(dataStr[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">long</span> givenRadix = Integer.parseInt(dataStr[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> aaa = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">long</span> givenNum = <span class="number">0</span>;</span><br><span class="line">        String givenNumStr = dataStr[givenRadixNumPosi - <span class="number">1</span>];</span><br><span class="line"><span class="comment">//        System.out.println(givenNumStr);</span></span><br><span class="line"><span class="comment">//        System.out.println(givenRadixNumPosi-1);</span></span><br><span class="line"><span class="comment">//        for(char e:map.keySet())&#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(e+" ==== "+map.get(e));</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = givenNumStr.length() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            givenNum += map.get(givenNumStr.charAt(i)) * Math.pow(givenRadix, aaa++);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> resRadixNumPosi = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (givenRadixNumPosi == <span class="number">1</span>) &#123;</span><br><span class="line">            resRadixNumPosi = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resRadixNumPosi = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String resNumStr = dataStr[resRadixNumPosi];</span><br><span class="line">        <span class="keyword">int</span> biggestCharInResNumStr = map.get(resNumStr.charAt(<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resNumStr.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (map.get(resNumStr.charAt(i)) &gt; biggestCharInResNumStr) &#123;</span><br><span class="line">                biggestCharInResNumStr = map.get(resNumStr.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(strToLong(resNumStr,biggestCharInResNumStr+<span class="number">1</span>)==givenNum)&#123;</span><br><span class="line">            System.out.println(biggestCharInResNumStr+<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(Integer.parseInt("ab"));</span></span><br><span class="line"><span class="comment">//        System.out.println(givenNum);</span></span><br><span class="line"><span class="comment">//        System.out.println(resNumStr);</span></span><br><span class="line"><span class="comment">//        System.out.println(givenRadix+1);</span></span><br><span class="line"><span class="comment">//        System.out.println(biggestCharInResNumStr+1);</span></span><br><span class="line"></span><br><span class="line">        findRadix(givenNum,resNumStr,biggestCharInResNumStr+<span class="number">1</span>,givenNum+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">findRadix</span><span class="params">(<span class="keyword">long</span> num,String str,<span class="keyword">long</span> radixBegin,<span class="keyword">long</span> radixEnd)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(radixBegin&gt;radixEnd)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Impossible"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(radixBegin==radixEnd)&#123;</span><br><span class="line">            <span class="keyword">if</span>(strToLong(str,radixBegin)==num)&#123;</span><br><span class="line">                System.out.println(radixBegin);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"Impossible"</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> radixMiddle=(radixBegin+radixEnd)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">long</span> middleRadixNum=strToLong(str,radixMiddle);</span><br><span class="line">        <span class="keyword">if</span>(middleRadixNum&gt;num)&#123;</span><br><span class="line">            findRadix(num,str,radixBegin,radixMiddle);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(middleRadixNum==num)&#123;</span><br><span class="line">            System.out.println(radixMiddle);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            findRadix(num,str,radixMiddle+<span class="number">1</span>,radixEnd);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">strToLong</span><span class="params">(String str,<span class="keyword">long</span> radix)</span></span>&#123;</span><br><span class="line">        <span class="keyword">long</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=str.length()-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            res+=map.get(str.charAt(i))*Math.pow(radix,tmp++);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> OJ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> todo </tag>
            
            <tag> onlinejudge </tag>
            
            <tag> binarysearch </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Codeforces Education Round7]]></title>
      <url>https://ivyxjc.xyz/2016/02/18/algorithm/oj/Codeforces/eduRound/2016-02-18-Codeforces-Edu-Round7%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/622/" target="_blank" rel="noopener">题目网址</a></p>
<h2 id="A-Infinite-Sequence"><a href="#A-Infinite-Sequence" class="headerlink" title="A:Infinite Sequence"></a>A:Infinite Sequence</h2><p>A题比较简单,主要就利用公式$ \sum_{k=1}^n k=\frac {(1+n)* n}{2} $来确定距离所要求的数字最近的一个1所在的位置。然后就可得到该数值了。<br><br>代码如下：</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Round7_A</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Scanner in=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">long</span>  a=in.nextLong();</span><br><span class="line">        <span class="keyword">long</span> a_one=count(a);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(a_one*a_one+a_one==<span class="number">2</span>*a)&#123;</span><br><span class="line">            System.out.println(a_one);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">long</span> tmp=(<span class="keyword">long</span>)a-(a_one*a_one+a_one)/<span class="number">2</span>;</span><br><span class="line">            System.out.println(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">count</span><span class="params">(<span class="keyword">long</span>  num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> num_two = <span class="number">2</span> * num;</span><br><span class="line">        <span class="keyword">long</span> i = (<span class="keyword">long</span>) Math.sqrt(num_two) - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//System.out.println(i);</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            i = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (; i &lt;= num; i++) &#123;</span><br><span class="line">            <span class="comment">//System.out.println(i);</span></span><br><span class="line">            <span class="keyword">if</span> (i * i + i == num_two) &#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i * i + i &gt; num_two) &#123;</span><br><span class="line">                <span class="keyword">return</span> i - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B-The-Time"><a href="#B-The-Time" class="headerlink" title="B. The Time"></a>B. The Time</h2><p>B题也比较简单，主要就注意几个边界条件即可以及格式化输出即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//num只有个位时，会自动在十位补0</span></span><br><span class="line">DecimalFormat df=<span class="keyword">new</span> DecimalFormat(<span class="string">"00"</span>);</span><br><span class="line">df.format(num);</span><br></pre></td></tr></table></figure>
<h2 id="C-Not-Equal-on-a-Segment"><a href="#C-Not-Equal-on-a-Segment" class="headerlink" title="C. Not Equal on a Segment"></a>C. Not Equal on a Segment</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>题意为查询一个数组的某一区间是否存在指定的$$$x$$$不相同的数，若不存在输出-1，否则输出任意一个不相同的树的秩。<br></p>
<h3 id="解法介绍"><a href="#解法介绍" class="headerlink" title="解法介绍"></a>解法介绍</h3><p>1.暴力解法就是遍历整个区间，但时间肯定不够。<br></p>
<p>2.线段树法：线段树广泛用于区间查询，但是该题仅需输出任意一个不相同的树的位置即可，所以可以不用该法。(其实我还没有特别熟线段树)</p>
<p>3.解法：设输入数据的数组为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建一个数组```diff[]=new int[arrayLength]```使其任意秩```diff[i]```值为满足$$$ a_j \ne a_i (j&gt;i) $$$的第一个j的值。这也是官方答案所给的解法。代码如下：&lt;br&gt;</span><br><span class="line"></span><br><span class="line">### 边界条件</span><br><span class="line">该代码需要考虑到的边界条件有：&lt;br&gt;</span><br></pre></td></tr></table></figure></p>
<p>1.数组内容全部相同<br>2.数组内容出现连续相同的项<br>3.数组内容全部不相同<br>4.diff数组的最后一项是否有值(统一将diff数组的最后一项设为数组长度)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 代码</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">int tmpI=0;</span><br><span class="line">for(int j=tmpI+1;j&lt;arrayLength;)&#123;</span><br><span class="line">    if(array[j]==array[tmpI]) &#123;</span><br><span class="line">        j++;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    for(;tmpI&lt;j;tmpI++)&#123;</span><br><span class="line">        diff[tmpI]=j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//若数组中最后出现连续相同的项，上述代码不能将这些项赋值为arrayLength</span><br><span class="line">//所以需要下面的代码</span><br><span class="line">for(int i=tmpI;i&lt;arrayLength;i++)&#123;</span><br><span class="line">    diff[i]=arrayLength;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">diff[arrayLength-1]=arrayLength;</span><br></pre></td></tr></table></figure>
<p>查询时使用的代码:<br></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;queryTimes;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> left=getInt()-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> right=getInt()-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> x=getInt();</span><br><span class="line">        <span class="keyword">if</span>(array[left]!=x)&#123;</span><br><span class="line">            writer.write((left+<span class="number">1</span>)+<span class="string">"\n"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(diff[left]&gt;right)&#123;</span><br><span class="line">            writer.write((-<span class="number">1</span>)+<span class="string">"\n"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            writer.write((diff[left]+<span class="number">1</span>)+<span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    writer.flush();</span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="IO问题"><a href="#IO问题" class="headerlink" title="IO问题"></a>IO问题</h3><p>这一题以及下面的e题还有一个问题就是如果使用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">我使用了[ java_acm快速输入和输出 ][1]中提供的一个输入输出方法，代码如下</span><br><span class="line">#### 解决代码</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">public class Main &#123;  </span><br><span class="line">    private static Reader reader = null;  </span><br><span class="line">    private static Writer writer = null;  </span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;  </span><br><span class="line">        reader = new InputStreamReader(System.in);  </span><br><span class="line">        writer = new OutputStreamWriter(System.out);  </span><br><span class="line">        try &#123;  </span><br><span class="line">                m = getInt();  </span><br><span class="line">                writer.write(&quot;something&quot;);  </span><br><span class="line">                writer.flush();  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125; catch (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取键盘输入的整数</span><br><span class="line">     *  </span><br><span class="line">     * @return 输入的整数</span><br><span class="line">     */  </span><br><span class="line">    public static int getInt() &#123;  </span><br><span class="line">        int read;  </span><br><span class="line">        int res = 0;  </span><br><span class="line">        boolean isNegative = false;// 是不是负数  </span><br><span class="line">        try &#123;  </span><br><span class="line">            while ((read = reader.read()) != -1) &#123;  </span><br><span class="line">                if ((char) read == &apos;-&apos;) &#123;  </span><br><span class="line">                    res = 0;  </span><br><span class="line">                    isNegative = true;  </span><br><span class="line">                    break;  </span><br><span class="line">                &#125; else if (isNumber((char) read)) &#123;  </span><br><span class="line">                    res = read - &apos;0&apos;;  </span><br><span class="line">                    break;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">            while ((read = reader.read()) != -1) &#123;  </span><br><span class="line">                char ch = (char) read;  </span><br><span class="line">                if (isNumber(ch)) &#123;  </span><br><span class="line">                    res = res * 10 + (read - &apos;0&apos;);  </span><br><span class="line">                &#125; else &#123;  </span><br><span class="line">                    break;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125; catch (IOException e) &#123;  </span><br><span class="line">            // TODO Auto-generated catch block  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        if (isNegative == true) &#123;  </span><br><span class="line">            res = -1 * res;  </span><br><span class="line">        &#125;  </span><br><span class="line">        return res;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 判断字符是否空白</span><br><span class="line">     *  </span><br><span class="line">     * @param ch</span><br><span class="line">     *            字符</span><br><span class="line">     * @return 判断结果</span><br><span class="line">     */  </span><br><span class="line">    public static boolean isBlank(char ch) &#123;  </span><br><span class="line">        if (ch == &apos;\r&apos; || ch == &apos;\n&apos; || ch == &apos; &apos;) &#123;  </span><br><span class="line">            return true;  </span><br><span class="line">        &#125;  </span><br><span class="line">        return false;  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 判断字符是不是数字</span><br><span class="line">     *  </span><br><span class="line">     * @param ch</span><br><span class="line">     *            字符</span><br><span class="line">     * @return 判断结果</span><br><span class="line">     */  </span><br><span class="line">    public static boolean isNumber(char ch) &#123;  </span><br><span class="line">        if (ch &lt;= &apos;9&apos; &amp;&amp; ch &gt;= &apos;0&apos;) &#123;  </span><br><span class="line">            return true;  </span><br><span class="line">        &#125;  </span><br><span class="line">        return false;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="E-Ants-in-Leaves"><a href="#E-Ants-in-Leaves" class="headerlink" title="E. Ants in Leaves"></a>E. Ants in Leaves</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>You are given a tree with n vertices and a root in the vertex 1. There is an ant in each leaf of the tree. In one second some ants can simultaneously go to the parent vertex from the vertex they were in. No two ants can be in the same vertex simultaneously except for the root of the tree.<br></p>
<p>Find the minimal time required for all ants to be in the root of the tree.<br></p>
<p>题意：n只蚂蚁从树的叶节点向根节点爬，每秒只能爬到它的父节点处，但是除了根节点，其它所有节点都只能同时存在一只蚂蚁。<br></p>
<h3 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h3><p>This problem was suggested by Aleksa Plavsic allllekssssa.</p>
<p>Let z be the array of the depths of all leaves in the subtree of the vertex v. Let’s sort z.</p>
<p>Statement 1: it’s profitable to lift the leaves in order of their appearing in z.</p>
<p>Statement 2: denote ax — the time of appearing the x-th leaf in the vertex v, let’s consider the leaves $$$z_i$$$ and $$$z_{i+1}$$$ then  $$$a_{z_i+1} \geq  a_{z_i}+1$$$.</p>
<p>Statement 3: $$$a_{z_i+1}=max(d_{z_i}+1,a_{z_i}+1)$$$, where $$$d_x$$$ is the depth of the x-th leaf in the subtree of the vertex v. The last statement gives us the solution for the problem: we should simply iterate over z from left to right and recalculate the array a by formula from the third statement. All statements can be easily proved and it’s recommended to do by yourself to understand better the idea of the solution.</p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><h5 id="建图"><a href="#建图" class="headerlink" title="建图"></a>建图</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> V=getInt();</span><br><span class="line">    Graph G=<span class="keyword">new</span> Graph(V,V-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;V-<span class="number">1</span>;i++)&#123;</span><br><span class="line">        G.addEdge(getInt(),getInt());</span><br><span class="line">    &#125;</span><br><span class="line">    G.dfs();</span><br><span class="line">    G.solve();</span><br></pre></td></tr></table></figure>
<h5 id="dfs-详细代码"><a href="#dfs-详细代码" class="headerlink" title="dfs()详细代码"></a>dfs()详细代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">public void dfs(int v)&#123;</span><br><span class="line">//从根节点出发</span><br><span class="line">    if(v==1)&#123;</span><br><span class="line">        int rootSonsNum=adj[v].getConnectedvertexs().size();</span><br><span class="line">        depthArray=new ArrayList[rootSonsNum];</span><br><span class="line">        for(int i=0;i&lt;rootSonsNum;i++)&#123;</span><br><span class="line">            depthArray[i]=new ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    marked[v]=true;</span><br><span class="line">    adj[v].setDepth(depth);</span><br><span class="line">    if(adj[v].getDegree()==1)</span><br><span class="line">        depthArray[count].add(adj[v].getDepth());</span><br><span class="line">    depth++;</span><br><span class="line">    for(Integer i:adj[v].getConnectedvertexs())&#123;</span><br><span class="line">        if(!marked[i])&#123;</span><br><span class="line">            dfs(i);</span><br><span class="line">            depth--;</span><br><span class="line">        &#125;</span><br><span class="line">        if(v==1)&#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void dfs()&#123;</span><br><span class="line">    dfs(1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="solve-代码"><a href="#solve-代码" class="headerlink" title="solve()代码"></a>solve()代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">public int solve()&#123;</span><br><span class="line">    for(ArrayList&lt;Integer&gt; i:depthArray) &#123;</span><br><span class="line">        Collections.sort(i);</span><br><span class="line">//            i.sort(new Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">//                @Override</span><br><span class="line">//                public int compare(Integer o1, Integer o2) &#123;</span><br><span class="line">//                    if (o1 &gt; o2)</span><br><span class="line">//                        return 1;</span><br><span class="line">//                    else if (o1 == o2)</span><br><span class="line">//                        return 0;</span><br><span class="line">//                    else</span><br><span class="line">//                        return -1;</span><br><span class="line">//                &#125;</span><br><span class="line">//            &#125;);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">注释掉的代码在有些时候会出现</span><br><span class="line">java.lang.IllegalArgumentException: Comparison method violates its general contract!。可见16057179提交的错误提示</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">    int res=0;</span><br><span class="line">    for(ArrayList&lt;Integer&gt; i:depthArray)&#123;</span><br><span class="line">        //System.out.println(i);</span><br><span class="line">        int tmpres=i.get(0);</span><br><span class="line">        int tmpIndex=1;</span><br><span class="line">        while(tmpIndex&lt;i.size())&#123;</span><br><span class="line">            tmpres=max(tmpres+1,i.get(tmpIndex));</span><br><span class="line">            tmpIndex++;</span><br><span class="line">        &#125;</span><br><span class="line">        res=max(tmpres,res);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(res);</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      
        <categories>
            
            <category> Algorithm </category>
            
        </categories>
        
        
        <tags>
            
            <tag> onlinejudge </tag>
            
            <tag> 格式化输出 </tag>
            
            <tag> io </tag>
            
            <tag> 线段树 </tag>
            
            <tag> 区间查询 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[about]]></title>
      <url>https://ivyxjc.xyz/2016/01/01/about/index/</url>
      <content type="html"><![CDATA[<p>Nickname: <a href="https://ivyxjc.xyz">ivyxjc</a></p>
<p>Email:<a href="mailto:ivyxjc@1994@hotmail.com" target="_blank" rel="noopener">ivyxjc1994@hotmailc.com</a></p>
<p>Github: <a href="https://github.com/ivyxjc" target="_blank" rel="noopener">@ivyxjc</a></p>
]]></content>
      
        
    </entry>
    
  
  
</search>
